#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties false
\origin unavailable
\textclass book
\begin_preamble
\usepackage{pvcstyle}
\end_preamble
\use_default_options true
\begin_modules
theorems-ams
theorems-ams-extended
theorems-chap
\end_modules
\maintain_unincluded_children true
\language chinese-simplified
\language_package default
\inputencoding utf8-plain
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts true
\font_sc true
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 12
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered true
\pdf_bookmarksopen true
\pdf_bookmarksopenlevel 1
\pdf_breaklinks true
\pdf_pdfborder true
\pdf_colorlinks true
\pdf_backref false
\pdf_pdfusetitle true
\pdf_pagemode FullScreen
\papersize a4paper
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 0.5cm
\topmargin 1.5cm
\rightmargin 0.5cm
\bottommargin 0.5cm
\secnumdepth 2
\tocdepth 2
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style cjk
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle fancy
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Chapter
有限单元法
\end_layout

\begin_layout Section
空间离散
\end_layout

\begin_layout Subsection
坐标变换
\end_layout

\begin_layout Standard
利用坐标变换 
\begin_inset Formula $\underbrace{(x,y)}_{\vec{r}}\mapsto\underbrace{(\xi,\eta)}_{\vec{\rho}}$
\end_inset

 及相应的导数变换（下标表示求导）
\begin_inset Formula 
\[
\begin{bmatrix}\partial_{\xi}\,\phi & \partial_{\eta}\,\phi\end{bmatrix}=\begin{bmatrix}\partial_{x}\,\phi & \partial_{y}\,\phi\end{bmatrix}\underbrace{\begin{bmatrix}\partial_{\xi}\,x & \partial_{\eta}\,x\\
\partial_{\xi}\,y & \partial_{\eta}\,y
\end{bmatrix}}_{\underline{J}},
\]

\end_inset

可将一般三角形 
\begin_inset Formula $E$
\end_inset

 上的守恒律
\begin_inset Formula 
\[
\partial_{t}\,u+\partial_{\vec{r}}\vdot\vec{f}=0,\quad\partial_{\vec{r}}\vdot\vec{f}\equiv\partial_{x}\,f_{x}+\partial_{y}\,f_{y},
\]

\end_inset

化为标准三角形 
\begin_inset Formula $T$
\end_inset

 上的守恒律
\begin_inset Formula 
\[
\partial_{t}\,U+\partial_{\vec{\rho}}\vdot\vec{F}=0,\quad\partial_{\vec{\rho}}\vdot\vec{F}\equiv\partial_{\xi}\,F_{\xi}+\partial_{\eta}\,F_{\eta},
\]

\end_inset

其中
\begin_inset Formula 
\[
U=J\,u,\quad\begin{bmatrix}F_{x}\\
F_{y}
\end{bmatrix}\coloneqq\underbrace{\begin{bmatrix}\partial_{\eta}\,y & -\partial_{\eta}\,x\\
-\partial_{\xi}\,y & \partial_{\xi}\,x
\end{bmatrix}}_{J\,\underline{J}^{-1}\equiv\underline{J}^{*}}\begin{bmatrix}f_{x}\\
f_{y}
\end{bmatrix}.
\]

\end_inset


\begin_inset Foot
status open

\begin_layout Proof
由导数变换公式
\begin_inset Formula 
\[
\begin{bmatrix}\partial_{\xi}\,\phi & \partial_{\eta}\,\phi\end{bmatrix}=\begin{bmatrix}\partial_{x}\,\phi & \partial_{y}\,\phi\end{bmatrix}\underbrace{\begin{bmatrix}\partial_{\xi}\,x & \partial_{\eta}\,x\\
\partial_{\xi}\,y & \partial_{\eta}\,y
\end{bmatrix}}_{\underline{J}},
\]

\end_inset

得
\begin_inset Formula 
\[
\begin{bmatrix}\partial_{x}\,\phi & \partial_{y}\,\phi\end{bmatrix}=\begin{bmatrix}\partial_{\xi}\,\phi & \partial_{\eta}\,\phi\end{bmatrix}\underbrace{\frac{1}{J}\begin{bmatrix}\partial_{\eta}\,y & -\partial_{\eta}\,x\\
-\partial_{\xi}\,y & \partial_{\xi}\,x
\end{bmatrix}}_{\underline{J}^{-1}},
\]

\end_inset

从而得
\begin_inset Formula 
\[
\begin{bmatrix}\partial_{x}\,f_{x} & \partial_{y}\,f_{x}\\
\partial_{x}\,f_{y} & \partial_{y}\,f_{y}
\end{bmatrix}=\begin{bmatrix}\partial_{\xi}\,f_{x} & \partial_{\eta}\,f_{x}\\
\partial_{\xi}\,f_{y} & \partial_{\eta}\,f_{y}
\end{bmatrix}\frac{1}{J}\begin{bmatrix}\partial_{\eta}\,y & -\partial_{\eta}\,x\\
-\partial_{\xi}\,y & \partial_{\xi}\,x
\end{bmatrix}.
\]

\end_inset

于是，通量在全局坐标下的散度为
\begin_inset Formula 
\[
\begin{aligned}\partial_{x}\,f_{x}+\partial_{y}\,f_{y} & =\begin{bmatrix}\partial_{\xi}\,f_{x} & \partial_{\eta}\,f_{x}\end{bmatrix}\frac{1}{J}\begin{bmatrix}\partial_{\eta}\,y\\
-\partial_{\xi}\,y
\end{bmatrix}+\begin{bmatrix}\partial_{\xi}\,f_{y} & \partial_{\eta}\,f_{y}\end{bmatrix}\frac{1}{J}\begin{bmatrix}-\partial_{\eta}\,x\\
\partial_{\xi}\,x
\end{bmatrix}\\
 & =\left(\frac{\partial f_{x}}{\partial\xi}\frac{\partial y}{\partial\eta}-\frac{\partial f_{x}}{\partial\eta}\frac{\partial y}{\partial\xi}-\frac{\partial f_{y}}{\partial\xi}\frac{\partial x}{\partial\eta}+\frac{\partial f_{y}}{\partial\eta}\frac{\partial x}{\partial\xi}\right)\frac{1}{J}.
\end{aligned}
\]

\end_inset

定义局部坐标下的通量为
\begin_inset Formula 
\[
\begin{bmatrix}F_{\xi}\\
F_{\eta}
\end{bmatrix}=J\,\underline{J}^{-1}\begin{bmatrix}f_{x}\\
f_{y}
\end{bmatrix}=\begin{bmatrix}\partial_{\eta}\,y & -\partial_{\eta}\,x\\
-\partial_{\xi}\,y & \partial_{\xi}\,x
\end{bmatrix}\begin{bmatrix}f_{x}\\
f_{y}
\end{bmatrix},
\]

\end_inset

则其在局部坐标下的散度为
\begin_inset Formula 
\[
\partial_{\xi}\,F_{\xi}+\partial_{\eta}\,F_{\eta}=\frac{\partial}{\partial\xi}\left(\frac{\partial y}{\partial\eta}f_{x}-\frac{\partial x}{\partial\eta}f_{y}\right)+\frac{\partial}{\partial\eta}\left(-\frac{\partial y}{\partial\xi}f_{x}+\frac{\partial x}{\partial\xi}f_{y}\right),
\]

\end_inset

逐项展开乘积之导，得
\begin_inset Formula 
\[
\begin{aligned}\partial_{\xi}\,F_{\xi}+\partial_{\eta}\,F_{\eta} & =\left(\frac{\partial^{2}y}{\partial\xi\partial\eta}f_{x}-\frac{\partial^{2}x}{\partial\xi\partial\eta}f_{y}\right)+\left(\frac{\partial y}{\partial\eta}\frac{\partial f_{x}}{\partial\xi}-\frac{\partial x}{\partial\eta}\frac{\partial f_{y}}{\partial\xi}\right)\\
 & +\left(-\frac{\partial^{2}y}{\partial\eta\partial\xi}f_{x}+\frac{\partial^{2}x}{\partial\eta\partial\xi}f_{y}\right)+\left(-\frac{\partial y}{\partial\xi}\frac{\partial f_{x}}{\partial\eta}+\frac{\partial x}{\partial\xi}\frac{\partial f_{y}}{\partial\eta}\right),
\end{aligned}
\]

\end_inset

其中二阶导数项两两相消，故剩下
\begin_inset Formula 
\[
\begin{aligned}\partial_{\xi}\,F_{\xi}+\partial_{\eta}\,F_{\eta} & =\left(\frac{\partial y}{\partial\eta}\frac{\partial f_{x}}{\partial\xi}-\frac{\partial x}{\partial\eta}\frac{\partial f_{y}}{\partial\xi}\right)+\left(-\frac{\partial y}{\partial\xi}\frac{\partial f_{x}}{\partial\eta}+\frac{\partial x}{\partial\xi}\frac{\partial f_{y}}{\partial\eta}\right)\\
 & =\tr(\begin{bmatrix}\partial_{\eta}\,y & -\partial_{\eta}\,x\\
-\partial_{\xi}\,y & \partial_{\xi}\,x
\end{bmatrix}\begin{bmatrix}\partial_{\xi}\,f_{x} & \partial_{\eta}\,f_{x}\\
\partial_{\xi}\,f_{y} & \partial_{\eta}\,f_{y}
\end{bmatrix})=\tr(J\,\underline{J}^{-1}\begin{bmatrix}\partial_{\xi}\,f_{x} & \partial_{\eta}\,f_{x}\\
\partial_{\xi}\,f_{y} & \partial_{\eta}\,f_{y}
\end{bmatrix})\\
 & =J\tr(\begin{bmatrix}\partial_{x}\,\xi & \partial_{y}\,\xi\\
\partial_{x}\,\eta & \partial_{y}\,\eta
\end{bmatrix}\begin{bmatrix}\partial_{\xi}\,f_{x} & \partial_{\eta}\,f_{x}\\
\partial_{\xi}\,f_{y} & \partial_{\eta}\,f_{y}
\end{bmatrix})=J\tr(\begin{bmatrix}\partial_{x}\,f_{x} & \cdots\\
\cdots & \partial_{y}\,f_{y}
\end{bmatrix})\\
 & =J\left(\partial_{x}\,f_{x}+\partial_{y}\,f_{y}\right),
\end{aligned}
\]

\end_inset

即
\begin_inset Formula 
\[
\partial_{\vec{\rho}}\vdot\vec{F}=J\,\partial_{\vec{r}}\vdot\vec{f}.
\]

\end_inset


\end_layout

\end_inset


\begin_inset Foot
status collapsed

\begin_layout Proof
上述证明可推广到三维。由导数变换公式
\begin_inset Formula 
\[
\begin{bmatrix}\phi_{\xi} & \phi_{\eta} & \phi_{\zeta}\end{bmatrix}=\begin{bmatrix}\phi_{x} & \phi_{y} & \phi_{z}\end{bmatrix}\underbrace{\begin{bmatrix}x_{\xi} & x_{\eta} & x_{\zeta}\\
y_{\xi} & y_{\eta} & y_{\zeta}\\
z_{\xi} & z_{\eta} & z_{\zeta}
\end{bmatrix}}_{\underline{J}}
\]

\end_inset

得
\begin_inset Formula 
\[
\begin{bmatrix}\phi_{x} & \phi_{y} & \phi_{z}\end{bmatrix}=\begin{bmatrix}\phi_{\xi} & \phi_{\eta} & \phi_{\zeta}\end{bmatrix}\underbrace{J^{-1}\overbrace{\begin{bmatrix}y_{\eta}\,z_{\zeta}-y_{\zeta}\,z_{\eta} & x_{\zeta}\,z_{\eta}-x_{\eta}\,z_{\zeta} & x_{\eta}\,y_{\zeta}-x_{\zeta}\,y_{\eta}\\
y_{\zeta}\,z_{\xi}-y_{\xi}\,z_{\zeta} & x_{\xi}\,z_{\zeta}-x_{\zeta}\,z_{\xi} & x_{\zeta}\,y_{\xi}-x_{\xi}\,y_{\zeta}\\
y_{\xi}\,z_{\eta}-y_{\eta}\,z_{\xi} & x_{\eta}\,z_{\xi}-x_{\xi}\,z_{\eta} & x_{\xi}\,y_{\eta}-x_{\eta}\,y_{\xi}
\end{bmatrix}}}_{\underline{J}^{-1}}^{\underline{J}^{*}},
\]

\end_inset

或
\begin_inset Formula 
\[
\begin{bmatrix}\phi_{x} & \phi_{y} & \phi_{z}\end{bmatrix}J=\begin{bmatrix}\phi_{\xi} & \phi_{\eta} & \phi_{\zeta}\end{bmatrix}\underline{J}^{*},
\]

\end_inset

从而得
\begin_inset Formula 
\[
\begin{bmatrix}f_{x} & f_{y} & f_{z}\\
g_{x} & g_{y} & g_{z}\\
h_{x} & h_{y} & h_{z}
\end{bmatrix}J=\begin{bmatrix}f_{\xi} & f_{\eta} & f_{\zeta}\\
g_{\xi} & g_{\eta} & g_{\zeta}\\
h_{\xi} & h_{\eta} & h_{\zeta}
\end{bmatrix}\underline{J}^{*},
\]

\end_inset

于是，通量在全局坐标下的散度与 
\begin_inset Formula $J$
\end_inset

 之积为
\begin_inset Formula 
\[
\left(f_{x}+g_{y}+h_{z}\right)J=\begin{bmatrix}f_{\xi} & f_{\eta} & f_{\zeta}\end{bmatrix}\underline{J}^{*}\vert1\rangle+\begin{bmatrix}g_{\xi} & g_{\eta} & g_{\zeta}\end{bmatrix}\underline{J}^{*}\vert2\rangle+\begin{bmatrix}h_{\xi} & h_{\eta} & h_{\zeta}\end{bmatrix}\underline{J}^{*}\vert3\rangle,
\]

\end_inset

其中 
\begin_inset Formula $\underline{J}^{*}\vert c\rangle$
\end_inset

 表示取 
\begin_inset Formula $\underline{J}^{*}$
\end_inset

 的第 
\begin_inset Formula $c$
\end_inset

 列。
\end_layout

\begin_layout Proof
定义局部坐标下的通量为
\begin_inset Formula 
\[
\begin{bmatrix}F\\
G\\
H
\end{bmatrix}=\underline{J}^{*}\begin{bmatrix}f\\
g\\
h
\end{bmatrix}\equiv\begin{bmatrix}y_{\eta}\,z_{\zeta}-y_{\zeta}\,z_{\eta} & x_{\zeta}\,z_{\eta}-x_{\eta}\,z_{\zeta} & x_{\eta}\,y_{\zeta}-x_{\zeta}\,y_{\eta}\\
y_{\zeta}\,z_{\xi}-y_{\xi}\,z_{\zeta} & x_{\xi}\,z_{\zeta}-x_{\zeta}\,z_{\xi} & x_{\zeta}\,y_{\xi}-x_{\xi}\,y_{\zeta}\\
y_{\xi}\,z_{\eta}-y_{\eta}\,z_{\xi} & x_{\eta}\,z_{\xi}-x_{\xi}\,z_{\eta} & x_{\xi}\,y_{\eta}-x_{\eta}\,y_{\xi}
\end{bmatrix}\begin{bmatrix}f\\
g\\
h
\end{bmatrix},
\]

\end_inset

则其在局部坐标下的散度为
\begin_inset Formula 
\[
\begin{aligned}F_{\xi}+G_{\eta}+H_{\zeta} & =\left(\langle1\vert\underline{J}^{*}\vert1\rangle\,f+\langle1\vert\underline{J}^{*}\vert2\rangle\,g+\langle1\vert\underline{J}^{*}\vert3\rangle\,h\right)_{\xi}\\
 & +\left(\langle2\vert\underline{J}^{*}\vert1\rangle\,f+\langle2\vert\underline{J}^{*}\vert2\rangle\,g+\langle2\vert\underline{J}^{*}\vert3\rangle\,h\right)_{\eta}\\
 & +\left(\langle3\vert\underline{J}^{*}\vert1\rangle\,f+\langle3\vert\underline{J}^{*}\vert2\rangle\,g+\langle3\vert\underline{J}^{*}\vert3\rangle\,h\right)_{\zeta},
\end{aligned}
\]

\end_inset

其中 
\begin_inset Formula $\langle r\vert\underline{J}^{*}\vert c\rangle$
\end_inset

 表示取 
\begin_inset Formula $\underline{J}^{*}$
\end_inset

 的第 
\begin_inset Formula $r$
\end_inset

 行、第 
\begin_inset Formula $c$
\end_inset

 列。按 
\begin_inset Formula $f,g,h$
\end_inset

 分行，即
\begin_inset Formula 
\[
\begin{aligned}F_{\xi}+G_{\eta}+H_{\zeta} & =\left(\langle1\vert\underline{J}^{*}\vert1\rangle\,f\right)_{\xi}+\left(\langle2\vert\underline{J}^{*}\vert1\rangle\,f\right)_{\eta}+\left(\langle3\vert\underline{J}^{*}\vert1\rangle\,f\right)_{\zeta}\\
 & +\left(\langle1\vert\underline{J}^{*}\vert2\rangle\,g\right)_{\xi}+\left(\langle2\vert\underline{J}^{*}\vert2\rangle\,g\right)_{\eta}+\left(\langle3\vert\underline{J}^{*}\vert2\rangle\,g\right)_{\zeta}\\
 & +\left(\langle1\vert\underline{J}^{*}\vert3\rangle\,h\right)_{\xi}+\left(\langle2\vert\underline{J}^{*}\vert3\rangle\,h\right)_{\eta}+\left(\langle3\vert\underline{J}^{*}\vert3\rangle\,h\right)_{\zeta}.
\end{aligned}
\]

\end_inset

分别考虑一阶导数与二阶导数。
\begin_inset Formula 
\[
\begin{aligned}\sum\text{不含二阶导数的项} & =\underbrace{\langle1\vert\underline{J}^{*}\vert1\rangle\,f_{\xi}+\langle2\vert\underline{J}^{*}\vert1\rangle\,f_{\eta}+\langle3\vert\underline{J}^{*}\vert1\rangle\,f_{\zeta}}_{\begin{bmatrix}f_{\xi} & f_{\eta} & f_{\zeta}\end{bmatrix}\underline{J}^{*}\vert1\rangle}\\
 & +\underbrace{\langle1\vert\underline{J}^{*}\vert2\rangle\,g_{\xi}+\langle2\vert\underline{J}^{*}\vert2\rangle\,g_{\eta}+\langle3\vert\underline{J}^{*}\vert2\rangle\,g_{\zeta}}_{\begin{bmatrix}f_{\xi} & f_{\eta} & f_{\zeta}\end{bmatrix}\underline{J}^{*}\vert2\rangle}\\
 & +\underbrace{\langle1\vert\underline{J}^{*}\vert3\rangle\,h_{\xi}+\langle2\vert\underline{J}^{*}\vert3\rangle\,h_{\eta}+\langle3\vert\underline{J}^{*}\vert3\rangle\,h_{\zeta}}_{\begin{bmatrix}h_{\xi} & h_{\eta} & h_{\zeta}\end{bmatrix}\underline{J}^{*}\vert3\rangle}\\
 & =\left(f_{x}+g_{y}+h_{z}\right)J.
\end{aligned}
\]

\end_inset

于是，只需证明剩余项之和为零。
\begin_inset Formula 
\[
\begin{aligned}\sum\text{含二阶导数的项} & =\left(\langle1\vert\underline{J}^{*}\vert1\rangle_{\xi}+\langle2\vert\underline{J}^{*}\vert1\rangle_{\eta}+\langle3\vert\underline{J}^{*}\vert1\rangle_{\zeta}\right)f\\
 & +\left(\langle1\vert\underline{J}^{*}\vert2\rangle_{\xi}+\langle2\vert\underline{J}^{*}\vert2\rangle_{\eta}+\langle3\vert\underline{J}^{*}\vert2\rangle_{\zeta}\right)g\\
 & +\left(\langle1\vert\underline{J}^{*}\vert3\rangle_{\xi}+\langle2\vert\underline{J}^{*}\vert3\rangle_{\eta}+\langle3\vert\underline{J}^{*}\vert3\rangle_{\zeta}\right)h.
\end{aligned}
\]

\end_inset

注意到 
\begin_inset Formula $f,g,h$
\end_inset

 的系数分别等于
\begin_inset Formula 
\[
\det\begin{bmatrix}\partial_{\xi} & \partial_{\eta} & \partial_{\zeta}\\
y_{\xi} & y_{\eta} & y_{\zeta}\\
z_{\xi} & z_{\eta} & z_{\zeta}
\end{bmatrix},\quad\det\begin{bmatrix}\partial_{\xi} & \partial_{\eta} & \partial_{\zeta}\\
z_{\xi} & z_{\eta} & z_{\zeta}\\
x_{\xi} & x_{\eta} & x_{\zeta}
\end{bmatrix},\quad\det\begin{bmatrix}\partial_{\xi} & \partial_{\eta} & \partial_{\zeta}\\
x_{\xi} & x_{\eta} & x_{\zeta}\\
y_{\xi} & y_{\eta} & y_{\zeta}
\end{bmatrix},
\]

\end_inset

三者在形式上相同，故只需证明其中之一为零。考虑 
\begin_inset Formula $f$
\end_inset

 的系数
\begin_inset Formula 
\[
\left(y_{\eta}\,z_{\zeta}-y_{\zeta}\,z_{\eta}\right)_{\xi}+\left(y_{\zeta}\,z_{\xi}-y_{\xi}\,z_{\zeta}\right)_{\eta}+\left(y_{\xi}\,z_{\eta}-y_{\eta}\,z_{\xi}\right)_{\zeta},
\]

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
展开乘积之导，得
\begin_inset Formula 
\[
\begin{aligned}\left(y_{\eta}\,z_{\zeta}-y_{\zeta}\,z_{\eta}\right)_{\xi} & =y_{\eta\xi}\,z_{\zeta}-y_{\zeta\xi}\,z_{\eta}+y_{\eta}\,z_{\zeta\xi}-y_{\zeta}\,z_{\eta\xi},\\
\left(y_{\zeta}\,z_{\xi}-y_{\xi}\,z_{\zeta}\right)_{\eta} & =y_{\zeta\eta}\,z_{\xi}-y_{\xi\eta}\,z_{\zeta}+y_{\zeta}\,z_{\xi\eta}-y_{\xi}\,z_{\zeta\eta},\\
\left(y_{\xi}\,z_{\eta}-y_{\eta}\,z_{\xi}\right)_{\zeta} & =y_{\xi\zeta}\,z_{\eta}-y_{\eta\zeta}\,z_{\xi}+y_{\xi}\,z_{\eta\zeta}-y_{\eta}\,z_{\xi\zeta}.
\end{aligned}
\]

\end_inset

利用交叉导数相等，可得三行之和为零。
\end_layout

\end_inset


\end_layout

\begin_layout Standard
基于上述结果，有如下积分恒等式
\begin_inset Formula 
\[
\ip{U}{\partial_{\vec{\rho}}\vdot\vec{F}}_{T}=\ip{J\,u}{J\,\partial_{\vec{r}}\vdot\vec{f}}_{T}=\ip{J\,u}{\partial_{\vec{r}}\vdot\vec{f}}_{E},
\]

\end_inset

对该式两端分别应用散度定理，得
\begin_inset Formula 
\[
\ip{U}{\vec{\nu}\vdot\vec{F}}_{\partial T}=\ip{U}{\partial_{\vec{\rho}}\vdot\vec{F}}_{T}=\ip{J\,u}{\partial_{\vec{r}}\vdot\vec{f}}_{E}=\ip{J\,u}{\vec{n}\vdot\vec{f}}_{\partial E},
\]

\end_inset


\end_layout

\begin_layout Subsection
DG (Discontinuous Galerkin)
\begin_inset CommandInset label
LatexCommand label
name "sec:DG"

\end_inset


\end_layout

\begin_layout Subsubsection
弱形式
\end_layout

\begin_layout Standard
偏微分方程
\begin_inset Formula 
\begin{equation}
\partial_{t}\,u+\partial_{s}\,f_{s}=0,\quad(s=x,y,z)\label{eq:间断有限元：微分方程}
\end{equation}

\end_inset

等价于微分积分方程
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\ip{w}{\partial_{t}\,u+\partial_{s}\,f_{s}}_{\varOmega}=0,\quad\forall\varOmega,\forall w\colon\varOmega\to\mathbb{R}
\]

\end_inset

经过一次
\color red
分部积分 (integral by parts)
\color inherit
 并利用 
\color red
Gauss 散度定理
\color inherit
可得
\begin_inset Formula 
\begin{equation}
\ip{w}{\partial_{t}\,u}_{\varOmega}=\ip{\partial_{s}\,w}{f_{s}}_{\varOmega}-\ip{w}{n_{s}\,f_{s}}_{\partial\varOmega},\label{eq:间断有限元：积分方程}
\end{equation}

\end_inset

该式对 
\begin_inset Formula $f_{s}$
\end_inset

 的光滑性要求低于式 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:间断有限元：微分方程"

\end_inset

，因此被称作其
\color red
弱形式 (weak form)
\color inherit
。
\end_layout

\begin_layout Subsubsection
空间离散
\end_layout

\begin_layout Standard
取两组定义在 
\begin_inset Formula $\varOmega$
\end_inset

 上的充分光滑的函数 
\begin_inset Formula $\left\{ \phi_{k}\right\} _{k=1}^{K}$
\end_inset

 与 
\begin_inset Formula $\left\{ \psi_{l}\right\} _{l=1}^{L}$
\end_inset

 作为
\color red
基 (basis)
\color inherit
，则 
\begin_inset Formula $u$
\end_inset

 与 
\begin_inset Formula $w$
\end_inset

 可以分别近似为
\begin_inset Formula 
\[
u(\vec{x},t)\approx u^{h}(\vec{x},t)=\sum_{k=1}^{K}\hat{u}_{k}(t)\,\phi_{k}(\vec{x}),\quad w(\vec{x})\approx w^{h}(\vec{x})=\sum_{l=1}^{L}\hat{w}_{l}\,\psi_{l}(\vec{x})
\]

\end_inset

其中 
\begin_inset Formula $\left\{ \hat{u}_{k}\right\} _{k=1}^{K}$
\end_inset

 为未知量，
\begin_inset Formula $\left\{ \hat{w}_{l}\right\} _{l=1}^{L}$
\end_inset

 为任意常数。将 
\begin_inset Formula $u^{h}$
\end_inset

 与 
\begin_inset Formula $w^{h}$
\end_inset

 代入弱形式 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:间断有限元：积分方程"

\end_inset

 可得
\begin_inset Formula 
\[
\ip{w}{\partial_{t}\,u}_{\varOmega}\approx\ip{w^{h}}{\partial_{t}\,u^{h}}_{\varOmega}=\hat{w}_{l}\ip{\psi_{l}}{\phi_{k}}_{\varOmega}\dv{\hat{u}_{k}}{t}
\]

\end_inset


\begin_inset Formula 
\[
\ip{\partial_{s}\,w}{f_{s}}_{\varOmega}\approx\ip{\partial_{s}\,w^{h}}{f_{s}^{h}}_{\varOmega}=\hat{w}_{l}\ip{\partial_{s}\,\psi_{l}}{f_{s}^{h}}
\]

\end_inset


\begin_inset Formula 
\[
\ip{w}{n_{s}\,f_{s}}_{\partial\varOmega}\approx\ip{w^{h}}{f_{n}^{h}}=\hat{w}_{l}\ip{\psi_{l}}{f_{n}^{h}}_{\partial\varOmega}
\]

\end_inset

其中
\end_layout

\begin_layout Itemize
\begin_inset Formula $f_{s}^{h}$
\end_inset

 为通量分量 
\begin_inset Formula $f_{s}$
\end_inset

 在 
\begin_inset Formula $\varOmega$
\end_inset

 内部的近似值，通常取 
\begin_inset Formula $f_{s}^{h}=f_{s}(u^{h})$
\end_inset

。
\end_layout

\begin_layout Itemize
\begin_inset Formula $f_{n}^{h}$
\end_inset

 为边界 
\begin_inset Formula $\partial\varOmega$
\end_inset

 上的法向通量 
\begin_inset Formula $f_{n}\coloneqq n_{s}\,f_{s}$
\end_inset

 的近似值，通常取为某种精确或
\begin_inset CommandInset ref
LatexCommand nameref
reference "sec:有限体积：近似 Riemann 解"

\end_inset

。
\end_layout

\begin_layout Standard
由 
\begin_inset Formula $\left\{ \hat{w}_{l}\right\} _{l=1}^{L}$
\end_inset

 的任意性，可得 
\begin_inset Formula $L$
\end_inset

 个等式：
\begin_inset Formula 
\[
\ip{\psi_{l}}{\phi_{k}}_{\varOmega}\dv{\hat{u}_{k}}{t}=\ip{\partial_{s}\,\psi_{l}}{f_{s}^{h}}_{\varOmega}-\ip{\psi_{l}}{f_{n}^{h}}_{\partial\varOmega},\quad l=1,\dots,L,
\]

\end_inset

写成矩阵形式即
\begin_inset Formula 
\[
\underline{m}\dv{\underline{\hat{u}}}{t}=\underline{r}_{\varOmega}-\underline{r}_{\partial\varOmega},
\]

\end_inset

其中
\begin_inset Formula 
\[
\underline{m}\coloneqq\begin{bmatrix}\ip{\psi_{1}}{\phi_{1}}_{\varOmega} & \cdots & \ip{\psi_{1}}{\phi_{K}}_{\varOmega}\\
\vdots & \ddots & \vdots\\
\ip{\psi_{L}}{\phi_{1}}_{\varOmega} & \cdots & \ip{\psi_{L}}{\phi_{K}}_{\varOmega}
\end{bmatrix},\quad\underline{\hat{u}}\coloneqq\begin{bmatrix}\hat{u}_{1}\\
\vdots\\
\hat{u}_{K}
\end{bmatrix},
\]

\end_inset


\begin_inset Formula 
\[
\underline{r}_{\varOmega}\coloneqq\begin{bmatrix}\ip{\partial_{s}\,\psi_{1}}{f_{s}^{h}}_{\varOmega}\\
\vdots\\
\ip{\partial_{s}\,\psi_{L}}{f_{s}^{h}}_{\varOmega}
\end{bmatrix},\quad\underline{r}_{\partial\varOmega}\coloneqq\begin{bmatrix}\ip{\psi_{1}}{f_{n}^{h}}_{\partial\varOmega}\\
\vdots\\
\ip{\psi_{L}}{f_{n}^{h}}_{\partial\varOmega}
\end{bmatrix}.
\]

\end_inset

令 
\begin_inset Formula $\varOmega$
\end_inset

 取遍所有单元，即得最一般的
\color red
有限单元法 (Finite Element Methods, FEM)
\color inherit
 方程。
\end_layout

\begin_layout Standard
若 
\begin_inset Formula $K=L$
\end_inset

 且 
\begin_inset Formula $(\forall k)\,\phi_{k}=\psi_{k}\eqqcolon b_{k}$
\end_inset

，则称相应的 FEM 为 
\color red
Galerkin FEM
\color inherit
，否则称之为 
\color red
Petrov–Galerkin FEM
\color inherit
。作为 
\color red
Galerkin FEM
\color inherit
 的特例，
\color red
Discontinuous Galerkin (DG)
\color inherit
 FEM 令 
\begin_inset Formula $\eval{u^{h}}_{E}$
\end_inset

 与 
\begin_inset Formula $\eval{w^{h}}_{E}$
\end_inset

 取自（定义在单元 
\begin_inset Formula $E$
\end_inset

 上的）同一函数空间（并记 
\begin_inset Formula $N\coloneqq K=L$
\end_inset

），则上述矩阵方程变为
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "eq:间断有限元：矩阵方程"

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{\dd}{\dd t}\underline{\hat{u}}=\underline{m}^{-1}\,\underline{r}(\underline{\hat{u}})
\end{equation}

\end_inset

其中
\begin_inset Formula 
\[
\underline{m}\coloneqq\begin{bmatrix}\ip{b_{1}}{b_{1}}_{\varOmega} & \cdots & \ip{b_{1}}{b_{N}}_{\varOmega}\\
\vdots & \ddots & \vdots\\
\ip{b_{N}}{b_{1}}_{\varOmega} & \cdots & \ip{b_{N}}{b_{N}}_{\varOmega}
\end{bmatrix},\quad\underline{\hat{u}}\coloneqq\begin{bmatrix}\hat{u}_{1}\\
\vdots\\
\hat{u}_{N}
\end{bmatrix},
\]

\end_inset


\begin_inset Formula 
\[
\underline{r}(\underline{\hat{u}})\coloneqq\begin{bmatrix}\ip{\partial_{s}\,b_{1}}{f_{s}^{h}}_{\varOmega}\\
\vdots\\
\ip{\partial_{s}\,b_{N}}{f_{s}^{h}}_{\varOmega}
\end{bmatrix}-\begin{bmatrix}\ip{b_{1}}{f_{n}^{h}}_{\partial\varOmega}\\
\vdots\\
\ip{b_{N}}{f_{n}^{h}}_{\partial\varOmega}
\end{bmatrix}.
\]

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
基函数选取
\end_layout

\begin_layout Standard
若式 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:间断有限元：矩阵方程"

\end_inset

 中的 
\begin_inset Formula $\underline{m}$
\end_inset

 是
\color red
满阵 (full matrix)
\color inherit
，则每次求逆（或解线性方程组）都需要 
\begin_inset Formula $\order{N^{3}}$
\end_inset

 次浮点运算；即使缓存了 
\begin_inset Formula $\underline{m}^{-1}$
\end_inset

，每次计算矩阵乘积 
\begin_inset Formula $\underline{m}^{-1}\underline{r}$
\end_inset

 时仍需 
\begin_inset Formula $\order{N^{2}}$
\end_inset

 次浮点运算。适当选取基函数可以显著提升性能：
\end_layout

\begin_layout Itemize
若 
\begin_inset Formula $\underline{b}$
\end_inset

 选取为 
\begin_inset Formula $E$
\end_inset

 上的
\color red
正交基 (orthogonal basis)
\color inherit

\begin_inset Formula 
\[
\ip{b_{k}}{b_{l}}_{E}=\ip{b_{k}}{b_{k}}_{E}\delta_{kl},\quad\forall k,\forall l,
\]

\end_inset

则 
\begin_inset Formula $\underline{m}$
\end_inset

 退化为
\color red
对角阵 (diagonal matrix)
\color inherit
，每次求逆只需要 
\begin_inset Formula $\order{N}$
\end_inset

 次浮点运算。
\end_layout

\begin_layout Itemize
若进一步将 
\begin_inset Formula $\underline{b}$
\end_inset

 限制为
\color red
归一的 (normalized)
\color inherit
 正交基
\begin_inset Formula 
\[
\ip{b_{k}}{b_{l}}_{E}=\delta_{kl},\quad\forall k,\forall l,
\]

\end_inset

则 
\begin_inset Formula $\underline{m}$
\end_inset

 退化为
\color red
单位阵 (unit matrix)
\color inherit
，其求逆运算可以完全省去。
\end_layout

\begin_layout Standard
正交（归一）基底的构造过程详见《
\begin_inset CommandInset ref
LatexCommand nameref
reference "sec:orthogonal_functions"

\end_inset

》。
\end_layout

\begin_layout Standard
除上述正交归一基外，还可以取
\end_layout

\begin_layout Itemize
Lagrange 插值基函数，由此导出 nodal DG；
\end_layout

\begin_layout Itemize
Taylor 基函数，由此导出 modal DG；
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Subsubsection
SEM (Spectral Element Method)
\end_layout

\begin_layout Standard
若 nodal DG 进一步有 solution points 与 quadrature points 重叠，则得到
\color red
谱单元法 (spectral element method, SEM)
\color inherit
，其数值（体）积分由多点求和退化为单点取值：
\begin_inset Formula 
\[
\langle\phi_{k}\vert\phi_{l}\rangle_{E}=\int_{E_{i}}\phi_{k}\,\phi_{l}\dd{E_{i}}\approx\sum_{n=1}^{N}\phi_{k}(\vec{x}_{n})\,\phi_{l}(\vec{x}_{n})\,w_{n}=\begin{cases}
\left(\phi_{k}(\vec{x}_{k})\right)^{2}w_{k}, & k=l,\\
0, & k\ne l,
\end{cases}
\]

\end_inset


\begin_inset Formula 
\[
\begin{aligned}\ip{\partial_{s}\,\phi_{k}}{f_{s}^{h}}_{E_{i}} & =\int_{E_{i}}\vec{f}^{h}\vdot\grad\phi_{k}\dd{E_{i}}\\
 & \approx\sum_{n=1}^{N}\left(\sum_{m=1}^{N}\hat{\vec{f}}_{m}\,\phi_{m}(\vec{x}_{n})\right)\vdot\left(\grad\phi_{k}\right)_{n}\,w_{n}\\
 & =\sum_{n=1}^{N}\left(\vec{f}\vdot\grad\phi_{k}\right)_{n}w_{n},
\end{aligned}
\]

\end_inset

因此计算量显著减小，但数值积分的代数精度可能不足。
\begin_inset CommandInset citation
LatexCommand cite
key "Li_2018"
literal "false"

\end_inset

 指出：
\end_layout

\begin_layout Lemma
若方阵 
\begin_inset Formula $\underline{A}$
\end_inset

 的对角元均为 
\begin_inset Formula $\order{1}$
\end_inset

、非对接元均为 
\begin_inset Formula $\order{h^{p}}$
\end_inset

，则其逆 
\begin_inset Formula $\underline{A}^{-1}$
\end_inset

 的对角元为 
\begin_inset Formula $\langle k\vert\underline{A}^{-1}\vert k\rangle=\langle k\vert\underline{A}\vert k\rangle^{-1}+\order{h^{p}}$
\end_inset

、非对角元均为 
\begin_inset Formula $\order{h^{p}}$
\end_inset

。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
因此若数值积分的代数精度为 
\begin_inset Formula $q$
\end_inset

，即近似对角质量阵 
\begin_inset Formula $\underline{\tilde{m}}$
\end_inset

 的精度为
\begin_inset Formula 
\[
\langle k\vert\underline{\tilde{m}}\vert l\rangle=\langle k\vert\underline{m}\vert l\rangle+\order{h^{q}},
\]

\end_inset

则
\begin_inset Formula 
\[
\langle k\vert\underline{m}^{-1}\vert l\rangle=\langle k\vert\underline{\tilde{m}}^{-1}\vert l\rangle+\order{h^{q}},
\]

\end_inset

因此，只要用 
\begin_inset Formula $\underline{\tilde{m}}$
\end_inset

 代替 
\begin_inset Formula $\underline{m}$
\end_inset

，即
\begin_inset Formula 
\[
\frac{\dd}{\dd t}\underline{\hat{u}}=\underline{m}^{-1}\,\underline{r}(\underline{\hat{u}})=\left(\underline{\tilde{m}}^{-1}+\order{h^{q}}\right)\,\underline{r}(\underline{\hat{u}}),
\]

\end_inset

所引入的误差为 
\begin_inset Formula $\order{h^{q}}$
\end_inset

 远小于格式误差 
\begin_inset Formula $\order{h^{p+1}}$
\end_inset

，该近似就不会使格式精度降阶。
\end_layout

\begin_layout Subsubsection
空间分辨率
\end_layout

\begin_layout Standard
考虑无界问题
\begin_inset Formula 
\[
\frac{\partial u}{\partial t}+a\frac{\partial u}{\partial x}=0,\quad a>0;\quad u(x,0)=\exp(\ii kx).
\]

\end_inset

其精确解为
\begin_inset Formula 
\[
u(x,t)=\frac{\exp(\ii kx)}{\exp(\ii\omega t)},\quad\omega=ka.
\]

\end_inset


\end_layout

\begin_layout Standard
在弱形式
\begin_inset Formula 
\[
\left\langle \partial_{t}\,u^{h}\middle\vert w^{h}\right\rangle _{E_{j}}+\left\langle n_{x}\,f^{\mathrm{I}}\middle\vert w^{h}\right\rangle _{\partial E_{j}}=\left\langle f^{\mathrm{D}}\middle\vert\partial_{x}\,w^{h}\right\rangle _{E_{j}},
\]

\end_inset

中，取迎风通量
\begin_inset Formula 
\[
n_{x}\,f^{\mathrm{I}}=\begin{cases}
au_{j}^{h}(x_{j+1/2},t), & x=x_{j+1/2}\\
-au_{j-1}^{h}(x_{j-1/2},t), & x=x_{j-1/2}
\end{cases}
\]

\end_inset

及域内通量
\begin_inset Formula 
\[
\left.f^{\mathrm{D}}\right\vert _{E_{j}}=f(u_{j}^{h}(x,t))=a\underline{\hat{u}}_{j}^{\mathrm{T}}\,\underline{b}_{j}=\underline{b}_{j}^{\mathrm{T}}\,a\underline{\hat{u}}_{j}
\]

\end_inset

则
\begin_inset Formula 
\[
\ip{\partial_{x}\,\underline{b}}{f^{\mathrm{D}}}_{E_{j}}=\ip{\partial_{x}\,\underline{b}}{\underline{b}^{\mathrm{T}}\,a\underline{\hat{u}}}_{E_{j}}=\ip{\partial_{x}\,\underline{b}}{\underline{b}^{\mathrm{T}}}_{E_{j}}a\underline{\hat{u}}_{j}(t),
\]

\end_inset


\begin_inset Formula 
\[
\left\langle \underline{b}\middle\vert n_{x}\,f^{\mathrm{I}}\right\rangle _{\partial E_{j}}=\underline{b}_{j}(x_{j+1/2})\,\underbrace{\underline{b}_{j}^{\mathrm{T}}(x_{j+1/2})\,a\underline{\hat{u}}_{j}(t)}_{au_{j}^{h}(x_{j+1/2},t)}-\underline{b}_{j}(x_{j-1/2})\,\underbrace{\underline{b}_{j-1}^{\mathrm{T}}(x_{j-1/2})\,a\underline{\hat{u}}_{j-1}(t)}_{au_{j-1}^{h}(x_{j-1/2},t)},
\]

\end_inset

因此可将半离散格式归结为
\begin_inset Formula 
\[
\underline{X}_{j}\frac{\dd}{\dd t}\underline{\hat{u}}_{j}+\underline{Y}_{j}\,\underline{\hat{u}}_{j}+\underline{Z}_{j}\,\underline{\hat{u}}_{j-1}=\underline{0},
\]

\end_inset

 不失一般性，基函数 
\begin_inset Formula $\underline{b}_{j}$
\end_inset

 可定义为相对坐标 
\begin_inset Formula $x'=x-x_{j-1/2}$
\end_inset

 的多项式，若网格均匀，则 
\begin_inset Formula $\underline{X}_{j},\underline{Y}_{j},\underline{Z}_{j}$
\end_inset

 与 
\begin_inset Formula $j$
\end_inset

 无关，从而可省略其下标。不失一般性，下面在均匀网格 
\begin_inset Formula $x_{j-1/2}=jh$
\end_inset

 上分析。
\end_layout

\begin_layout Standard
初始条件 
\begin_inset Formula $u(x,0)=\exp(\ii kx)$
\end_inset

 被各单元近似为
\begin_inset Formula 
\[
u_{j}^{h}(x,0)=\underline{b}_{j}^{\mathrm{T}}(x)\,\underline{\hat{u}}_{j}(0)=\sum_{l=1}^{N}b_{l}^{j}(x)\,\hat{u}_{l}^{j}(0),
\]

\end_inset

若 
\begin_inset Formula $\underline{b}_{j}$
\end_inset

 为归一化的正交基，则
\begin_inset Formula 
\[
\hat{u}_{l}^{j}(0)=\langle b_{l}^{j}\vert\exp(\ii kx)\rangle_{E_{j}}=\langle b_{l}^{j}\vert\exp(\ii kx')\rangle_{E_{j}}\exp(\ii kjh),
\]

\end_inset

右端的积分项与 
\begin_inset Formula $j$
\end_inset

 无关，可记为 
\begin_inset Formula $\hat{u}_{l}$
\end_inset

，因此 
\begin_inset Formula $\underline{\hat{u}}_{j}(0)$
\end_inset

 可以表示为不依赖于 
\begin_inset Formula $j$
\end_inset

 的 
\begin_inset Formula $\underline{\hat{u}}$
\end_inset

 与 
\begin_inset Formula $\exp(\ii kjh)$
\end_inset

 的乘积：
\begin_inset Formula 
\[
\underline{\hat{u}}_{j}(0)=\underline{\hat{u}}\exp(\ii kjh),\quad\underline{\hat{u}}\coloneqq\langle\underline{b}\vert\exp(\ii kx')\rangle_{E_{j}},
\]

\end_inset

若 
\begin_inset Formula $\underline{b}_{j}$
\end_inset

 为其他多项式基，则总可以表示为正交基的线性组合，故结论依然成立。
\end_layout

\begin_layout Standard
线性格式不产生新的谐波分量，据此 
\begin_inset CommandInset citation
LatexCommand citet
key "Hu_1999"
literal "false"

\end_inset

 设
\begin_inset Formula 
\[
\underline{\hat{u}}_{j}(t)=\frac{\underline{\tilde{u}}\exp(\ii kjh)}{\exp(\ii\omega t)},
\]

\end_inset

其中 
\begin_inset Formula $\underline{\tilde{u}}$
\end_inset

 为独立于 
\begin_inset Formula $j,t$
\end_inset

 的待定列阵，则
\begin_inset Formula 
\[
\underline{\hat{u}}_{j-1}(t)=\frac{\underline{\hat{u}}_{j}(t)}{\exp(\ii kh)},
\]

\end_inset

从而有
\begin_inset Formula 
\[
\left(-\ii\omega\underline{X}+\underline{Y}+\frac{\underline{Z}}{\exp(\ii kh)}\right)\underline{\tilde{u}}=\underline{0},
\]

\end_inset

它相当于特征值问题
\begin_inset Formula 
\[
\underline{M}\,\underline{\tilde{u}}=\omega\,\underline{\tilde{u}},\quad\underline{M}\coloneqq\left(\ii\underline{X}\right)^{-1}\left(\underline{Y}+\frac{\underline{Z}}{\exp(\ii kh)}\right),
\]

\end_inset

解之得 
\begin_inset Formula $N$
\end_inset

 个模态 
\begin_inset Formula $\left\{ \left(\omega_{l},\underline{\tilde{u}}_{l}\right)\right\} _{l=1}^{N}$
\end_inset

。实际解是这 
\begin_inset Formula $N$
\end_inset

 个模态的叠加：
\begin_inset Formula 
\[
\underline{\hat{u}}_{j}(t)=\sum_{l=1}^{N}\lambda_{l}\,\underline{\tilde{u}}_{l}\frac{\exp(\ii kjh)}{\exp(\ii\omega_{l}t)},
\]

\end_inset


\begin_inset CommandInset citation
LatexCommand citet
key "Hu_1999"
literal "false"

\end_inset

 定义：在一定波数范围内，满足 
\begin_inset Formula $\omega_{l}\approx ka$
\end_inset

 的那个模态为物理模态，其余为寄生模态。
\end_layout

\begin_layout Standard
定义无量纲波数 
\begin_inset Formula $K=kh$
\end_inset

 及无量纲频率 
\begin_inset Formula $\Omega=(\omega/a)h$
\end_inset

，则
\begin_inset Formula 
\[
\Omega=\Re(\Omega)+\ii\Im(\Omega)
\]

\end_inset

之实部表示色散，虚部表示耗散，精确解
\begin_inset Formula 
\[
\Omega=K\impliedby\omega=ka.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
方程组
\end_layout

\begin_layout Standard
微分方程 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:间断有限元：微分方程"

\end_inset

 与有限元方程 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:间断有限元：矩阵方程"

\end_inset

 都是针对标量守恒律而言的；对于含有 
\begin_inset Formula $K$
\end_inset

 个方程的守恒律组，只需将未知量 
\begin_inset Formula $u$
\end_inset

 替换为 
\begin_inset Formula $\bra{u}\coloneqq\begin{bmatrix}u_{1} & \cdots & u_{K}\end{bmatrix}$
\end_inset

 或 
\begin_inset Formula $\ket{u}\equiv\bra{u}^{\dagger}$
\end_inset

，将通量分量 
\begin_inset Formula $f_{s}$
\end_inset

 替换为 
\begin_inset Formula $\bra{f_{s}}$
\end_inset

 或 
\begin_inset Formula $\ket{f_{s}}$
\end_inset

，就得到相应的偏微分方程组
\begin_inset Formula 
\[
\partial_{t}\bra{u}+\partial_{s}\bra{f_{s}}=\bra{0}\qor\partial_{t}\ket{u}+\partial_{s}\ket{f_{s}}=\ket{0},
\]

\end_inset

及对应的有限元方程
\begin_inset Formula 
\[
\frac{\dd}{\dd t}\left(\underline{\hat{u}}_{i}\right)_{N\times K}=\left(\underline{m}_{i}\right)_{N\times N}^{-1}\left(\underline{r}_{i}\right)_{N\times K},
\]

\end_inset

其中，基函数及质量阵保持不变：
\begin_inset Formula 
\[
\ket{b_{i}(\vec{x})}=\begin{bmatrix}b_{i,1}(\vec{x})\\
\vdots\\
b_{i,N}(\vec{x})
\end{bmatrix},\quad\underline{m}_{i}=\int_{E_{i}}\ket{b_{i}}\bra{b_{i}}=\begin{bmatrix}\ip{b_{i,1}}{b_{i,1}} & \cdots & \ip{b_{i,1}}{b_{i,N}}\\
\vdots & \ddots & \vdots\\
\ip{b_{i,N}}{b_{i,1}} & \cdots & \ip{b_{i,N}}{b_{i,N}}
\end{bmatrix}
\]

\end_inset

未知量系数及残值项分别变为 
\begin_inset Formula $N\times K$
\end_inset

 矩阵
\begin_inset Formula 
\[
\underline{\hat{u}}_{i}(t)=\int_{E_{i}}\ket{b_{i}(\vec{x})}{u(\vec{x},t)},\quad\underline{r}_{i}\coloneqq\int_{E_{i}}\ket{\partial_{s}\,b_{i}}\bra{f_{s}^{h}}-\int_{\partial E_{i}}\ket{b_{i}}\bra{f_{n}^{h}}.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
有源问题
\end_layout

\begin_layout Standard
若在守恒律方程组的右端添加源项：
\begin_inset Formula 
\[
\partial_{t}\bra{u}+\partial_{s}\bra{f_{s}}=\bra{q}\qor\partial_{t}\ket{u}+\partial_{s}\ket{f_{s}}=\ket{q},
\]

\end_inset

则整个推导过程大致相同，只需在弱形式、残值项中补充源项。所得有限元方程仍为
\begin_inset Formula 
\[
\frac{\dd}{\dd t}\left(\underline{\hat{u}}_{i}\right)_{N\times K}=\left(\underline{m}_{i}\right)_{N\times N}^{-1}\left(\underline{r}_{i}\right)_{N\times K},
\]

\end_inset

唯一的区别在于残值项多出源项的体积分
\begin_inset Formula 
\[
\underline{r}_{i}\coloneqq\int_{E_{i}}\ket{\partial_{s}\,b_{i}}\bra{f_{s}^{h}}-\int_{\partial E_{i}}\ket{b_{i}}\bra{f_{n}^{h}}{\color{red}\,+\int_{E_{i}}\ket{b_{i}}\bra{q^{h}}}.
\]

\end_inset


\end_layout

\begin_layout Subsection
FR (Flux Reconstruction)
\begin_inset CommandInset label
LatexCommand label
name "sec:FR"

\end_inset


\end_layout

\begin_layout Subsubsection
一维形式
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\partial u(x,t)}{\partial t}+\frac{\partial f(u)}{\partial x}=0
\]

\end_inset


\end_layout

\begin_layout Paragraph
坐标变换
\end_layout

\begin_layout Standard
在第 
\begin_inset Formula $j$
\end_inset

 号单元 
\begin_inset Formula $E_{j}$
\end_inset

 上，定义物理坐标 
\begin_inset Formula $x$
\end_inset

 到参数坐标 
\begin_inset Formula $\xi$
\end_inset

 的变换：
\begin_inset Formula 
\[
x|_{E_{j}}(\xi)\equiv x_{j}(\xi)\coloneqq c_{j}+\frac{h_{j}}{2}\,\xi,\quad J_{j}=\left|\frac{\partial x_{j}}{\partial\xi}\right|\equiv\frac{h_{j}}{2}.
\]

\end_inset

其中 
\begin_inset Formula $c_{j}$
\end_inset

 为单元中心坐标，
\begin_inset Formula $h_{j}$
\end_inset

 为单元长度。
\end_layout

\begin_layout Paragraph
Lagrange 插值
\end_layout

\begin_layout Standard
在 
\begin_inset Formula $E_{j}$
\end_inset

 内选定 
\begin_inset Formula $N$
\end_inset

 个未知量求值点，记为 
\begin_inset Formula $\left\{ x_{j,k}\equiv x|_{E_{j}}(\xi_{k})\right\} _{k=1}^{N}$
\end_inset

，并记 
\begin_inset Formula $u(x_{j,k},t)\eqqcolon\hat{u}_{j,k}(t)$
\end_inset

。
\end_layout

\begin_layout Standard
\begin_inset Formula $\forall x_{j,k}$
\end_inset

 可构造 
\begin_inset Formula $(N-1)$
\end_inset

-次 Lagrange 多项式
\begin_inset Formula 
\[
\mathrm{La}_{j,k}(x)=\prod_{l=1,l\ne k}^{N}\frac{x-x_{j,l}}{x_{j,k}-x_{j,l}},\quad\mathrm{La}_{k}(\xi)=\prod_{l=1,l\ne k}^{N}\frac{\xi-\xi_{l}}{\xi_{k}-\xi_{l}},
\]

\end_inset

从而得到 
\begin_inset Formula $u$
\end_inset

 的 
\begin_inset Formula $(N-1)$
\end_inset

-次多项式近似
\begin_inset Formula 
\[
u_{j}^{h}(x,t)=\sum_{k=1}^{N}\hat{u}_{j,k}(t)\,\mathrm{La}_{j,k}(x),
\]

\end_inset

或局部坐标系下的
\begin_inset Formula 
\[
\boxed{u_{j}^{h}(x(\xi),t)=\sum_{k=1}^{N}\hat{u}_{j,k}(t)\,\mathrm{La}_{k}(\xi)}.
\]

\end_inset


\end_layout

\begin_layout Paragraph
间断通量
\end_layout

\begin_layout Standard
在 
\begin_inset Formula $x_{j,k}$
\end_inset

 处计算通量值
\begin_inset Formula 
\[
\hat{f}_{j,k}\coloneqq f(\hat{u}_{j,k}),\quad k=1,\dots,N.
\]

\end_inset

定义离散通量
\begin_inset Formula 
\[
f_{j}^{\mathrm{D}}(x,t)=\sum_{k=1}^{N}\hat{f}_{j,k}(t)\,\mathrm{La}_{j,k}(x),
\]

\end_inset

或局部坐标下的
\begin_inset Formula 
\[
\boxed{f_{j}^{\mathrm{D}}(x(\xi),t)=\sum_{k=1}^{N}\hat{f}_{j,k}(t)\,\mathrm{La}_{k}(\xi)}.
\]

\end_inset

其在 
\begin_inset Formula $x_{j,l}\equiv x|_{E_{j}}(\xi_{l})$
\end_inset

 处关于参数坐标的导数为
\begin_inset Formula 
\[
\left.\frac{\partial f_{j}^{\mathrm{D}}}{\partial\xi}\right|_{\xi_{l}}=\sum_{k=1}^{N}\hat{f}_{j,k}(t)\,\left.\frac{\partial\mathrm{La}_{k}}{\partial\xi}\right|_{\xi_{l}},
\]

\end_inset

关于物理坐标的导数为
\begin_inset Formula 
\[
\left.\frac{\partial f_{j}^{\mathrm{D}}}{\partial x}\right|_{x_{j,l}}=\left.\frac{\partial x_{j}}{\partial\xi}\right|_{\xi_{l}}^{-1}\left.\frac{\partial f_{j}^{\mathrm{D}}}{\partial\xi}\right|_{\xi_{l}}=\frac{2}{h_{j}}\left.\frac{\partial f_{j}^{\mathrm{D}}}{\partial\xi}\right|_{\xi_{l}}.
\]

\end_inset


\end_layout

\begin_layout Paragraph
界面通量
\end_layout

\begin_layout Standard
在单元界面 
\begin_inset Formula $x_{j+1/2}$
\end_inset

 处，未知量近似解的左右值
\begin_inset Formula 
\[
u_{\mathrm{L}}\coloneqq u_{j}^{h}(x_{j+1/2}),\quad u_{\mathrm{R}}\coloneqq u_{j+1}^{h}(x_{j+1/2}),
\]

\end_inset

及间断通量的左右值
\begin_inset Formula 
\[
f_{\mathrm{L}}\coloneqq f_{j}^{\mathrm{D}}(x_{j+1/2}),\quad f_{\mathrm{R}}\coloneqq f_{j+1}^{\mathrm{D}}(x_{j+1/2}),
\]

\end_inset

通常是间断的：
\begin_inset Formula 
\[
u_{\mathrm{L}}\ne u_{\mathrm{R}},\quad f_{\mathrm{L}}\ne f_{\mathrm{R}},\quad f_{\mathrm{L}}\ne f(u_{\mathrm{L}}),\quad f_{\mathrm{R}}\ne f(u_{\mathrm{R}}).
\]

\end_inset

需要补充某种界面通量（某种 Riemann 求解器），记为 
\begin_inset Formula $f_{j+1/2}^{\mathrm{I}}$
\end_inset

。
\end_layout

\begin_layout Paragraph
连续通量
\end_layout

\begin_layout Standard
通过对 
\begin_inset Formula $f_{j}^{\mathrm{D}}$
\end_inset

 引入修正函数 
\begin_inset Formula $f_{j}^{\mathrm{C}}$
\end_inset

，可以重构出连续的近似通量：
\begin_inset Formula 
\[
\boxed{f_{j}^{\mathrm{R}}\coloneqq f_{j}^{\mathrm{D}}+f_{j}^{\mathrm{C}}},
\]

\end_inset

要求其在单元界面处等于迎风通量：
\begin_inset Formula 
\[
\boxed{\left.f_{j}^{\mathrm{R}}\right|_{x_{j\pm1/2}}=f_{j\pm1/2}^{\mathrm{I}}},
\]

\end_inset

并且在单元内部（按某种度量）接近间断通量：
\begin_inset Formula 
\[
\boxed{\left.f_{j}^{\mathrm{R}}\right|_{x}\approx\left.f_{j}^{\mathrm{D}}\right|_{x}},\quad\forall x\in E_{j}.
\]

\end_inset


\end_layout

\begin_layout Standard
不失一般性，可定义归一化的修正函数
\begin_inset Formula 
\[
g_{-1}(\xi)\begin{cases}
=1, & \xi=-1,\\
\approx0, & \xi\in(-1,+1),\\
=0, & \xi=+1,
\end{cases}\quad g_{+1}(\xi)\begin{cases}
=0, & \xi=-1,\\
\approx0, & \xi\in(-1,+1),\\
=1, & \xi=+1.
\end{cases}
\]

\end_inset

由此得连续通量
\begin_inset Formula 
\[
f_{j}^{\mathrm{R}}(x(\xi),t)=f_{j}^{\mathrm{D}}(x(\xi),t)+\overbrace{\sum_{\zeta=\pm1}\left(f_{j+\zeta/2}^{\mathrm{I}}-f_{j+\zeta/2}^{\mathrm{D}}\right)g_{\zeta}(\xi)}^{f_{j}^{\mathrm{C}}(x(\xi),t)},
\]

\end_inset

其局部导数为
\begin_inset Formula 
\[
\frac{\partial f_{j}^{\mathrm{R}}(x(\xi),t)}{\partial\xi}=\frac{\partial f_{j}^{\mathrm{D}}(x(\xi),t)}{\partial\xi}+\sum_{\zeta=\pm1}\left(f_{j+\zeta/2}^{\mathrm{I}}-f_{j+\zeta/2}^{\mathrm{D}}\right)\frac{\dd g_{\zeta}(\xi)}{\dd\xi},
\]

\end_inset

全局导数为
\begin_inset Formula 
\[
\frac{\partial f_{j}^{\mathrm{R}}(x(\xi),t)}{\partial\xi}=\frac{\partial f_{j}^{\mathrm{D}}(x(\xi),t)}{\partial x}+\sum_{\zeta=\pm1}\left(f_{j+\zeta/2}^{\mathrm{I}}-f_{j+\zeta/2}^{\mathrm{D}}\right)\frac{\dv*{g_{\zeta}(\xi)}{\xi}}{\dv*{x_{j}}{\xi}}.
\]

\end_inset


\end_layout

\begin_layout Paragraph
半离散格式
\end_layout

\begin_layout Standard
上述 
\begin_inset Formula $f_{j}^{\mathrm{R}}$
\end_inset

 的全局导数为
\begin_inset Formula 
\[
\frac{\partial f_{j}^{\mathrm{R}}(x,t)}{\partial x}=\left(\frac{\partial x_{j}}{\partial\xi}\right)^{-1}\frac{\partial f_{j}^{\mathrm{R}}(x(\xi),t)}{\partial\xi},
\]

\end_inset

用其近似原 PDE 中的 
\begin_inset Formula $\partial_{x}\,f$
\end_inset

，并在 
\begin_inset Formula $x_{j,k}$
\end_inset

 处取值，即得半离散的 FR 格式：
\begin_inset Formula 
\[
\boxed{\dv{\hat{u}_{j,k}(t)}{t}=-\frac{\partial f_{j}^{\mathrm{R}}(x_{j,k},t)}{\partial x}},\quad k=1,\dots,N,
\]

\end_inset

或更具体的
\begin_inset Formula 
\[
\dv{\hat{u}_{j,k}(t)}{t}=-\sum_{l=1}^{N}\hat{f}_{j,l}(t)\,\dv{L_{j,l}(x_{j,k})}{x}-\sum_{\zeta=\pm1}\left(f_{j+\zeta/2}^{\mathrm{I}}-f_{j+\zeta/2}^{\mathrm{D}}\right)\frac{\dv*{g_{\zeta}(\xi_{k})}{\xi}}{\dv*{x_{j}(\xi_{k})}{\xi}}.
\]

\end_inset

考虑显式 Euler 推进：
\begin_inset Formula 
\[
u_{j}^{h}(x,t_{n+1})=u_{j}^{h}(x,t_{n})-\frac{\partial f_{j}^{\mathrm{R}}(x,t_{n})}{\partial x}h_{t},
\]

\end_inset

为保持 
\begin_inset Formula $u_{j}^{h}(x,t_{n+1})$
\end_inset

 仍为 
\begin_inset Formula $x$
\end_inset

 的 
\begin_inset Formula $N-1$
\end_inset

 次多项式，连续通量 
\begin_inset Formula $f_{j}^{\mathrm{R}}(x,t_{n})$
\end_inset

 应为 
\begin_inset Formula $x$
\end_inset

 的 
\begin_inset Formula $N$
\end_inset

 次多项式。这相当于要求修正函数 
\begin_inset Formula $g_{\pm1}$
\end_inset

 均应为 
\begin_inset Formula $\xi$
\end_inset

 的 
\begin_inset Formula $N$
\end_inset

 次多项式。由于 
\begin_inset Formula $g_{\pm1}$
\end_inset

 已给定两端点值，故仍需给定 
\begin_inset Formula $N-1$
\end_inset

 个独立条件。
\end_layout

\begin_layout Paragraph
Quadratures and Polynomials
\end_layout

\begin_layout Subparagraph
Legendre
\end_layout

\begin_layout Standard
By requiring the algebraic precision of the 
\begin_inset Formula $N$
\end_inset

-point quadrature rule, i.e.
\begin_inset Formula 
\[
\int_{-1}^{+1}f(\xi)\dd{\xi}\approx\sum_{k=1}^{N}w_{k}\,f(\xi_{k}),\quad\xi_{1}=-1,
\]

\end_inset

to be as high as possible, one gets the Gauss–Legendre quadrature.
 It is exact for members in 
\begin_inset Formula $\mathbb{P}_{2N-1}([-1,+1])$
\end_inset

.
\end_layout

\begin_layout Standard
The Legendre polynomial of degree 
\begin_inset Formula $k$
\end_inset

 is
\begin_inset Formula 
\[
\mathrm{Le}_{k}(\xi)=\frac{1}{2^{k}\,k!}\frac{\dd^{k}}{\dd\xi^{k}}\left(\xi^{2}-1\right)^{k},
\]

\end_inset

whose zeros in 
\begin_inset Formula $[-1,+1]$
\end_inset

 are the Gauss–Legendre quadrature points.
 It is easy to see that
\begin_inset Formula 
\[
\mathrm{Le}_{k}(-1)=(-1)^{k},\quad\mathrm{Le}_{k}(+1)=1,\quad\mathrm{Le}_{k}(-\xi)=(-1)^{k}\,\mathrm{Le}_{k}(\xi),\quad\mathrm{Le}_{k}\perp\mathbb{P}_{k-1}.
\]

\end_inset


\begin_inset Formula 
\[
\int_{-1}^{1}\mathrm{Le}_{j}(\xi)\,\mathrm{Le}_{k}(\xi)\dd{\xi}=\frac{2\delta_{jk}}{2k+1}.
\]

\end_inset


\end_layout

\begin_layout Subparagraph
Radau
\end_layout

\begin_layout Standard
By requiring 
\begin_inset Formula $\xi_{1}=-1$
\end_inset

 in the 
\begin_inset Formula $N$
\end_inset

-point quadrature rule, i.e.
\begin_inset Formula 
\[
\int_{-1}^{+1}f(\xi)\dd{\xi}\approx\sum_{k=1}^{N}w_{k}\,f(\xi_{k}),\quad\xi_{1}=-1,
\]

\end_inset

and requiring the rule's algebraic precision to be as high as possible,
 one gets the left Radau quadrature.
 It is exact for members in 
\begin_inset Formula $\mathbb{P}_{2N-2}([-1,+1])$
\end_inset

.
\end_layout

\begin_layout Standard
The left Radau polynomial of degree 
\begin_inset Formula $k$
\end_inset

 is
\begin_inset Formula 
\[
\mathrm{Ra}_{\mathrm{L},k}(\xi)=\frac{\mathrm{Le}_{k}(\xi)+\mathrm{Le}_{k-1}(\xi)}{2},
\]

\end_inset

whose zeros in 
\begin_inset Formula $[-1,+1]$
\end_inset

 are the left Radau quadrature points.
 Actually, 
\begin_inset Formula $\mathrm{Ra}_{\mathrm{L},k}(\xi)$
\end_inset

 can be determined from the following 
\begin_inset Formula $2+(k-1)$
\end_inset

 condition
\begin_inset Formula 
\[
\mathrm{Ra}_{\mathrm{L},k}(-1)=0,\quad\mathrm{Ra}_{\mathrm{L},k}(+1)=1,\quad\mathrm{Ra}_{\mathrm{L},k}\perp\mathbb{P}_{k-2}.
\]

\end_inset


\end_layout

\begin_layout Standard
Similarly, the right Radau polynomials of degree 
\begin_inset Formula $k$
\end_inset

 is 
\begin_inset Formula 
\[
\mathrm{Ra}_{\mathrm{R},k}(\xi)=(-1)^{k}\frac{\mathrm{Le}_{k}(\xi)-\mathrm{Le}_{k-1}(\xi)}{2}.
\]

\end_inset

 It is easy to see that
\begin_inset Formula 
\[
\mathrm{Ra}_{\mathrm{R},k}(-1)=1,\quad\mathrm{Ra}_{\mathrm{R},k}(+1)=0,\quad\mathrm{Ra}_{\mathrm{R},k}\perp\mathbb{P}_{k-2}.
\]

\end_inset


\end_layout

\begin_layout Subparagraph
Lobatto
\end_layout

\begin_layout Standard
Suppose 
\begin_inset Formula $N\ge2$
\end_inset

.
\end_layout

\begin_layout Standard
By requiring 
\begin_inset Formula $\xi_{1}=-1$
\end_inset

 and 
\begin_inset Formula $\xi_{K}=+1$
\end_inset

 in the 
\begin_inset Formula $N$
\end_inset

-point quadrature rule, i.e.
\begin_inset Formula 
\[
\int_{-1}^{+1}f(\xi)\dd{\xi}\approx\sum_{k=1}^{N}w_{k}\,f(\xi_{k}),\quad\xi_{1}=-1,\quad\xi_{N}=+1,
\]

\end_inset

and requiring the rule's algebraic precision to be as high as possible,
 one gets the Lobatto quadrature.
 It is exact for members in 
\begin_inset Formula $\mathbb{P}_{2N-3}([-1,+1])$
\end_inset

.
\end_layout

\begin_layout Standard
The Lobatto polynomial of degree 
\begin_inset Formula $k$
\end_inset

 is
\begin_inset Formula 
\[
\mathrm{Lo}_{k}(\xi)=\mathrm{Le}_{k}(\xi)-\mathrm{Le}_{k-2}(\xi),
\]

\end_inset

whose zeros in 
\begin_inset Formula $[-1,+1]$
\end_inset

 are the Lobatto quadrature points.
 It is easy to see that
\begin_inset Formula 
\[
\mathrm{Lo}_{k}(-1)=0,\quad\mathrm{Lo}_{k}(+1)=0,\quad\mathrm{Lo}_{k}\perp\mathbb{P}_{k-3}.
\]

\end_inset


\end_layout

\begin_layout Paragraph
修正函数实例
\end_layout

\begin_layout Subparagraph
\begin_inset Formula $g\perp\mathbb{P}_{N-2}$
\end_inset


\end_layout

\begin_layout Standard
前面提到 
\begin_inset Formula $g(\xi)$
\end_inset

 应在“某种意义”下等于 
\begin_inset Formula $0(\xi)$
\end_inset

，其中一种意义是正交性：使 
\begin_inset Formula $g\perp\mathbb{P}_{L}$
\end_inset

 对尽可能高的 
\begin_inset Formula $L$
\end_inset

 成立。由于 
\begin_inset Formula $\dim\mathbb{P}_{L}=L+1$
\end_inset

，故 
\begin_inset Formula $g_{\pm1}\perp\mathbb{P}_{L}$
\end_inset

 相当于给出了 
\begin_inset Formula $L+1$
\end_inset

 个独立等式：
\begin_inset Formula 
\[
g\perp\phi_{l},\quad l=0,1,\dots,L,
\]

\end_inset

其中 
\begin_inset Formula $\left\{ \phi_{l}\right\} _{l=1}^{L}$
\end_inset

 是 
\begin_inset Formula $\mathbb{P}_{L}$
\end_inset

 的一组正交基；又因为 
\begin_inset Formula $N$
\end_inset

 次多项式 
\begin_inset Formula $g$
\end_inset

 只有 
\begin_inset Formula $N+1$
\end_inset

 个自由度，其中两个已被端点值锁定，对于 
\begin_inset Formula $g_{+1}$
\end_inset

 它们是
\begin_inset Formula 
\[
g_{+1}(-1)=0,\quad g_{+1}(+1)=1,
\]

\end_inset

故至多还可提 
\begin_inset Formula $N-1$
\end_inset

 个正交性条件，即 
\begin_inset Formula $g_{+1}\perp\mathbb{P}_{N-2}$
\end_inset

，从而有
\begin_inset Formula 
\[
g_{+1}(\xi)=\frac{\mathrm{Le}_{N}(\xi)+\mathrm{Le}_{N-1}(\xi)}{2}\equiv\mathrm{Ra}_{\mathrm{L},N}(\xi),
\]

\end_inset


\begin_inset Formula 
\[
g_{-1}(\xi)=g_{+1}(-\xi)=\frac{\mathrm{Le}_{N}(-\xi)+\mathrm{Le}_{N-1}(-\xi)}{2}=(-1)^{N}\frac{\mathrm{Le}_{N}(\xi)-\mathrm{Le}_{N-1}(\xi)}{2}\equiv\mathrm{Ra}_{\mathrm{R},N}(\xi),
\]

\end_inset

其导数为
\begin_inset Formula 
\[
\frac{\dd g_{+1}(\xi)}{\dd\xi}=\frac{1}{2}\left(\frac{\dd\mathrm{Le}_{N}(\xi)}{\dd\xi}+\frac{\dd\mathrm{Le}_{N-1}(\xi)}{\dd\xi}\right),
\]

\end_inset


\begin_inset Formula 
\[
\frac{\dd g_{-1}(\xi)}{\dd\xi}=\frac{(-1)^{N}}{2}\left(\frac{\dd\mathrm{Le}_{N}(\xi)}{\dd\xi}-\frac{\dd\mathrm{Le}_{N-1}(\xi)}{\dd\xi}\right),
\]

\end_inset

其中 Legendre 多项式的导数由递归关系算出：
\begin_inset Formula 
\[
\frac{\dd\mathrm{Le}_{0}(\xi)}{\dd\xi}=0;\quad\frac{\dd\mathrm{Le}_{k}(\xi)}{\dd\xi}=k\,\mathrm{Le}_{k-1}(\xi)+\xi\,\frac{\dd\mathrm{Le}_{k-1}(\xi)}{\dd\xi},\quad k=1,\dots,N.
\]

\end_inset

由此导出的 FR 格式与某种 DG 格式等价，详见 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:DGequivFR"

\end_inset

 节。
\end_layout

\begin_layout Subparagraph
\begin_inset Formula $g\perp\mathbb{P}_{N-3}$
\end_inset


\end_layout

\begin_layout Standard
Relaxing 
\begin_inset Formula $g\perp\mathbb{P}_{N-2}$
\end_inset

 in the DG scheme to 
\begin_inset Formula $g\perp\mathbb{P}_{N-3}$
\end_inset

 and requiring 
\begin_inset Formula $g_{+1}'(-1)=0$
\end_inset

 (i.e.
 requiring 
\begin_inset Formula $\xi=-1$
\end_inset

 to be a zero of multiplicity 2) gives
\begin_inset Formula 
\[
\begin{aligned}g_{+1}(\xi) & =\frac{N-1}{2N-1}\mathrm{Ra}_{\mathrm{L},N}(\xi)+\frac{N}{2N-1}\mathrm{Ra}_{\mathrm{L},N-1}(\xi)\\
 & =\frac{N-1}{2N-1}\frac{\mathrm{Le}_{N}(\xi)+\mathrm{Le}_{N-1}(\xi)}{2}+\frac{N}{2N-1}\frac{\mathrm{Le}_{N-1}(\xi)+\mathrm{Le}_{N-2}(\xi)}{2}\\
 & =\frac{N-1}{2N-1}\frac{\mathrm{Le}_{N}(\xi)}{2}+\frac{\mathrm{Le}_{N-1}(\xi)}{2}+\frac{N}{2N-1}\frac{\mathrm{Le}_{N-2}(\xi)}{2}
\end{aligned}
\]

\end_inset

whose derivative vanishes at the right 
\begin_inset Formula $N-1$
\end_inset

 Lobatto points and thus corrects 
\begin_inset Formula $f_{j}'(\xi)$
\end_inset

 only at the left boundary.
\end_layout

\begin_layout Standard
The resulting scheme is accurate to order 
\begin_inset Formula $2N-2$
\end_inset

 and has a CFL limit roughly twice as large as that of DG.
\end_layout

\begin_layout Standard
该过程可以进一步推广：Requiring 
\begin_inset Formula $g_{+1}(+1)=1$
\end_inset

 and 
\begin_inset Formula $\xi=-1$
\end_inset

 to be a zero of multiplicity 
\begin_inset Formula $m$
\end_inset

, i.e.
\begin_inset Formula 
\[
\dv[l]{\xi}g_{+1}(-1)=0,\quad l=0,1,\dots,m-1,
\]

\end_inset

and 
\begin_inset Formula $g_{+1}\perp\mathbb{P}_{N-1-m}$
\end_inset

 , gives 
\begin_inset Formula $g_{m}$
\end_inset

 (e.g.
 
\begin_inset Formula $g_{1}=g_{\text{DG}}$
\end_inset

, 
\begin_inset Formula $g_{2}=g_{\text{Lump, Lo}}$
\end_inset

).
\end_layout

\begin_layout Standard
The resulting scheme is accurate to order 
\begin_inset Formula $2N-m$
\end_inset

.
\begin_inset CommandInset citation
LatexCommand citet
key "Huynh_2007"
literal "true"

\end_inset


\end_layout

\begin_layout Subparagraph
Staggered Grid
\end_layout

\begin_layout Standard
注意到 
\begin_inset Formula $N$
\end_inset

-次多项式至多有 
\begin_inset Formula $N$
\end_inset

 个（实）零点，记为 
\begin_inset Formula $\left\{ \zeta_{k}\right\} _{k=1}^{N}$
\end_inset

。对于 
\begin_inset Formula $g_{-1}(\xi)$
\end_inset

，其中之一已被给定，记为 
\begin_inset Formula $\zeta_{N}=1$
\end_inset

。剩下的任务便是给出其余 
\begin_inset Formula $N-1$
\end_inset

 个零点。
\end_layout

\begin_layout Standard
Consider the 
\begin_inset Formula $N+1$
\end_inset

 Chebyshev–Lobatto points
\begin_inset Formula 
\[
\zeta_{k}=-\cos(\frac{k\pi}{N}),\quad k=0,1,\dots,N.
\]

\end_inset

Requiring
\begin_inset Formula 
\[
g(\zeta_{0})=1,\quad g(\zeta_{k})=0,\quad k=1,\dots,N,
\]

\end_inset

which leads to a simplified version of the SG scheme.
\end_layout

\begin_layout Standard
The resulting scheme is less accurate than DG but has a CFL limit more than
 
\begin_inset Formula $3/2$
\end_inset

 as large as that of DG.
\end_layout

\begin_layout Subparagraph
Energy Stable FR by Vincent et al.
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Vincent_2010"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $u$
\end_inset

 以 
\begin_inset Formula $N$
\end_inset

 次多项式近似，则修正函数需 
\begin_inset Formula $N+1$
\end_inset

 次：
\begin_inset Formula 
\[
g_{+1}(\xi)=\frac{\mathrm{Le}_{N}(\xi)+\lambda\,\mathrm{Le}_{N-1}(\xi)+\mu\,\mathrm{Le}_{N+1}(\xi)}{2}
\]

\end_inset


\begin_inset Formula 
\[
g_{-1}(\xi)=g_{+1}(-\xi)=(-1)^{N}\frac{\mathrm{Le}_{N}(\xi)-\lambda\,\mathrm{Le}_{N-1}(\xi)-\mu\,\mathrm{Le}_{N+1}(\xi)}{2}
\]

\end_inset

其中
\begin_inset Formula 
\[
\lambda=\frac{\eta}{1+\eta},\quad\mu=\frac{1}{1+\eta},\quad\eta=\frac{c}{-c_{-}},
\]

\end_inset


\begin_inset Formula 
\[
c_{-}=\frac{-2}{2N+1}\overbrace{\left(\frac{2^{N}\,N!}{(2N)!}\right)^{2}}^{A_{N}},\quad c_{-}<c<\infty.
\]

\end_inset

参数 
\begin_inset Formula $c$
\end_inset

 的某些特殊值可以导出既有格式：
\end_layout

\begin_layout Description
Discontinuous
\begin_inset space \space{}
\end_inset

Galerkin 
\begin_inset Formula 
\[
c=0,\quad\eta=0,\quad\lambda=0,\quad\mu=1.
\]

\end_inset


\end_layout

\begin_layout Description
Spectral
\begin_inset space \space{}
\end_inset

Difference 
\begin_inset Formula 
\[
c=\frac{2N}{(2N+1)(N+1)}A_{N},\quad\eta=\frac{N}{N+1},\quad\lambda=\frac{N}{2N+1},\quad\mu=\frac{N+1}{2N+1}.
\]

\end_inset


\end_layout

\begin_layout Description
Huyhn's
\begin_inset space \space{}
\end_inset


\begin_inset Formula $g_{2}$
\end_inset

 
\begin_inset Formula 
\[
c=\frac{2(N+1)}{(2N+1)N}A_{N},\quad\eta=\frac{N+1}{N},\quad\lambda=\frac{N+1}{2N+1},\quad\mu=\frac{N}{2N+1}.
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Paragraph
Energy Stable
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\norm{u^{\mathrm{D}}}_{p,c}=\sqrt{\sum_{j}\left(\norm{u_{j}^{\mathrm{D}}}_{L_{2}(E_{j})}^{2}+\frac{c}{2}\left(\frac{\abs{E_{j}}}{2}\right)^{2p}\norm{\pdv[p]{u_{j}^{\mathrm{D}}}{x}}_{L_{2}(E_{j})}^{2}\right)},
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\dv{t}\norm{u^{\mathrm{D}}}_{p,c}^{2}\le0.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
多维形式
\end_layout

\begin_layout Standard
标量守恒律
\begin_inset Formula 
\[
\partial_{t}\,u+\divg\vec{f}=0,
\]

\end_inset

在单元 
\begin_inset Formula $E$
\end_inset

 上，以关于 
\begin_inset Formula $(x,y)$
\end_inset

 的 
\begin_inset Formula $K$
\end_inset

 次多项式 
\begin_inset Formula $u^{h}$
\end_inset

 作为对 
\begin_inset Formula $u$
\end_inset

 的近似，以分量为关于 
\begin_inset Formula $(x,y)$
\end_inset

 的 
\begin_inset Formula $K$
\end_inset

 次多项式的向量函数 
\begin_inset Formula $\vec{f}^{\mathrm{D}}$
\end_inset

作为对 
\begin_inset Formula $\vec{f}$
\end_inset

 的近似。
\end_layout

\begin_layout Standard
\begin_inset Formula $\forall\phi\in\mathbb{P}_{K}(E)$
\end_inset

，该守恒律成立的必要条件为
\begin_inset Formula 
\[
\langle\partial_{t}\,u^{h}+\divg\vec{f}^{\mathrm{D}}\vert\phi\rangle_{E}=0.
\]

\end_inset

分部积分一次，得弱形式
\begin_inset Formula 
\[
\langle\partial_{t}\,u^{h}\vert\phi\rangle_{E}+\langle\vec{\nu}\vdot\vec{f}^{\mathrm{D}}\vert\phi\rangle_{\partial E}-\langle\vec{f}^{\mathrm{D}}\vert\grad\phi\rangle_{E}=0,
\]

\end_inset

将 
\begin_inset Formula $\vec{\nu}\vdot\vec{f}^{\mathrm{D}}\eqqcolon f_{\nu}^{\mathrm{D}}$
\end_inset

 用迎风型界面通量 
\begin_inset Formula $f_{\nu}^{\mathrm{I}}$
\end_inset

 替换，得弱形式
\begin_inset Formula 
\[
\langle\partial_{t}\,u^{h}\vert\phi\rangle_{E}+\langle f_{\nu}^{\mathrm{I}}\vert\phi\rangle_{\partial E}-\langle\vec{f}^{\mathrm{D}}\vert\grad\phi\rangle_{E}=0.
\]

\end_inset

由此可以导出 DG 格式。
\end_layout

\begin_layout Standard
再次分部积分，并记法向通量阶跃值
\begin_inset Formula 
\[
[f_{\nu}]\coloneqq f_{\nu}^{\mathrm{I}}-f_{\nu}^{\mathrm{D}},
\]

\end_inset

得强形式
\begin_inset Formula 
\[
\langle\partial_{t}\,u^{h}\vert\phi\rangle_{E}+\langle[f_{\nu}]\vert\phi\rangle_{\partial E}+\langle\divg\vec{f}^{\mathrm{D}}\vert\phi\rangle_{E}=0,
\]

\end_inset

为提取出 
\begin_inset Formula $\phi$
\end_inset

，需将 
\begin_inset Formula $\partial E$
\end_inset

 上的积分化为 
\begin_inset Formula $E$
\end_inset

 上的积分，即寻找 
\begin_inset Formula $h\equiv\divg\vec{f}^{\mathrm{C}}$
\end_inset

 使得
\begin_inset Formula 
\[
\langle[f_{\nu}]\vert\phi\rangle_{\partial E}=\langle h\vert\phi\rangle_{E}=\langle\divg f^{\mathrm{C}}\vert\phi\rangle_{E},
\]

\end_inset

从而有 FR 的加权残值形式：
\begin_inset Formula 
\[
\langle\partial_{t}\,u^{h}+\divg\vec{f}^{\mathrm{R}}\vert\phi\rangle_{E}=0,\quad\vec{f}^{\mathrm{R}}=\vec{f}^{\mathrm{D}}+\vec{f}^{\mathrm{C}},
\]

\end_inset

其中 
\begin_inset Formula $\vec{f}^{\mathrm{C}}$
\end_inset

 只是一种形式化的表达式，并不需要实际求出。在结点处取值，即得半离散格式
\begin_inset Formula 
\[
\dv{\hat{u}_{j,k}}{t}+\overbrace{\sum_{m}\vec{f}(\hat{u}_{j,m})\vdot\grad L_{j,m}}^{\divg\vec{f}^{\mathrm{D}}}(\vec{x}_{j,k})+h(\vec{x}_{j,k})=0.
\]

\end_inset

问题归结为 
\begin_inset Formula $h$
\end_inset

 的构造。
\end_layout

\begin_layout Paragraph
\begin_inset CommandInset citation
LatexCommand cite
key "Huynh_2011"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand cite
key "Huynh_2011"
literal "false"

\end_inset

 给出的方案如下：三角形 
\begin_inset Formula $E$
\end_inset

 上的次数不超过 
\begin_inset Formula $K$
\end_inset

 的单项式有 
\begin_inset Formula 
\[
\dim\mathbb{P}_{K}(E)=K_{N}=\binom{K+2}{2}
\]

\end_inset

个，令 
\begin_inset Formula $\phi_{k}$
\end_inset

 为 
\begin_inset Formula $E$
\end_inset

 上的第 
\begin_inset Formula $k$
\end_inset

 个多项式基。令 
\begin_inset Formula $\vec{x}_{e,l}$
\end_inset

 为 
\begin_inset Formula $E$
\end_inset

 的第 
\begin_inset Formula $e$
\end_inset

 条（共 
\begin_inset Formula $3$
\end_inset

 条）边上的第 
\begin_inset Formula $l$
\end_inset

 个（共 
\begin_inset Formula $K+1$
\end_inset

 个）通量计算点；令 
\begin_inset Formula $\varphi_{e,l}$
\end_inset

 为该点对应的 
\begin_inset Formula $K$
\end_inset

 次 Lagrange 多项式，并将其延拓到 
\begin_inset Formula $\partial E$
\end_inset

 上（在其他边上取值为 
\begin_inset Formula $0$
\end_inset

），从而有
\begin_inset Formula 
\[
[f_{\nu}]\approx\sum_{e}\sum_{l}[f_{\nu}]_{e,l}\,\varphi_{e,l}(x,y)
\]

\end_inset

更进一步地，可以将 
\begin_inset Formula $\varphi_{e,l}$
\end_inset

 延拓到整个 
\begin_inset Formula $E$
\end_inset

 上，即寻找 
\begin_inset Formula $K_{N}$
\end_inset

 个独立参数以确定 
\begin_inset Formula $\gamma_{e,l}\in\mathbb{P}_{K}(E)$
\end_inset

，使其满足以下 
\begin_inset Formula $K_{N}$
\end_inset

 个独立等式：
\begin_inset Formula 
\[
\langle\gamma_{e,l}\vert\phi_{k}\rangle_{E}=\langle\varphi_{e,l}\vert\phi_{k}\rangle_{\partial E},\quad k=1,\dots,K_{N}.
\]

\end_inset

利用所得的 
\begin_inset Formula $\gamma_{e,l}$
\end_inset

 可以将 
\begin_inset Formula $\partial E$
\end_inset

 上的积分化为 
\begin_inset Formula $E$
\end_inset

 上 的积分：
\begin_inset Formula 
\[
\begin{aligned}\langle[f_{\nu}]\vert\phi_{k}\rangle_{\partial E} & \approx\left\langle \sum_{e}\sum_{l}[f_{\nu}]_{e,l}\,\varphi_{e,l}\middle\vert\phi_{k}\right\rangle _{\partial E}=\sum_{e}\sum_{l}[f_{\nu}]_{e,l}\,\langle\varphi_{e,l}\vert\phi_{k}\rangle_{\partial E}\\
 & =\sum_{e}\sum_{l}[f_{\nu}]_{e,l}\,\langle\gamma_{e,l}\vert\phi_{k}\rangle_{E}=\left\langle \sum_{e}\sum_{l}[f_{\nu}]_{e,l}\,\gamma_{e,l}\middle\vert\phi_{k}\right\rangle _{E},
\end{aligned}
\]

\end_inset

由此得
\begin_inset Formula 
\[
\hat{h}_{j,k}=\sum_{e}\sum_{l}[f_{\nu}]_{e,l}\,\gamma_{e,l}(\vec{x}_{j,k}),
\]

\end_inset

其中 
\begin_inset Formula $\gamma_{e,l}(\vec{x}_{j,k})$
\end_inset

 可以预先算出并缓存。最终的半离散格式为
\begin_inset Formula 
\[
\dv{\hat{u}_{j,k}}{t}+\overbrace{\sum_{m}\vec{f}(\hat{u}_{j,m})\vdot\grad L_{j,m}}^{\divg\vec{f}^{\mathrm{D}}}(\vec{x}_{j,k})+\overbrace{\sum_{e}\sum_{l}[f_{\nu}]_{e,l}\,\gamma_{e,l}}^{\divg\vec{f}^{\mathrm{C}}}(\vec{x}_{j,k})=0.
\]

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
若通量计算点 
\begin_inset Formula $\vec{x}_{e,l}$
\end_inset

 取为所属边的 Gauss 积分点，则该点对应的权重为
\begin_inset Formula 
\[
\langle\varphi_{e,l}\vert1\rangle_{\partial E}=\sum_{k}\underbrace{\varphi_{e,l}(\vec{x}_{e,k})}_{\delta_{kl}}\,w_{e,k}=w_{e,l}.
\]

\end_inset

又因 
\begin_inset Formula $(\varphi_{e,l}\,\phi)\in\mathbb{P}_{2K}(T)$
\end_inset

，故 
\begin_inset Formula $\langle\varphi_{e,l}\vert\phi\rangle_{\partial E}$
\end_inset

 可以被 
\begin_inset Formula $K+1$
\end_inset

 点 Gauss 积分公式精确计算，即
\begin_inset Formula 
\[
\langle\varphi_{e,l}\vert\phi\rangle_{\partial E}=\sum_{k=1}^{K+1}w_{e,k}\,\varphi_{e,l}(\vec{x}_{e,k})\,\phi(\vec{x}_{e,k})=w_{e,l}\,\phi(\vec{x}_{e,l}),
\]

\end_inset

故
\begin_inset Formula 
\[
\langle\gamma_{e,l}\vert\phi\rangle_{E}=\langle\varphi_{e,l}\vert\phi\rangle_{\partial E}=w_{e,l}\,\phi(\vec{x}_{e,l}),
\]

\end_inset

因此 
\begin_inset Formula $\gamma_{e,l}/w_{e,l}$
\end_inset

 是 
\begin_inset Formula $E$
\end_inset

 上的 Dirac 函数的一种近似。
\end_layout

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
\begin_inset Formula $K$
\end_inset

 次多项式 
\begin_inset Formula $\gamma_{e,l}$
\end_inset

 是对通量散度 
\begin_inset Formula $\divg\vec{f}^{\mathrm{D}}$
\end_inset

 的修正。原则上可以构造出分量为 
\begin_inset Formula $K+1$
\end_inset

 次多项式的 
\begin_inset Formula $\vec{g}_{e,l}$
\end_inset

，使得
\begin_inset Formula 
\[
\divg\vec{g}_{e,l}=\gamma_{e,l},
\]

\end_inset

则得对通量本身的修正，即连续通量
\begin_inset Formula 
\[
\vec{f}^{\mathrm{R}}=\vec{f}^{\mathrm{D}}+\sum_{e=1}^{3}\sum_{l=1}^{K+1}[f_{\nu}]_{e,l}\,\vec{g}_{e,l}.
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Paragraph
\begin_inset CommandInset citation
LatexCommand cite
key "Castonguay_2011"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
局部坐标下的函数 
\begin_inset Formula $U,\vec{F}$
\end_inset

 可以由标准三角形 
\begin_inset Formula $T$
\end_inset

 上的 
\begin_inset Formula $p$
\end_inset

-次 Lagrange 插值来近似：
\begin_inset Formula 
\[
\begin{bmatrix}U(\vec{\rho},t)\\
\vec{F}(\vec{\rho},t)
\end{bmatrix}\approx\begin{bmatrix}U^{\mathrm{D}}(\vec{\rho},t)\\
\vec{F}^{\mathrm{D}}(\vec{\rho},t)
\end{bmatrix}=\sum_{i=1}^{N_{T}}\begin{bmatrix}\hat{U}_{i}(t)\\
\vec{F}(\hat{U}_{i}(t))
\end{bmatrix}L_{i}(\vec{\rho}),
\]

\end_inset

其中 
\begin_inset Formula $N_{T}(p)\equiv\binom{p+2}{2}$
\end_inset

 为 solution points 个数，上标中的 D 表示其在单元边界处间断。为构造在单元边界处连续的重构 (R) 通量（实际上是构造修正
 (C) 通量 
\begin_inset Formula $\vec{F}^{\mathrm{C}}$
\end_inset

）
\begin_inset Formula 
\[
\vec{F}^{\mathrm{R}}=\vec{F}^{\mathrm{D}}+\vec{F}^{\mathrm{C}},
\]

\end_inset

规定
\begin_inset Formula 
\[
\vec{\nu}\vdot\vec{F}^{\mathrm{R}}=F_{\nu}^{\mathrm{I}}\qty(U^{\mathrm{D}},U_{+}^{\mathrm{D}}),\quad\forall\vec{\rho}\in\partial T,
\]

\end_inset

其中 
\begin_inset Formula $F_{\nu}^{\mathrm{I}}$
\end_inset

 为法向数值通量，
\begin_inset Formula $U^{\mathrm{D}},U_{+}^{\mathrm{D}}$
\end_inset

 分别为当前（内侧）单元与外侧单元的近似解。这相当于规定
\begin_inset Formula 
\[
\vec{\nu}\vdot\vec{F}^{\mathrm{C}}=F_{\nu}^{\mathrm{I}}-\vec{\nu}\vdot\vec{F}^{\mathrm{D}}\eqqcolon[F_{\nu}],\quad\forall\vec{\rho}\in\partial T.
\]

\end_inset

为寻找具有这种性质的 
\begin_inset Formula $\vec{F}^{\mathrm{C}}$
\end_inset

，仿照一维形式的 FR，定义
\begin_inset Formula 
\[
\vec{F}^{\mathrm{C}}(\vec{\rho})=\sum_{f=1}^{3}\sum_{j=1}^{N_{f}}[F_{\nu}]_{f,j}\,\vec{\varphi}_{f,j}(\vec{\rho}),
\]

\end_inset

其中 
\begin_inset Formula $[F_{\nu}]_{f,j}$
\end_inset

 为 
\begin_inset Formula $[F_{\nu}]\equiv F_{\nu}^{\mathrm{I}}-\vec{\nu}\vdot\vec{F}^{\mathrm{D}}$
\end_inset

 在第 
\begin_inset Formula $f$
\end_inset

 段边界 
\begin_inset Formula $(\partial T)_{f}$
\end_inset

 上的第 
\begin_inset Formula $j$
\end_inset

 号 flux point 
\begin_inset Formula $\vec{\rho}_{f,j}\in(\partial T)_{f}$
\end_inset

 处的取值，
\begin_inset Formula $\vec{\varphi}_{f,j}$
\end_inset

 为待定的向量修正函数。
\end_layout

\begin_layout Standard
将
\begin_inset Formula 
\[
U(\vec{\rho},t)\approx U^{\mathrm{D}}(\vec{\rho},t)=\sum_{i=1}^{N_{T}}\hat{U}_{i}(t)\,L_{i}(\vec{\rho})
\]

\end_inset

及
\begin_inset Formula 
\[
\vec{F}(\vec{\rho})\approx\vec{F}^{\mathrm{R}}(\vec{\rho})=\vec{F}^{\mathrm{D}}(\vec{\rho})+\vec{F}^{\mathrm{C}}(\vec{\rho})=\left(\sum_{i=1}^{N_{T}}\vec{F}(\hat{U}_{i}(t))\,L_{i}(\vec{\rho})\right)+\left(\sum_{f=1}^{3}\sum_{j=1}^{N_{f}}[F_{\nu}]_{f,j}\,\vec{\varphi}_{f,j}(\vec{\rho})\right)
\]

\end_inset

代入强形式
\begin_inset Formula 
\[
\partial_{t}\,U^{\mathrm{D}}+\partial_{\vec{\rho}}\vdot\vec{F}^{\mathrm{R}}=0,
\]

\end_inset

并依次在 solution points 
\begin_inset Formula $\vec{\rho}_{k}$
\end_inset

 处取值，再利用 
\begin_inset Formula $U^{\mathrm{D}}(\vec{\rho}_{k},t)=\sum_{i=1}^{N_{T}}\hat{U}_{i}(t)\,L_{i}(\vec{\rho}_{k})=\hat{U}_{k}(t)$
\end_inset

，即得半离散格式：
\begin_inset Formula 
\[
\dv{\hat{U}_{k}(t)}{t}=-\sum_{i=1}^{N_{T}}\vec{F}(\hat{U}_{i}(t))\vdot\partial_{\vec{\rho}}\,L_{i}(\vec{\rho}_{k})-\sum_{f=1}^{3}\sum_{j=1}^{N_{f}}[F_{\nu}]_{f,j}\,\partial_{\vec{\rho}}\vdot\vec{\varphi}_{f,j}(\vec{\rho}_{k}).
\]

\end_inset

其具体形式取决于
\end_layout

\begin_layout Itemize
单元内部的 solution points 
\begin_inset Formula $\left\{ \vec{\rho}_{i}\right\} _{i=1}^{N_{T}}$
\end_inset

 的分布。
\end_layout

\begin_layout Itemize
单元边界上的 flux points 
\begin_inset Formula $\left\{ \vec{\rho}_{j}\right\} _{j=1}^{N_{\partial T}}$
\end_inset

 的分布。
\end_layout

\begin_layout Itemize
向量修正函数 
\begin_inset Formula $\vec{\varphi}_{f,j}$
\end_inset

 或标量修正场 
\begin_inset Formula $\phi_{f,j}\equiv\partial_{\vec{\rho}}\vdot\vec{\varphi}_{f,j}$
\end_inset

 的选取。
\end_layout

\begin_layout Itemize
法向数值通量 
\begin_inset Formula $F_{\nu}^{\mathrm{I}}$
\end_inset

 的形式。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand cite
key "Castonguay_2011"
literal "true"

\end_inset

 首先提出了 
\begin_inset Formula $\vec{\varphi}_{f,j}$
\end_inset

 的候选空间：格式精度 (
\begin_inset Formula $p$
\end_inset

-exact) 要求 
\begin_inset Formula $\partial_{\vec{\rho}}\vdot\vec{\varphi}_{f,j}\in\mathbb{P}_{p}(T)$
\end_inset

 及
\begin_inset Formula 
\[
\vec{\nu}\vdot\vec{\varphi}_{j}|_{\partial T}\in\mathbb{R}_{p}(\partial T)\equiv\left\{ f:\left(f\in L_{2}(\partial T)\right)\land\left(f|_{\Gamma_{e}}\in\mathbb{P}_{p}(\Gamma_{e}),\forall e\right)\right\} ,
\]

\end_inset

故 
\begin_inset Formula $\vec{\varphi}_{j}$
\end_inset

 取自 Raviart–Thomas 空间：
\begin_inset Formula 
\[
\left(\mathbb{P}_{p}(T)\right)^{2}+\vec{\rho}\,\mathbb{P}_{p}(T)\coloneqq\left\{ \begin{bmatrix}X(\xi,\eta)\\
Y(\xi,\eta)
\end{bmatrix}+\begin{bmatrix}\xi\\
\eta
\end{bmatrix}Z(\xi,\eta):(X,Y,Z)\in\left(\mathbb{P}_{p}(T)\right)^{3}\right\} .
\]

\end_inset

其次，修正通量定义式 
\begin_inset Formula $\vec{\nu}\vdot\vec{F}^{\mathrm{C}}=[F_{\nu}]$
\end_inset

 应至少在 flux points 上成立，故向量修正函数 
\begin_inset Formula $\vec{\varphi}_{f,j}$
\end_inset

 应满足 Kronecker delta 条件：
\begin_inset Formula 
\[
\vec{\nu}(\vec{\rho}_{f',j'})\vdot\vec{\varphi}_{f,j}(\vec{\rho}_{f',j'})=\delta_{ff'}\delta_{jj'},\quad\forall(f',j').
\]

\end_inset

最后，根据能量稳定条件
\begin_inset Formula 
\[
\dv{t}\norm{U^{\mathrm{D}}}_{p,2}^{2}=\sum_{j}\frac{1}{2}\left(\norm{U_{j}^{\mathrm{D}}}_{L_{2}(T)}^{2}+\sum_{m=1}^{p+1}\frac{c_{m}}{\vert T\vert}\norm{D^{(m,p)}U_{j}^{\mathrm{D}}}_{L_{2}(T)}^{2}\right)\le0
\]

\end_inset

其中
\begin_inset Formula 
\[
D^{(m,p)}\coloneqq\partial_{\xi}^{p+1-m}\partial_{\eta}^{m-1}
\]

\end_inset

及对称性，给出 
\begin_inset Formula $\phi_{f,j}$
\end_inset

 的一种构造方式：首先在标准单元 
\begin_inset Formula $T$
\end_inset

 上构造一组正交基函数 
\begin_inset Formula $\left\{ B_{i}\right\} _{i=1}^{N_{T}}$
\end_inset

，然后将 
\begin_inset Formula $\phi_{f,j}$
\end_inset

 表示为其线性组合
\begin_inset Formula 
\[
\phi_{f,j}(\vec{\rho})=\sum_{k=1}^{N_{T}(p)}\sigma_{k}\,B_{k}(\vec{\rho}),
\]

\end_inset

其中 
\begin_inset Formula $\left\{ \sigma_{i}\right\} _{i=1}^{N_{T}}$
\end_inset

 为待定系数，由以下 
\begin_inset Formula $N_{T}$
\end_inset

 个方程确定：
\begin_inset Formula 
\[
c\sum_{k=1}^{N_{T}}\sigma_{k}\sum_{m=1}^{p+1}\binom{p}{m-1}\left(D^{(m,p)}B_{i}\right)\left(D^{(m,p)}B_{k}\right)=-\sigma_{i}+\ip{\vec{\nu}\vdot\vec{\varphi}_{f,j}}{B_{i}}_{\partial T},
\]

\end_inset

其中 
\begin_inset Formula $0\le c<\infty$
\end_inset

 为可调参数，
\begin_inset Formula $D^{(m,p)}B_{i}\coloneqq\partial_{\xi}^{p+1-m}\partial_{\eta}^{m-1}B_{i}$
\end_inset

 为常数，
\begin_inset Formula $\vec{\nu}\vdot\vec{\varphi}_{f,j}$
\end_inset

 为 
\begin_inset Formula $(\partial T)_{f}\subset\partial T$
\end_inset

 上的 
\begin_inset Formula $p$
\end_inset

 次多项式，可以精确积分。
\end_layout

\begin_layout Section
色散耗散特性
\end_layout

\begin_layout Subsection
空间离散
\end_layout

\begin_layout Standard
为求解线性标量守恒律
\begin_inset Formula 
\[
\frac{\partial u}{\partial t}+\frac{\partial f(u)}{\partial x}=0,\quad f(u)=au,\quad a>0,
\]

\end_inset

在单元 
\begin_inset Formula $E_{j}$
\end_inset

 上引入解的多项式近似
\begin_inset Formula 
\[
u^{h}(x,t)=\sum_{k=1}^{N}\hat{u}_{k}(t)\,b_{k}(x),\quad\Span\left\{ b_{k}\right\} _{k=1}^{N}=\mathbb{P}_{N-1},
\]

\end_inset

及相应的近似通量
\begin_inset Formula 
\[
f^{h}(x,t)\coloneqq f(u^{h})=a\sum_{k=1}^{N}\hat{u}_{k}(t)\,b_{k}(x)=\sum_{j=1}^{N}\underbrace{a\hat{u}_{k}(t)}_{\hat{f}_{k}(t)}\,b_{k}(x).
\]

\end_inset

因其在定义单元界面处间断，可记为
\begin_inset Formula 
\[
f^{h}(x,t)\eqqcolon f^{\mathrm{D}}(x,t).
\]

\end_inset


\end_layout

\begin_layout Subsubsection
DG
\end_layout

\begin_layout Standard
借用 
\begin_inset Formula $u^{h}$
\end_inset

 的同一组基，定义近似 test 函数
\begin_inset Formula 
\[
w^{h}(x)=\sum_{l=1}^{N}\hat{w}_{l}\,b_{l}(x)\in\mathbb{P}_{N-1}(E_{j}),
\]

\end_inset

代入 weak form
\begin_inset Formula 
\[
\ip{w^{h}}{\partial_{t}\,u^{h}}_{E_{j}}+\ip{w^{h}}{n_{x}\,f^{\mathrm{I}}}_{\partial E_{j}}=\ip{\partial_{x}\,w^{h}}{f^{\mathrm{D}}}_{E_{j}},
\]

\end_inset

其中 
\begin_inset Formula $f^{\mathrm{I}}$
\end_inset

 为迎风 (Upwind) 通量。利用 
\begin_inset Formula $\left\{ \hat{w}_{l}\right\} _{l=1}^{N}$
\end_inset

 的任意性，可得 
\begin_inset Formula $N$
\end_inset

 个 ODEs：
\begin_inset Formula 
\[
\ip{b_{l}}{b_{k}}_{E_{j}}\frac{\dd\hat{u}_{k}}{\dd t}=\ip{\partial_{x}\,b_{l}}{f^{\mathrm{D}}}_{E_{j}}-\ip{b_{l}}{n_{x}\,f^{\mathrm{I}}}_{\partial E_{j}},\quad l=1,\dots,N.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
FR
\end_layout

\begin_layout Standard
借用 DG 的多项式近似
\begin_inset Formula 
\[
u^{h}(x,t)=\sum_{k=1}^{N}\hat{u}_{k}(t)\,b_{k}(x),\quad f^{\mathrm{D}}(x,t)=\sum_{k=1}^{N}\hat{f}_{k}(t)\,b_{k}(x),
\]

\end_inset

定义通量修正 (Correction) 函数
\begin_inset Formula 
\[
f^{\mathrm{C}}(x(\xi),t)\coloneqq\sum_{\zeta=\pm1}\left(f^{\mathrm{I}}(x(\zeta),t)-f^{\mathrm{D}}(x(\zeta),t)\right)g_{\zeta}(\xi)\text{,}
\]

\end_inset

其中 
\begin_inset Formula $g_{\pm1}\in\mathbb{P}_{N}([-1,+1])$
\end_inset

 且
\begin_inset Formula 
\[
g_{-1}(-1)=g_{+1}(+1)=1,\quad g_{-1}(+1)=g_{+1}(-1)=0,
\]

\end_inset

可以重构 (Reconstruct) 出连续通量
\begin_inset Formula 
\[
f^{\mathrm{R}}(x,t)=f^{\mathrm{D}}(x,t)+f^{\mathrm{C}}(x,t)\in\mathbb{P}_{N}(E_{j}),
\]

\end_inset

则原 PDE 可近似为
\begin_inset Formula 
\[
\frac{\partial u^{h}}{\partial t}+\frac{\partial f^{\mathrm{R}}}{\partial x}\approx\frac{\partial u}{\partial t}+\frac{\partial f}{\partial x}=0,
\]

\end_inset

在 
\begin_inset Formula $N$
\end_inset

 个 Lagrange 结点处取值，可得 
\begin_inset Formula $N$
\end_inset

 个 ODEs：
\begin_inset Formula 
\[
\frac{\dd\hat{u}_{k}(t)}{\dd t}=-\frac{\partial f^{\mathrm{R}}(x_{k},t)}{\partial x},\quad k=1,\dots,N.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
DG-with-FR
\end_layout

\begin_layout Standard
借用 DG 的多项式近似
\begin_inset Formula 
\[
u^{h}(x,t)=\sum_{k=1}^{N}\hat{u}_{k}(t)\,b_{k}(x),\quad f^{\mathrm{D}}(x,t)=\sum_{k=1}^{N}\hat{f}_{k}(t)\,b_{k}(x),\quad w^{h}=w^{h}(x)=\sum_{l=1}^{N}\hat{w}_{l}\,b_{l}(x),
\]

\end_inset

及 FR 的重构通量
\begin_inset Formula 
\[
f^{\mathrm{R}}(x,t)=f^{\mathrm{D}}(x,t)+f^{\mathrm{C}}(x,t),
\]

\end_inset

代入积分式
\begin_inset Formula 
\[
\ip{w^{h}}{\partial_{t}\,u^{h}+\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}=0,
\]

\end_inset

利用 
\begin_inset Formula $\hat{w}_{l}$
\end_inset

 的任意性、
\begin_inset Formula $\hat{u}_{k}$
\end_inset

 的空间无关性，得 
\begin_inset Formula $N$
\end_inset

 个常微分方程：
\begin_inset Formula 
\[
\ip{b_{l}}{b_{k}}\frac{\dd\hat{u}_{k}}{\dd t}=-\ip{b_{l}}{\partial_{x}\,f^{\mathrm{R}}},\quad l=1,\dots,N,
\]

\end_inset

即
\begin_inset Formula 
\[
\underbrace{\begin{bmatrix}\ip{b_{1}}{b_{1}} & \cdots & \ip{b_{1}}{b_{N}}\\
\vdots & \ddots & \vdots\\
\ip{b_{N}}{b_{1}} & \cdots & \ip{b_{N}}{b_{N}}
\end{bmatrix}}_{=\ip{\underline{b}}{\underline{b}^{\mathrm{T}}}\eqqcolon\underline{m}}\frac{\dd}{\dd t}\underbrace{\begin{bmatrix}\hat{u}_{1}\\
\vdots\\
\hat{u}_{N}
\end{bmatrix}}_{\underline{\hat{u}}}=\underbrace{\begin{bmatrix}-\ip{b_{1}}{\partial_{x}\,f^{\mathrm{R}}}\\
\vdots\\
-\ip{b_{N}}{\partial_{x}\,f^{\mathrm{R}}}
\end{bmatrix}}_{=-\ip{\underline{b}}{\partial_{x}\,f^{\mathrm{R}}}\eqqcolon\underline{r}},
\]

\end_inset

其中 
\begin_inset Formula $\underline{b}\coloneqq\begin{bmatrix}b_{1} & \cdots & b_{N}\end{bmatrix}^{\mathrm{T}}$
\end_inset

.
\end_layout

\begin_layout Subsection
修正波数
\end_layout

\begin_layout Standard
上述所有格式都是线性的，可以统一为
\begin_inset Formula 
\[
\frac{\dd}{\dd t}\underline{\hat{u}}_{j}=\underline{r}_{j}\qty(\underline{\hat{u}}_{j},\underline{\hat{u}}_{j-1},\underline{\hat{u}}_{j+1})=\underline{S}_{j}\,\underline{\hat{u}}_{j}+\underline{S}_{j-1}\,\underline{\hat{u}}_{j-1}+\underline{S}_{j+1}\,\underline{\hat{u}}_{j+1},
\]

\end_inset

其中 
\begin_inset Formula $\underline{S}_{j},\underline{S}_{j-1},\underline{S}_{j+1}$
\end_inset

 为实常值矩阵，且可以数值地构造：遍历 
\begin_inset Formula $k=1,\dots,N$
\end_inset

，依次取
\begin_inset Formula 
\[
\underline{S}_{j}\vert k\rangle=\underline{r}_{j}\qty(\vert k\rangle,\vert0\rangle,\vert0\rangle),\quad\underline{S}_{j-1}\vert k\rangle=\underline{r}_{j}\qty(\vert0\rangle,\vert k\rangle,\vert0\rangle),\quad\underline{S}_{j+1}\vert k\rangle=\underline{r}_{j}\qty(\vert0\rangle,\vert0\rangle,\vert k\rangle).
\]

\end_inset

若网格均匀，且基函数 
\begin_inset Formula $\underline{b}_{j}$
\end_inset

 在相对坐标下具有相同的形式，则 
\begin_inset Formula $\underline{S}_{j},\underline{S}_{j-1},\underline{S}_{j+1}$
\end_inset

 对所有单元相同。
\end_layout

\begin_layout Standard
若初值为 
\begin_inset Formula $u(x,t=0)=\exp(\ii\kappa x)$
\end_inset

，则均匀网格 
\begin_inset Formula $x_{j}=jh$
\end_inset

 上的许可解为
\begin_inset Formula 
\[
\underline{\hat{u}}_{j}(t)=\underline{\tilde{u}}\exp(\ii\kappa jh-\ii\omega t)\implies\underline{\hat{u}}_{j-1}(t)=\underline{\hat{u}}_{j}(t)\exp(-\ii\kappa h),
\]

\end_inset

因此有
\begin_inset Formula 
\[
\frac{\dd}{\dd t}\underline{\hat{u}}_{j}=\underline{S}\,\underline{\hat{u}}_{j},\quad\underline{S}(\kappa h)\coloneqq\underline{S}_{j}+\underline{S}_{j-1}\exp(-\ii\kappa h)+\underline{S}_{j+1}\exp(+\ii\kappa h),
\]

\end_inset

其中 
\begin_inset Formula $\underline{S}$
\end_inset

 为复常值矩阵，均匀网格上不依赖于 
\begin_inset Formula $j$
\end_inset

，而只依赖于无量纲波数 
\begin_inset Formula $\kappa h$
\end_inset

。因 
\begin_inset Formula $\underline{S}$
\end_inset

 对 
\begin_inset Formula $\kappa h$
\end_inset

 具有周期性
\begin_inset Formula 
\[
\underline{S}(\kappa h)=\underline{S}(\kappa h+m2\mathrm{\pi}),\quad\forall m\in\mathbb{Z},
\]

\end_inset

故只需考虑 
\begin_inset Formula $\kappa h$
\end_inset

 在 
\begin_inset Formula $[-\mathrm{\pi},\mathrm{\pi}]$
\end_inset

 内取值。
\end_layout

\begin_layout Standard
特征值问题
\begin_inset Formula 
\[
-\ii\omega\,\underline{\tilde{u}}=\underline{S}\,\underline{\tilde{u}}\impliedby\begin{cases}
\frac{\dd}{\dd t}\underline{\hat{u}}_{j}=\underline{S}\,\underline{\hat{u}}_{j}\\
\underline{\hat{u}}_{j}(t)=\underline{\tilde{u}}\exp(\ii\kappa jh-\ii\omega t)
\end{cases}
\]

\end_inset

的解（修正波数 
\begin_inset Formula $\omega/a\eqqcolon\tilde{\kappa}$
\end_inset

）体现了空间离散格式的色散、耗散特性。解之得 
\begin_inset Formula $N$
\end_inset

 个模态 
\begin_inset Formula $\left\{ \left(\omega_{l},\underline{\tilde{u}}_{l}\right)\right\} _{l=1}^{N}$
\end_inset

，实际解是这 
\begin_inset Formula $N$
\end_inset

 个模态的叠加：
\begin_inset Formula 
\[
\underline{\hat{u}}_{j}(t)=\sum_{l=1}^{N}C_{l}\,\underline{\tilde{u}}_{l}\exp(\ii\kappa jh-\ii\omega_{l}t),
\]

\end_inset

其中 
\begin_inset Formula $C_{l}$
\end_inset

 由初始条件决定：
\begin_inset Formula 
\[
\underline{\hat{u}}_{j}(0)=\sum_{l=1}^{N}C_{l}\,\underline{\tilde{u}}_{l}\exp(\ii\kappa jh),\quad\hat{u}_{j,k}(0)=\begin{cases}
\exp(\ii\kappa x_{j,k}), & \text{Lagrange basis}\\
\dfrac{\ip{b_{k}}{\exp(\ii\kappa x)}}{\ip{b_{k}}{b_{k}}}, & \text{Legendre basis}
\end{cases}
\]

\end_inset


\end_layout

\begin_layout Subsubsection
物理模态与寄生模态
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Hu_1999"
literal "true"

\end_inset

 定义：在 
\begin_inset Formula $[-N\mathrm{\pi},+N\mathrm{\pi}]$
\end_inset

 内满足 
\begin_inset Formula $\omega_{l}\approx\kappa a$
\end_inset

 的那个模态为物理模态，其余为寄生模态。
\end_layout

\begin_layout Quote
The numerical solution (3.9) is a superposition of 
\begin_inset Formula $N$
\end_inset

 waves traveling at different phase speeds.
 We define the physical mode as one with the frequency that approximates
 the exact dispersion relation for a range of wave numbers.
 The others are the parasite modes associated with the numerical scheme.
 — 
\begin_inset CommandInset citation
LatexCommand citet
key "Hu_1999"
literal "true"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Subsubsection
基准波数与真实波数
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Helenbrook_2006"
literal "false"

\end_inset

 指出：寄生模态的 
\begin_inset Formula $\tilde{\kappa}h$
\end_inset

–
\begin_inset Formula $\kappa h$
\end_inset

 曲线，可以由物理模态的 
\begin_inset Formula $\tilde{\kappa}h$
\end_inset

–
\begin_inset Formula $\kappa h$
\end_inset

 曲线沿 
\begin_inset Formula $\kappa h$
\end_inset

 轴平移 
\begin_inset Formula $2\mathrm{\pi}$
\end_inset

 的整数倍而得到。在 
\begin_inset Formula $[(m-1)\mathrm{\pi},m\mathrm{\pi}]$
\end_inset

 内取 
\begin_inset Formula $\kappa h$
\end_inset

，将所得的 
\begin_inset Formula $\left\{ (\tilde{\kappa}h)_{l}\right\} _{l=1}^{N}$
\end_inset

 按模由小到大排序，其中排第 
\begin_inset Formula $m$
\end_inset

 的为物理模态。
\end_layout

\begin_layout Quote
We also have unrolled the 
\begin_inset Formula $p+1$
\end_inset

 eigenvalues in 
\begin_inset Formula $\theta$
\end_inset

; at any value of 
\begin_inset Formula $\theta$
\end_inset

 we have 
\begin_inset Formula $p+1$
\end_inset

 eigenvalues.
 The larger eigenvalues correspond physically to eigenfunctions with a wave
 number that is shifted by an integer multiple of 
\begin_inset Formula $2\mathrm{\pi}$
\end_inset

 from 
\begin_inset Formula $\theta$
\end_inset

.
 We order the eigenvalues by magnitude and then assign the eigenvalues to
 the expanded domain 
\begin_inset Formula $[0,(p+1)\mathrm{\pi}]$
\end_inset

.
 — 
\begin_inset CommandInset citation
LatexCommand citet
key "Helenbrook_2006"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Vincent_2011"
literal "true"

\end_inset

 给出一种方法，将每个模态都关联到 
\begin_inset Formula $[-N\mathrm{\pi},+N\mathrm{\pi}]$
\end_inset

 内的 true wavenumber 
\begin_inset Formula $\kappa h$
\end_inset

：在 
\begin_inset Formula $[-\mathrm{\pi},+\mathrm{\pi}]$
\end_inset

 内取充分多 baseline wavenumbers，对每个这样的 
\begin_inset Formula $\bar{\kappa}h$
\end_inset

：
\end_layout

\begin_layout Itemize
计算相应的 
\begin_inset Formula $\underline{S}$
\end_inset

 及 
\begin_inset Formula $\left\{ \left(\omega_{l},\underline{\tilde{u}}_{l}\right)\right\} _{l=1}^{N}$
\end_inset

，将每个 
\begin_inset Formula $\underline{\tilde{u}}_{l}$
\end_inset

 所表示的多项式在 Legendre 基上投影。
\end_layout

\begin_layout Itemize
假设已确定 
\begin_inset Formula $m$
\end_inset

 个模态所对应的 true wavenumbers 
\begin_inset Formula $\left\{ (\kappa h)_{l}\right\} _{l=1}^{m}$
\end_inset

，在第 
\begin_inset Formula $m+1$
\end_inset

 步：
\end_layout

\begin_deeper
\begin_layout Itemize
在剩余 
\begin_inset Formula $N-m$
\end_inset

 个模态中，寻找在第 
\begin_inset Formula $m+1$
\end_inset

 个 Legendre 基（
\begin_inset Formula $m$
\end_inset

 次 Legendre 多项式）上能量最大的一个。
\end_layout

\begin_layout Itemize
为其寻找 
\begin_inset Formula $n\in\mathbb{Z}$
\end_inset

，使得 
\begin_inset Formula $\vert\bar{\kappa}h+n2\mathrm{\pi}\vert$
\end_inset

 最小，且 
\begin_inset Formula $n$
\end_inset

 不曾被前 
\begin_inset Formula $m$
\end_inset

 个模态用过。以 
\begin_inset Formula $\bar{\kappa}h+n2\mathrm{\pi}$
\end_inset

 为第 
\begin_inset Formula $m+1$
\end_inset

 个 true wavenumber。
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
若 
\begin_inset Formula $E_{j}$
\end_inset

 非边界单元，则 
\begin_inset Formula $\bar{\kappa}h$
\end_inset

 可取 
\begin_inset Formula $[-\mathrm{\pi},\mathrm{\pi}]$
\end_inset

 内的任意值；否则只能考虑 
\begin_inset Formula $[-L,L]$
\end_inset

 内的周期解，即 
\begin_inset Formula $\bar{\kappa}h$
\end_inset

 只能取如下离散值：
\begin_inset Formula 
\[
\bar{k}\in\mathbb{Z}\cap\left[-\frac{N_{E}}{2},\frac{N_{E}}{2}\right]\impliedby\begin{cases}
\bar{\kappa}h\in[-\mathrm{\pi},\mathrm{\pi}]\\
\bar{\kappa}L/\mathrm{\pi}\eqqcolon\bar{k}\in\mathbb{Z}\\
h\coloneqq2L/N_{E}
\end{cases}
\]

\end_inset


\end_layout

\begin_layout Subsubsection
时域分析与空间分析
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Hu_2002,Mengaldo_2018"
literal "true"

\end_inset

 注意到特征值问题
\begin_inset Formula 
\[
(\tilde{\kappa}h)\,\frac{a}{\ii h}\,\underline{\tilde{u}}=\underline{S}(\kappa h)\,\underline{\tilde{u}}
\]

\end_inset

的自变量、应变量地位对等，故定义：
\end_layout

\begin_layout Itemize
以 
\begin_inset Formula $\kappa h$
\end_inset

 为实自变量，
\begin_inset Formula $\tilde{\kappa}h$
\end_inset

 为复应变量的分析为时域分析，每个 
\begin_inset Formula $\kappa h$
\end_inset

 对应 
\begin_inset Formula $N$
\end_inset

 个 
\begin_inset Formula $\tilde{\kappa}h$
\end_inset

。该方法只适用于均匀网格。
\end_layout

\begin_layout Itemize
以 
\begin_inset Formula $\tilde{\kappa}h$
\end_inset

 为实自变量，
\begin_inset Formula $\kappa h$
\end_inset

 为复应变量的分析为空间分析，每个 
\begin_inset Formula $\tilde{\kappa}h$
\end_inset

 对应 2 个 
\begin_inset Formula $\kappa h$
\end_inset

。该方法适用于非均匀网格。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Subsubsection
离散 Fourier 分析
\end_layout

\begin_layout Standard
在全局取 
\begin_inset Formula $n=10N_{E}$
\end_inset

 个均布采样点，比较 
\begin_inset Formula $u^{h}(x,t)$
\end_inset

 在 
\begin_inset Formula $t=0$
\end_inset

 与 
\begin_inset Formula $t=\tau$
\end_inset

 的 DFT 系数：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\tilde{\kappa}h\coloneqq\frac{\ii h}{a\tau}\ln\frac{\hat{u}_{k}^{h}(t=\tau)}{\hat{u}_{k}^{h}(t=0)}=\frac{\ii h}{a\tau}\ln\frac{\sum_{j=0}^{n-1}u^{h}(x_{j},t=\tau)\,w^{-jk}}{\sum_{j=0}^{n-1}u^{h}(x_{j},t=0)\,w^{-jk}},\quad w\coloneqq\exp(\ii\frac{2\mathrm{\pi}}{n}).
\]

\end_inset


\end_layout

\begin_layout Subsection
等价性
\begin_inset CommandInset label
LatexCommand label
name "sec:DGequivFR"

\end_inset


\end_layout

\begin_layout Subsubsection
DG 
\begin_inset Formula $\iff$
\end_inset

 DG-with-FR
\end_layout

\begin_layout Standard
DG 格式的 weak form 为
\begin_inset Formula 
\[
\ip{w^{h}}{\partial_{t}\,u^{h}}_{E_{j}}+\ip{w^{h}}{n_{x}\,f^{\mathrm{I}}}_{\partial E_{j}}=\ip{\partial_{x}\,w^{h}}{f^{\mathrm{D}}}_{E_{j}},
\]

\end_inset

对其右端项再次分部积分，得
\begin_inset Formula 
\[
\ip{w^{h}}{\partial_{t}\,u^{h}+\partial_{x}\,f^{\mathrm{D}}}_{E_{j}}+\ip{w^{h}}{n_{x}\,f^{\mathrm{I}}-n_{x}\,f^{\mathrm{D}}}_{\partial E_{j}}=0,
\]

\end_inset

为得到与 DG-with-FR 格式等价的
\begin_inset Formula 
\[
\ip{w^{h}}{\partial_{t}\,u^{h}+\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}=0,
\]

\end_inset

只需证明
\begin_inset Formula 
\[
\ip{w^{h}}{n_{x}\,f^{\mathrm{I}}-n_{x}\,f^{\mathrm{D}}}_{\partial E_{j}}=\ip{w^{h}}{\partial_{x}\,f^{\mathrm{C}}}_{E_{j}},
\]

\end_inset

即
\begin_inset Formula 
\[
\left(f^{\mathrm{I}}\,w^{h}-f^{\mathrm{D}}\,w^{h}\right)_{\xi=-1}^{\xi=+1}=\int_{-1}^{+1}\underbrace{\left(\frac{\partial x}{\partial\xi}\right)^{-1}\frac{\partial f^{\mathrm{C}}}{\partial\xi}}_{\partial_{x}\,f^{\mathrm{C}}}w^{h}\left|\frac{\partial x}{\partial\xi}\right|\dd{\xi},
\]

\end_inset

对于非退化且非变向坐标变换，有
\begin_inset Formula 
\[
\left(\frac{\partial x}{\partial\xi}\right)^{-1}\left|\frac{\partial x}{\partial\xi}\right|=1,
\]

\end_inset

故只需要证明
\begin_inset Formula 
\[
\left(f^{\mathrm{I}}\,w^{h}-f^{\mathrm{D}}\,w^{h}\right)_{\xi=-1}^{\xi=+1}=\int_{-1}^{+1}\frac{\partial f^{\mathrm{C}}}{\partial\xi}w^{h}\dd{\xi},
\]

\end_inset

根据修正函数 
\begin_inset Formula $f^{\mathrm{C}}$
\end_inset

 的定义，其局部导数为
\begin_inset Formula 
\[
\frac{\partial f^{\mathrm{C}}}{\partial\xi}=\sum_{\zeta=\pm1}\left(f^{\mathrm{I}}(x(\zeta),t)-f^{\mathrm{D}}(x(\zeta),t)\right)\frac{\dd g_{\zeta}(\xi)}{\dd\xi},
\]

\end_inset

代入上述右端积分，并分部积分，得
\begin_inset Formula 
\[
\begin{aligned}\int_{-1}^{+1}\frac{\partial f^{\mathrm{C}}}{\partial\xi}w^{h}\dd{\xi} & =\int_{-1}^{+1}\sum_{\zeta=\pm1}\left(f^{\mathrm{I}}(x(\zeta),t)-f^{\mathrm{D}}(x(\zeta),t)\right)\frac{\dd g_{\zeta}(\xi)}{\dd\xi}w^{h}(x(\xi))\dd{\xi}\\
 & =\sum_{\zeta=\pm1}\left(f^{\mathrm{I}}(x(\zeta),t)-f^{\mathrm{D}}(x(\zeta),t)\right)\left(g_{\zeta}(\xi)\,w^{h}(x(\xi))\right)_{\xi=-1}^{\xi=+1}\\
 & -\sum_{\zeta=\pm1}\left(f^{\mathrm{I}}(x(\zeta),t)-f^{\mathrm{D}}(x(\zeta),t)\right)\int_{-1}^{+1}g_{\zeta}(\xi)\frac{\dd w^{h}(x(\xi))}{\dd\xi}\dd{\xi},
\end{aligned}
\]

\end_inset

利用
\begin_inset Formula 
\[
g_{-1}(-1)=g_{+1}(+1)=1,\quad g_{-1}(+1)=g_{+1}(-1)=0,
\]

\end_inset

可得
\begin_inset Formula 
\[
\sum_{\zeta=\pm1}\left(f^{\mathrm{I}}(x(\zeta),t)-f^{\mathrm{D}}(x(\zeta),t)\right)\left(g_{\zeta}(\xi)\,w^{h}(x(\xi))\right)_{\xi=-1}^{\xi=+1}=\left(f^{\mathrm{I}}\,w^{h}-f^{\mathrm{D}}\,w^{h}\right)_{\xi=-1}^{\xi=+1},
\]

\end_inset

而最后一行的积分可由正交性消除：
\begin_inset Formula 
\[
\int_{-1}^{+1}g_{\zeta}(\xi)\frac{\dd w^{h}(x(\xi))}{\dd\xi}\dd{\xi}=0\impliedby\begin{cases}
w^{h}\in\mathbb{P}_{N-1}\\
g_{\zeta}\perp\mathbb{P}_{N-2}
\end{cases}
\]

\end_inset

因此，DG 与利用 
\begin_inset Formula $g_{\zeta}\perp\mathbb{P}_{N-2}$
\end_inset

 的 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
DG-with-FR
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
 等价。
\end_layout

\begin_layout Subsubsection
DG-with-FR 
\begin_inset Formula $\iff$
\end_inset

 FR
\end_layout

\begin_layout Standard
构造 DG-with-FR 的积分式
\begin_inset Formula 
\[
\ip{w^{h}}{\partial_{t}\,u^{h}+\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}=0,
\]

\end_inset

即
\begin_inset Formula 
\[
\ip{b_{k}}{\partial_{t}\,u^{h}+\partial_{x}\,f^{\mathrm{R}}}_{E_{j}},\quad\forall k\in\left\{ 1,\dots,N\right\} ,
\]

\end_inset

的被积函数至多为 
\begin_inset Formula $(N-1)+(N-1)$
\end_inset

 次，精确数值积分需 
\begin_inset Formula $N$
\end_inset

 个 Gauss–Legendre 积分点；FR 所用 Lagrange 插值亦需 
\begin_inset Formula $N$
\end_inset

 个结点；若二者相同，则 
\begin_inset Formula $\forall k\in\left\{ 1,\dots,N\right\} $
\end_inset

 有
\begin_inset Formula 
\[
\ip{b_{k}}{\partial_{t}\,u^{h}+\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}=\sum_{l=1}^{N}\underbrace{b_{k}(x_{l})}_{\delta_{kl}}\left(\partial_{t}\,u^{h}+\partial_{x}\,f^{\mathrm{R}}\right)_{x_{l}}W_{l}=\left(\partial_{t}\,u^{h}+\partial_{x}\,f^{\mathrm{R}}\right)_{x_{k}}W_{l}=0,
\]

\end_inset

因此，
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
DG-with-FR
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
 与以 Gauss–Legendre 积分点为 Lagrange 插值结点的 FR 等价。
\end_layout

\begin_layout Subsubsection
DG-with-FR without Quadrature
\end_layout

\begin_layout Standard
DG-with-FR 的另一种 quadrature free 实现：取正交基，则
\begin_inset Formula 
\[
0=\ip{b_{k}}{\partial_{t}\,u^{h}+\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}=\ip{b_{k}}{\partial_{t}\,u^{h}}_{E_{j}}+\ip{b_{k}}{\partial_{x}\,f^{\mathrm{D}}}_{E_{j}}+\ip{b_{k}}{\partial_{x}\,f^{\mathrm{C}}}_{E_{j}},
\]

\end_inset

可化为
\begin_inset Formula 
\[
\ip{b_{k}}{\partial_{t}\,u^{h}}_{E_{j}}=\ip{b_{k}}{\partial_{t}\,\sum_{l=1}^{N}\hat{u}_{l}\,b_{l}}_{E_{j}}=\sum_{l=1}^{N}\ip{b_{k}}{b_{l}}_{E_{j}}\left(\partial_{t}\,\hat{u}_{l}\right)=\ip{b_{k}}{b_{k}}_{E_{j}}\left(\partial_{t}\,\hat{u}_{k}\right),
\]

\end_inset


\begin_inset Formula 
\[
\ip{b_{k}}{\partial_{x}\,f^{\mathrm{D}}}_{E_{j}}=\ip{b_{k}}{\partial_{x}\,\sum_{l=1}^{N}\hat{f}_{l}\,b_{l}}_{E_{j}}=\sum_{l=1}^{N}\ip{b_{k}}{\partial_{x}\,b_{l}}_{E_{j}}\hat{f}_{l}=\sum_{l=k+1}^{N}\ip{b_{k}}{\partial_{x}\,b_{l}}_{E_{j}}\hat{f}_{l},
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\ip{b_{k}}{\partial_{x}\,f^{\mathrm{C}}}_{E_{j}}=\ip{b_{k}}{\sum_{\zeta=\pm1}\left(f^{\mathrm{I}}-f^{\mathrm{D}}\right)_{\zeta}\frac{\dd g_{\zeta}}{\dd x}}_{E_{j}}=\sum_{\zeta=\pm1}\left(f^{\mathrm{I}}-f^{\mathrm{D}}\right)_{\zeta}\ip{b_{k}}{\frac{\dd g_{\zeta}}{\dd x}}_{E_{j}},
\]

\end_inset

其中 
\begin_inset Formula $\ip{b_{k}}{\partial_{x}\,b_{l}}_{E_{j}}$
\end_inset

 为严格上三角阵，且不能进一步简化：
\begin_inset Formula 
\[
\ip{b_{k}}{\partial_{x}\,b_{l+2}}_{E_{j}}=\ip{b_{k}}{\partial_{x}\,b_{l}}_{E_{j}}\ne0\impliedby\begin{cases}
\ip{b_{k}}{\partial_{x}\,b_{l}}_{E_{j}}\ne0\\
\partial_{x}\,b_{l+2}-\partial_{x}\,b_{l}=(2l+3)\,b_{l+1}\\
\ip{b_{k}}{b_{l+1}}_{E_{j}}=0\impliedby k<l+1
\end{cases}
\]

\end_inset


\end_layout

\begin_layout Subsubsection
\begin_inset Formula $\mathbb{P}_{N-1}$
\end_inset

 的所有基等价
\end_layout

\begin_layout Standard
\begin_inset Formula $\mathbb{P}_{N-1}(E_{j})$
\end_inset

 的任意两组基之间有非退化的线性变换
\begin_inset Formula 
\[
\underline{b}_{j}=\underline{C}\,\underline{b}'_{j}\implies\begin{cases}
\underline{\hat{u}}_{j}=\underline{C}^{-\mathrm{T}}\,\underline{\hat{u}}_{j}',\\
\underline{\hat{w}}_{j}=\underline{C}^{-\mathrm{T}}\,\underline{\hat{w}}_{j}',
\end{cases}
\]

\end_inset

因此有
\begin_inset Formula 
\[
\begin{aligned}\ip{w^{h}}{\partial_{t}\,u^{h}}_{E_{j}} & =\ip{\underline{\hat{w}}_{j}^{\mathrm{T}}\,\underline{b}_{j}}{\partial_{t}\,\underline{\hat{u}}_{j}^{\mathrm{T}}\,\underline{b}_{j}}_{E_{j}}=\ip{\left(\underline{C}^{-\mathrm{T}}\,\underline{\hat{w}}'_{j}\right)^{\mathrm{T}}\underline{b}_{j}}{\partial_{t}\left(\underline{C}^{-\mathrm{T}}\,\underline{\hat{u}}'_{j}\right)^{\mathrm{T}}\underline{b}_{j}}_{E_{j}}\\
 & =\left(\underline{C}^{-\mathrm{T}}\,\underline{\hat{w}}'_{j}\right)^{\mathrm{T}}\ip{\underline{b}_{j}}{\underline{b}_{j}^{\mathrm{T}}}_{E_{j}}\frac{\dd}{\dd t}\left(\underline{C}^{-\mathrm{T}}\,\underline{\hat{u}}'_{j}\right)\\
 & =\left(\underline{\hat{w}}'_{j}\right)^{\mathrm{T}}\underline{C}^{-1}\ip{\underline{b}_{j}}{\underline{b}_{j}^{\mathrm{T}}}_{E_{j}}\underline{C}^{-\mathrm{T}}\,\frac{\dd}{\dd t}\underline{\hat{u}}'_{j},
\end{aligned}
\]

\end_inset


\begin_inset Formula 
\[
\begin{aligned}\ip{w^{h}}{\partial_{x}\,f^{\mathrm{R}}}_{E_{j}} & =\ip{\underline{\hat{w}}_{j}^{\mathrm{T}}\,\underline{b}_{j}}{\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}=\ip{\left(\underline{C}^{-\mathrm{T}}\,\underline{\hat{w}}'_{j}\right)^{\mathrm{T}}\underline{b}_{j}}{\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}\\
 & =\left(\underline{C}^{-\mathrm{T}}\,\underline{\hat{w}}'_{j}\right)^{\mathrm{T}}\ip{\underline{b}_{j}}{\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}\\
 & =\left(\underline{\hat{w}}'_{j}\right)^{\mathrm{T}}\underline{C}^{-1}\ip{\underline{b}_{j}}{\partial_{x}\,f^{\mathrm{R}}}_{E_{j}},
\end{aligned}
\]

\end_inset

从而有
\begin_inset Formula 
\[
\begin{aligned}\frac{\dd}{\dd t}\underline{\hat{u}}'_{j} & =\left(\underline{C}^{-1}\ip{\underline{b}_{j}}{\underline{b}_{j}^{\mathrm{T}}}_{E_{j}}\underline{C}^{-\mathrm{T}}\right)^{-1}\left(-\underline{C}^{-1}\ip{\underline{b}_{j}}{\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}\right)\\
 & =\underline{C}^{\mathrm{T}}\left(-\ip{\underline{b}_{j}}{\underline{b}_{j}^{\mathrm{T}}}_{E_{j}}^{-1}\ip{\underline{b}_{j}}{\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}\right),
\end{aligned}
\]

\end_inset

即
\begin_inset Formula 
\[
\frac{\dd}{\dd t}\underline{\hat{u}}_{j}'=\underline{C}^{\mathrm{T}}\,\underline{S}\,\underline{C}^{-\mathrm{T}}\,\underline{\hat{u}}_{j}'\impliedby\frac{\dd}{\dd t}\underline{\hat{u}}_{j}=\underline{S}\,\underline{\hat{u}}_{j},
\]

\end_inset

其中 
\begin_inset Formula $\underline{C}^{\mathrm{T}}\,\underline{S}\,\underline{C}^{-\mathrm{T}}$
\end_inset

 与 
\begin_inset Formula $\underline{S}$
\end_inset

 有相同的特征值，因此相应的空间离散格式有相同的色散、耗散特性。
\end_layout

\begin_layout Section
黏性项处理
\end_layout

\begin_layout Subsection
BR (Bassi–Rebay)
\end_layout

\begin_layout Subsubsection
BR1
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand cite
key "Bassi_1997"
literal "true"

\end_inset


\end_layout

\begin_layout Subsubsection
BR2
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand cite
key "Bassi_2005"
literal "true"

\end_inset


\end_layout

\begin_layout Subsection
LDG (Local DG)
\end_layout

\begin_layout Subsubsection
一维传热问题
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Cockburn_2001"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
一维传热方程
\begin_inset Formula 
\[
\partial_{t}\,u-\partial_{x}^{2}\,u=0,\quad(x,t)\in(0,2\pi)\times(0,T)
\]

\end_inset

及初始条件
\begin_inset Formula 
\[
u(x,0)=\sin(x),\quad x\in(0,2\pi)
\]

\end_inset


\end_layout

\begin_layout Paragraph
错误格式
\end_layout

\begin_layout Standard
将 
\begin_inset Formula $-\partial_{x}\,u$
\end_inset

 视为守恒律中的 
\begin_inset Formula $f(u)$
\end_inset

，在形式上应用 DG 方法：
\begin_inset Formula 
\[
\ip{v^{h}}{\partial_{t}\,u^{h}}_{E_{i}}+\ip{\partial_{x}\,v^{h}}{\partial_{x}\,u^{h}}_{E_{i}}=\ip{v^{h}}{\partial_{n}\,u^{h}}_{\partial E_{i}},
\]

\end_inset

其中 
\begin_inset Formula $u^{h},v^{h}$
\end_inset

 均取自 
\begin_inset Formula $\mathbb{P}_{k}(E_{i})$
\end_inset


\end_layout

\begin_layout Standard
边界项中的 
\begin_inset Formula $\partial_{n}\,u^{h}\coloneqq n_{x}\,\partial_{x}\,u^{h}$
\end_inset

 为（法向）“数值通量”，因缺少迎风性质，自然地取平均值
\begin_inset Formula 
\[
\partial_{x}\,u^{h}=\frac{\left(\partial_{x}\,u^{h}\right)_{\mathrm{L}}+\left(\partial_{x}\,u^{h}\right)_{\mathrm{R}}}{2}
\]

\end_inset

时间离散用 TVD RK3 格式，所得结果表现出 inconsistency。
\end_layout

\begin_layout Paragraph
正确格式
\end_layout

\begin_layout Standard
引入新变量 
\begin_inset Formula $q\coloneqq\partial_{x}\,u$
\end_inset

，将方程 
\begin_inset Formula $\partial_{t}\,u-\partial_{x}^{2}\,u=0$
\end_inset

 化为一阶，二者合并组成一阶方程组
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{cases}
\partial_{t}\,u-\partial_{x}\,q=0,\\
q-\partial_{x}\,u=0,
\end{cases}
\]

\end_inset


\end_layout

\begin_layout Standard
在形式上应用 DG 方法：
\begin_inset Formula 
\[
\begin{cases}
\ip{v^{h}}{\partial_{t}\,u^{h}}_{E_{i}}+\ip{\partial_{x}\,v^{h}}{q^{h}}_{E_{i}}=\ip{v^{h}}{q_{n}^{h}}_{\partial E_{i}},\\
\ip{w^{h}}{q^{h}}_{E_{i}}+\ip{\partial_{x}\,w^{h}}{u^{h}}_{E_{i}}=\ip{w^{h}}{u_{n}^{h}}_{\partial E_{i}},
\end{cases}
\]

\end_inset

其中 
\begin_inset Formula $u^{h},v^{h},w^{h},q^{h}$
\end_inset

 均取自 
\begin_inset Formula $\mathbb{P}_{k}(E_{i})$
\end_inset


\end_layout

\begin_layout Standard
边界项中的 
\begin_inset Formula $u_{n}^{h}$
\end_inset

 及 
\begin_inset Formula $q_{n}^{h}$
\end_inset

 为（法向）“数值通量”，因缺少迎风性质，可以自然地取平均值
\begin_inset Formula 
\[
u_{n}^{h}=n_{x}\frac{u_{\mathrm{L}}^{h}+u_{\mathrm{R}}^{h}}{2},\quad q_{n}^{h}=n_{x}\frac{q_{\mathrm{L}}^{h}+q_{\mathrm{R}}^{h}}{2},
\]

\end_inset

或按 
\begin_inset CommandInset citation
LatexCommand citet
key "Cockburn_1998b"
literal "false"

\end_inset

 建议取
\begin_inset Formula 
\[
u_{n}^{h}=n_{x}\,u_{\mathrm{L}}^{h},\quad q_{n}^{h}=n_{x}\,q_{\mathrm{R}}^{h}
\]

\end_inset

 或
\begin_inset Formula 
\[
u_{n}^{h}=n_{x}\,u_{\mathrm{R}}^{h},\quad q_{n}^{h}=n_{x}\,q_{\mathrm{L}}^{h}
\]

\end_inset


\end_layout

\begin_layout Subsubsection
高维标量问题
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\partial_{t}\,u+\partial_{i}\left(f_{i}(u)-a_{ik}(u)\left(\partial_{k}\,u\right)\right)=0,\quad(t,\vec{r})\in(0,T)\times(0,1)^{d}
\]

\end_inset


\begin_inset Formula 
\[
u(t,\vec{r})=u_{0}(\vec{r}),\quad\vec{r}\in(0,1)^{d}
\]

\end_inset

其中 
\begin_inset Formula $a_{ik}(u)$
\end_inset

 对称、半正定，从而存在矩阵 
\begin_inset Formula $b_{ik}(u)$
\end_inset

 使得
\begin_inset Formula 
\[
a_{ik}(u)=b_{il}(u)\,b_{lk}(u)
\]

\end_inset


\end_layout

\begin_layout Standard
定义辅助变量
\begin_inset Formula 
\[
q_{l}(t,\vec{r})\coloneqq b_{lk}(u)\left(\partial_{k}\,u\right),\quad l=1,2,\dots,d
\]

\end_inset

则高阶方程化为一阶方程组
\begin_inset Formula 
\[
\begin{cases}
\partial_{t}\,u+\partial_{i}\left(f_{i}(u)-b_{il}(u)\,q_{l}\right)=0,\\
q_{l}-\partial_{k}\,g_{lk}(u)=0, & l=1,2,\dots,d
\end{cases}
\]

\end_inset

其中
\begin_inset Formula 
\[
g_{lk}(u)\coloneqq\int^{u}b_{lk}(s)\dd{s}
\]

\end_inset


\end_layout

\begin_layout Standard
在形式上应用 DG 方法：
\begin_inset Formula 
\[
\ip{v^{h}}{\partial_{t}\,u^{h}}_{E_{j}}+\ip{v^{h}}{\nu_{i}\,f_{i}^{h}-\nu_{i}\,b_{il}^{h}\,q_{l}^{h}}_{\partial E_{j}}=\ip{\partial_{i}v^{h}}{f_{i}^{h}-b_{il}^{h}\,q_{l}^{h}}_{E_{j}},
\]

\end_inset


\begin_inset Formula 
\[
\ip{w^{h}}{q_{l}^{h}}_{E_{j}}+\ip{\partial_{k}\,w^{h}}{g_{lk}^{h}}_{E_{j}}=\ip{w^{h}}{\nu_{k}\,g_{lk}^{h}}_{\partial E_{j}},\quad l=1,2,\dots,d
\]

\end_inset

其中对流通量
\begin_inset Formula 
\[
\left(\nu_{i}\,f_{i}^{h}\right)_{\partial E}\approx f_{\nu}(u_{\mathrm{L}}^{h},u_{\mathrm{R}}^{h})
\]

\end_inset

由纯对流问题的 Riemann 解给出；而扩散通量取作
\begin_inset Formula 
\[
\left(\nu_{i}\,b_{il}^{h}\,q_{l}^{h}\right)_{\partial E}\approx\frac{\left\llbracket \nu_{k}\,g_{lk}^{h}\right\rrbracket }{\left\llbracket u^{h}\right\rrbracket }\left\{ q_{l}^{h}\right\} +C_{11}\left\llbracket u^{h}\right\rrbracket +C_{1l}\left\{ q_{l}^{h}\right\} 
\]

\end_inset


\begin_inset Formula 
\[
\left(\nu_{k}\,g_{lk}^{h}\right)_{\partial E}\approx\left\{ \nu_{k}\,g_{lk}^{h}\right\} -C_{1l}\left\llbracket u^{h}\right\rrbracket ,\quad l=1,2,\dots,d
\]

\end_inset


\end_layout

\begin_layout Subsubsection
高维系统问题
\end_layout

\begin_layout Subsubsection
LDG for FR
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Castonguay_2013,Williams_2013"
literal "false"

\end_inset

 借用 LDG 方法，将二阶 PDE 改写为一阶 PDE 系统：
\begin_inset Formula 
\[
\frac{\partial u}{\partial t}+\frac{\partial f^{\mathrm{c}}(u)}{\partial x}=\frac{\partial f^{\mathrm{d}}(u,q)}{\partial x},\quad q=\frac{\partial u}{\partial x}.
\]

\end_inset

先（仿照 Riemann 解）定义界面函数值
\begin_inset Formula 
\[
u_{j+1/2}^{\mathrm{I}}=\left\{ u^{\mathrm{D}}\right\} _{j+1/2}-\beta\left\llbracket u^{\mathrm{D}}\right\rrbracket _{j+1/2},\quad\beta=\pm0.5,
\]

\end_inset

其中
\begin_inset Formula 
\[
\left\{ u^{\mathrm{D}}\right\} _{j+1/2}\coloneqq\frac{1}{2}\left(u_{j}^{\mathrm{D}}(x_{j+1/2})+u_{j+1}^{\mathrm{D}}(x_{j+1/2})\right),\quad\left\llbracket u^{\mathrm{D}}\right\rrbracket _{j+1/2}\coloneqq u_{j+1}^{\mathrm{D}}(x_{j+1/2})-u_{j}^{\mathrm{D}}(x_{j+1/2}).
\]

\end_inset

再（仿照通量重构）定义（在界面处连续的）重构函数
\begin_inset Formula 
\[
u_{j}^{\mathrm{R}}(x,t)=\underbrace{\sum_{k=0}^{p}\hat{u}_{j,k}(t)\,L_{j,k}(x)}_{u_{j}^{\mathrm{D}}\in\mathbb{P}_{p}(E_{j})}+\underbrace{\sum_{\zeta=\pm1}\left(u_{j+\zeta/2}^{\mathrm{I}}-u_{j+\zeta/2}^{\mathrm{D}}\right)g_{\zeta}(\xi)}_{u_{j}^{\mathrm{C}}\in\mathbb{P}_{p+1}(E_{j})},
\]

\end_inset

以此导出（在界面处间断的）未知量导数
\begin_inset Formula 
\[
q_{j}^{\mathrm{D}}(x,t)=\sum_{k=0}^{p}\hat{u}_{j,k}(t)\frac{\partial L_{j,k}(x)}{\partial x}+\sum_{\zeta=\pm1}\left(u_{j+\zeta/2}^{\mathrm{I}}-u_{j+\zeta/2}^{\mathrm{D}}\right)\frac{\dv*{g_{\zeta}(\xi)}{\xi}}{\dv*{x_{j}}{\xi}},
\]

\end_inset

从而导出（在界面处间断的）域内通量
\begin_inset Formula 
\[
f_{j}^{\mathrm{D}}=f^{\mathrm{c}}\qty(u_{j}^{\mathrm{D}}(x,t))-f^{\mathrm{d}}\qty(u_{j}^{\mathrm{D}}(x,t),q_{j}^{\mathrm{D}}(x,t)),
\]

\end_inset

及界面通量
\begin_inset Formula 
\[
f_{j+1/2}^{\mathrm{I}}=f_{j+1/2}^{\mathrm{c,I}}-f_{j+1/2}^{\mathrm{d,I}},\quad\begin{cases}
f_{j+1/2}^{\mathrm{c,I}}=\text{exact/approximate Riemann solution},\\
f_{j+1/2}^{\mathrm{d,I}}=\left\{ f^{\mathrm{d,D}}\right\} _{j+1/2}+\beta\left\llbracket f^{\mathrm{d,D}}\right\rrbracket _{j+1/2}+\tau\left\llbracket u^{\mathrm{D}}\right\rrbracket _{j+1/2},
\end{cases}
\]

\end_inset

其中 
\begin_inset Formula $\tau=0,0.1,1$
\end_inset

 are tested in 
\begin_inset CommandInset citation
LatexCommand citet
key "Castonguay_2013"
literal "false"

\end_inset

。以此定义（在界面处连续的）重构通量
\begin_inset Formula 
\[
f_{j}^{\mathrm{R}}(x,t)=\underbrace{\sum_{k=0}^{p}\hat{f}_{j,k}(t)\,L_{j,k}(x)}_{f_{j}^{\mathrm{D}}\in\mathbb{P}_{p}(E_{j})}+\underbrace{\sum_{\zeta=\pm1}\left(f_{j+\zeta/2}^{\mathrm{I}}-f_{j+\zeta/2}^{\mathrm{D}}\right){\color{red}h_{\zeta}}(\xi)}_{f_{j}^{\mathrm{C}}\in\mathbb{P}_{p+1}(E_{j})},
\]

\end_inset

其中 
\begin_inset Formula $h_{\zeta}$
\end_inset

 可以不同于 
\begin_inset Formula $g_{\zeta}$
\end_inset

。以此导出（在界面处间断的）通量导数
\begin_inset Formula 
\[
\frac{\partial f_{j}^{\mathrm{R}}(x,t)}{\partial x}=\sum_{k=0}^{p}\hat{f}_{j,k}(t)\frac{\partial L_{j,k}(x)}{\partial x}+\sum_{\zeta=\pm1}\left(f_{j+\zeta/2}^{\mathrm{I}}-f_{j+\zeta/2}^{\mathrm{D}}\right)\frac{\dv*{{\color{red}h_{\zeta}}(\xi)}{\xi}}{\dv*{x}{\xi}},
\]

\end_inset

在结点出对该式取值，即得 FR 格式。
\end_layout

\begin_layout Subsection
CDG (Compact DG)
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Peraire_2008"
literal "true"

\end_inset


\end_layout

\begin_layout Standard
...
 to overcome the issue that LDG method is not compact when applied to multidimen
sional problems.
\end_layout

\begin_layout Subsection
RDG (Recovery-based DG)
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "van_Leer_2005,van_Leer_2007"
literal "true"

\end_inset


\end_layout

\begin_layout Standard
...
 recovers a smooth continuous solution that in the weak sense is indistinguishab
le from the discontinuous discrete solution.
\end_layout

\begin_layout Subsection
rDG (Reconstructed DG)
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Luo_2010"
literal "true"

\end_inset


\end_layout

\begin_layout Standard
...
 a smooth continuous solution is reconstructed at each cell interface from
 the discontinuous discrete solution and the diffusive fluxes are then obtained
 based on the smooth reconstructed solution.
\end_layout

\begin_layout Subsection
DDG (Direct DG)
\end_layout

\begin_layout Quote
From the PDE point of view, jumps of all even order derivatives as well
 as the average of odd order derivatives all contribute to the trace of
 the solution derivative.
 ...
 The form of the numerical flux is motivated by an exact trace formulation
 derived from solving the heat equation with smooth initial data having
 only one discontinuous point.
 —— 
\begin_inset CommandInset citation
LatexCommand citet
key "Liu_2009_DDG"
literal "true"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Liu_2009_DDG"
literal "true"

\end_inset

 提出并用于求解扩散问题，
\begin_inset CommandInset citation
LatexCommand citet
key "Cheng_2016,Yang_2019"
literal "true"

\end_inset

 推广到求解 Navier–Stokes 方程。
\end_layout

\begin_layout Subsubsection
一维标量形式
\end_layout

\begin_layout Standard
考虑一维扩散问题
\begin_inset Formula 
\[
\frac{\partial u}{\partial t}=\frac{\partial}{\partial x}\left(a(u)\frac{\partial u}{\partial x}\right),\quad a(u)>0,
\]

\end_inset

定义扩散通量
\begin_inset Formula 
\[
f^{\mathrm{d}}=\frac{\partial b(u)}{\partial x}=a(u)\frac{\partial u}{\partial x}\impliedby b(u)\coloneqq\int^{u}a(s)\dd{s},
\]

\end_inset

则数值通量一般形式为
\begin_inset Formula 
\[
\widehat{f}_{j+1/2}^{\mathrm{d}}=\beta_{0}\,h_{j+1/2}^{-1}\left\llbracket b(u^{h})\right\rrbracket _{j+1/2}+\left\{ \frac{\partial b(u^{h})}{\partial x}\right\} _{j+1/2}+\sum_{m=2}^{\left\lfloor k/2\right\rfloor }\beta_{m}\,h_{j+1/2}^{2m-1}\left\llbracket \frac{\partial^{2m}b(u^{h})}{\partial x^{2m}}\right\rrbracket _{j+1/2},
\]

\end_inset

其中 
\begin_inset Formula $k$
\end_inset

 为界面两侧多项式次数的较大者，
\begin_inset Formula 
\[
\left\llbracket X\right\rrbracket _{j+1/2}=X_{j+1/2}^{+}-X_{j+1/2}^{-},\quad\left\{ X\right\} _{j+1/2}=\frac{1}{2}\left(X_{j+1/2}^{+}+X_{j+1/2}^{-}\right),\quad h_{j+1/2}=x_{j+1}-x_{j},
\]

\end_inset

直接代入 DG 弱形式
\begin_inset Formula 
\[
\begin{aligned}\mathcal{DG}(u^{h},v^{h}) & =\ip{v^{h}}{\partial_{t}\,u^{h}}_{E_{j}}+\ip{\partial_{x}\,v^{h}}{f^{\mathrm{d}}}_{E_{j}}-\ip{v^{h}}{n_{x}\,f^{\mathrm{d}}}_{\partial E_{j}}\\
 & =\int_{x_{j-1/2}}^{x_{j+1/2}}\left(v^{h}\frac{\partial u^{h}}{\partial t}+\frac{\partial v^{h}}{\partial x}f^{\mathrm{d}}(u^{h})\right)\dd{x}+\eval{\left(v^{h}\,\hat{f}^{\mathrm{d}}\right)}_{x_{j-1/2}}^{x_{j+1/2}}=0,
\end{aligned}
\]

\end_inset

即得半离散格式。
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Liu_2009_DDG"
literal "true"

\end_inset

 数值试验表明：取
\begin_inset Formula 
\[
\beta_{0}=1,\quad\beta_{1}=\frac{1}{12},\quad\beta_{m\ge2}=0,
\]

\end_inset

可在 
\begin_inset Formula $k\le3$
\end_inset

 时得 
\begin_inset Formula $k+1$
\end_inset

 阶最优精度。为在 
\begin_inset Formula $k>3$
\end_inset

 时得最优精度，需引入 
\begin_inset Formula $\beta_{m\ge2}$
\end_inset

，但没有明确的准则。
\end_layout

\begin_layout Subsubsection
界面修正项
\end_layout

\begin_layout Standard
为在 
\begin_inset Formula $k>3$
\end_inset

 时只取 
\begin_inset Formula $(\beta_{0},\beta_{1})$
\end_inset

 仍有最优精度，
\begin_inset CommandInset citation
LatexCommand cite
key "Liu_2010_DDG"
literal "false"

\end_inset

 在 DDG 弱形式中引入界面修正项：
\begin_inset Formula 
\[
\mathcal{DDG}(u^{h},v^{h})+\left(\frac{\left\llbracket b(u^{h})\right\rrbracket }{2}\frac{\partial v^{h}}{\partial x}\right)_{j+1/2}+\left(\frac{\left\llbracket b(u^{h})\right\rrbracket }{2}\frac{\partial v^{h}}{\partial x}\right)_{j-1/2}=0,
\]

\end_inset

或更一般的高维版本
\begin_inset Formula 
\[
\mathcal{DDG}(u^{h},v^{h})+\ip{\frac{\left\llbracket b(u^{h})\right\rrbracket }{2}}{\frac{\partial v^{h}}{\partial n}}_{\partial E}=0,
\]

\end_inset

其中 
\begin_inset Formula $\left\llbracket X\right\rrbracket _{\partial E}$
\end_inset

 表示外侧值减内侧值，
\begin_inset Formula $\pdv*{Y}{n}$
\end_inset

 表示沿外法向求导，因此在 
\begin_inset Formula $x_{j\pm1/2}$
\end_inset

 处分别有
\begin_inset Formula 
\[
\eval{\left\llbracket X\right\rrbracket _{\partial E}}_{j-1/2}=-\left\llbracket X\right\rrbracket _{j-1/2},\quad\eval{\frac{\partial Y}{\partial n}}_{j-1/2}=-\eval{\frac{\partial Y}{\partial x}}_{j-1/2},
\]

\end_inset


\begin_inset Formula 
\[
\eval{\left\llbracket X\right\rrbracket _{\partial E}}_{j+1/2}=+\left\llbracket X\right\rrbracket _{j+1/2},\quad\eval{\frac{\partial Y}{\partial n}}_{j+1/2}=+\eval{\frac{\partial Y}{\partial x}}_{j+1/2}.
\]

\end_inset


\end_layout

\begin_layout Standard
为得到上述修正项对半离散格式的影响，将 test function 的展开式 
\begin_inset Formula $v^{h}(\vec{x})=\sum_{k}\hat{v}_{k}\,\phi_{k}(\vec{x})$
\end_inset

 代入修正后的弱形式，得
\begin_inset Formula 
\[
\mathcal{DDG}(u^{h},v^{h})+\ip{\frac{\left\llbracket b(u^{h})\right\rrbracket }{2}}{\frac{\partial\sum_{k}\hat{v}_{k}\phi_{k}}{\partial n}}_{\partial E}=\mathcal{DDG}(u^{h},v^{h})+\sum_{k}\hat{v}_{k}\ip{\frac{\left\llbracket b(u^{h})\right\rrbracket }{2}}{\frac{\partial\phi_{k}}{\partial n}}_{\partial E}=0,
\]

\end_inset

故半离散格式被修正为
\begin_inset Formula 
\[
\underline{m}\frac{\dd}{\dd t}\underline{\hat{u}}=\underline{r}(\underline{\hat{u}})-\frac{1}{2}\begin{bmatrix}\ip{\left\llbracket b(u^{h})\right\rrbracket }{\partial_{n}\,\phi_{1}}_{\partial E}\\
\vdots\\
\ip{\left\llbracket b(u^{h})\right\rrbracket }{\partial_{n}\,\phi_{N}}_{\partial E}
\end{bmatrix},
\]

\end_inset

其中 
\begin_inset Formula $\underline{r}$
\end_inset

 为未做修正的 DDG 残值项。
\end_layout

\begin_layout Standard
数值实验表明，若取 
\begin_inset Formula $\beta_{0}=2,\beta_{1}=\frac{1}{12}$
\end_inset

，则对 
\begin_inset Formula $k\le9$
\end_inset

 均有最优精度。
\end_layout

\begin_layout Subsubsection
高维方程组
\end_layout

\begin_layout Standard
以 
\begin_inset Formula $k=2,3$
\end_inset

 为例，构造 
\begin_inset Formula $\underline{\partial}\,\underline{u}\equiv\underline{\partial}\otimes\underline{u}$
\end_inset

 在界面处的近似值：
\begin_inset Formula 
\begin{equation}
\boxed{\left(\underline{\partial}\otimes\underline{u}\right)_{\partial E}\approx\left(\underline{\partial}\,\underline{u}\right)^{h}\coloneqq\beta_{0}\,\Delta^{-1}\left\llbracket \underline{n}\otimes\underline{u^{h}}\right\rrbracket +\left\{ \underline{\partial}\otimes\underline{u^{h}}\right\} +\beta_{1}\,\Delta\left\llbracket \underline{n}\cdot\underline{\partial}\otimes\underline{\partial}\otimes\underline{u^{h}}\right\rrbracket },\label{eq:DDG-grad-at-interface}
\end{equation}

\end_inset

其中
\begin_inset Formula 
\[
\underline{\partial}\otimes\underline{u}\equiv\underline{\partial}\,\underline{u}=\begin{bmatrix}\partial_{x}\,\underline{u}\\
\partial_{y}\,\underline{u}
\end{bmatrix},\quad\underline{n}\otimes\underline{u^{h}}=\begin{bmatrix}n_{x}\,\underline{u^{h}}\\
n_{y}\,\underline{u^{h}}
\end{bmatrix},\quad\underline{\partial}\otimes\underline{\partial}\otimes\underline{u^{h}}=\begin{bmatrix}\partial_{x}\partial_{x}\,\underline{u^{h}} & \partial_{x}\partial_{y}\,\underline{u^{h}}\\
\partial_{y}\partial_{x}\,\underline{u^{h}} & \partial_{y}\partial_{y}\,\underline{u^{h}}
\end{bmatrix},
\]

\end_inset

故 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DDG-grad-at-interface"

\end_inset

 式的展开形式为
\begin_inset Formula 
\[
\begin{aligned}\left(\partial_{x}\,\underline{u}\right)^{h} & =\beta_{0}\,\Delta^{-1}\left\llbracket n_{x}\,\underline{u^{h}}\right\rrbracket +\left\{ \partial_{x}\,\underline{u^{h}}\right\} +\beta_{1}\,\Delta\left(n_{x}\left\llbracket \partial_{x}\partial_{x}\,\underline{u^{h}}\right\rrbracket +n_{y}\left\llbracket \partial_{x}\partial_{y}\,\underline{u^{h}}\right\rrbracket \right),\\
\left(\partial_{y}\,\underline{u}\right)^{h} & =\beta_{0}\,\Delta^{-1}\left\llbracket n_{y}\,\underline{u^{h}}\right\rrbracket +\left\{ \partial_{y}\,\underline{u^{h}}\right\} +\beta_{1}\,\Delta\left(n_{y}\left\llbracket \partial_{y}\partial_{x}\,\underline{u^{h}}\right\rrbracket +n_{y}\left\llbracket \partial_{y}\partial_{y}\,\underline{u^{h}}\right\rrbracket \right).
\end{aligned}
\]

\end_inset


\begin_inset CommandInset citation
LatexCommand citet
key "Cheng_2016"
literal "true"

\end_inset

 测试过
\begin_inset Formula 
\[
\Delta=d(\vec{c}_{i},\vec{c}_{j}),\quad\Delta=\vert(\vec{c}_{i}-\vec{c_{j}})\vdot\vec{n}_{ij}\vert,\quad\Delta=\frac{\vert E_{i}\vert+\vert E_{j}\vert}{2\vert(\partial E)_{ij}\vert},
\]

\end_inset

其中第二种效果最好，且等价于 
\begin_inset CommandInset citation
LatexCommand citet
key "Yang_2019"
literal "true"

\end_inset

 采用的
\begin_inset Formula 
\[
\Delta=d(\vec{c}_{i},(\partial E)_{ij})+d(\vec{c}_{j},(\partial E)_{ij})
\]

\end_inset


\end_layout

\begin_layout Standard
在物理边界处，由于缺少邻接单元，无法直接套用 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:DDG-grad-at-interface"

\end_inset

 式。
\begin_inset CommandInset citation
LatexCommand citet
key "Cheng_2016"
literal "true"

\end_inset

 令边界处的二阶导数阶跃值为零，即取
\begin_inset Formula 
\[
\left(\partial_{n}\,\underline{u}\right)^{h}=\beta_{0}\,\Delta^{-1}\left\llbracket \underline{u^{h}}\right\rrbracket +\partial_{n}\left.\underline{u^{h}}\right|_{-},
\]

\end_inset

其中
\begin_inset Formula 
\[
\Delta=d(\vec{c}_{i},\partial\Omega)\times\begin{cases}
2, & \text{ghost cell}\\
1, & \text{prescribed}
\end{cases}
\]

\end_inset


\end_layout

\begin_layout Subsubsection
DDG for FR
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left(\frac{\partial u}{\partial x}\right)_{j+1/2}^{\mathrm{I}}\coloneqq\beta_{0}\left\llbracket \frac{u^{\mathrm{D}}}{h}\right\rrbracket _{j+1/2}+\left\{ \frac{\partial u^{\mathrm{D}}}{\partial x}\right\} _{j+1/2}+\beta_{1}\left\llbracket h\frac{\partial^{2}u^{\mathrm{D}}}{\partial x^{2}}\right\rrbracket _{j+1/2},\quad\begin{cases}
\beta_{0}\in[2,4],\\
\beta_{1}=1/12,
\end{cases}
\]

\end_inset


\end_layout

\begin_layout Standard
Accuracy order?
\end_layout

\begin_layout Standard
Energy stable?
\end_layout

\begin_layout Section
显式时间推进
\end_layout

\begin_layout Subsection
时间步长
\end_layout

\begin_layout Standard
对于
\begin_inset Formula 
\[
\frac{\partial u}{\partial t}+a(u)\frac{\partial u}{\partial x}=\frac{\partial}{\partial x}\left(\nu(u)\frac{\partial u}{\partial x}\right),
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand cite
key "Blazek_2015"
literal "true"

\end_inset

 Eq.
 (6.20) 取
\begin_inset Formula 
\[
\Delta t=\min_{j}\left(\frac{\sigma h}{\lambda_{\text{conv}}+C\,\lambda_{\text{diff}}}\right)_{E_{j}},\quad\lambda_{\text{conv}}=\norm{a}_{\infty},\quad\lambda_{\text{diff}}=\frac{\norm{\nu}_{\infty}}{h},
\]

\end_inset

其中 
\begin_inset Formula $C$
\end_inset

 根据空间离散选取：中心格式取 
\begin_inset Formula $C=4$
\end_inset

，一阶迎风取 
\begin_inset Formula $C=2$
\end_inset

，二阶迎风取 
\begin_inset Formula $C=1$
\end_inset

。
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand cite
key "Kl_ckner_2011"
literal "true"

\end_inset

 Eq.
 (2.1) 取
\begin_inset Formula 
\[
\Delta t=\min_{j}\left(\norm{a}_{\infty}\frac{p^{2}}{h}+\norm{\nu}_{\infty}\frac{p^{4}}{h^{2}}\right)_{E_{j}}^{-1},
\]

\end_inset

相当于在前一方案中取
\begin_inset Formula 
\[
\sigma=\frac{1}{p^{2}},\quad C=p^{2},
\]

\end_inset


\end_layout

\begin_layout Subsection
CFL
\end_layout

\begin_layout Quote
For DG discretizations using polynomials of degree 
\begin_inset Formula $k$
\end_inset

 and a 
\begin_inset Formula $k+1$
\end_inset

 stage RK method of order 
\begin_inset Formula $k+1$
\end_inset

 (which give rise to an 
\begin_inset Formula $(k+1)$
\end_inset

th order accurate method), we can take in practice
\begin_inset Formula 
\[
\text{CFL}=\frac{1}{2k+1},
\]

\end_inset

For 
\begin_inset Formula $k>2$
\end_inset

, the numbers are less than 
\begin_inset Formula $5\%$
\end_inset

 smaller than numerically-obtained estimates.
 —— 
\begin_inset CommandInset citation
LatexCommand citet
key "Cockburn_2001"
literal "true"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
下表为实测值，时间格式均为 SSP RK3，计算区间 
\begin_inset Formula $t\in[0,10]$
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $p$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset citation
LatexCommand citet
key "Cockburn_2001"
literal "true"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
FR (
\begin_inset Formula $g\perp\mathbb{P}_{N-2}$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
FR (
\begin_inset Formula $g\perp\mathbb{P}_{N-3}$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DG with FR
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.256$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.362$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.409$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.413$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.17$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.209$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.229$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.46$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.41$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.130$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.132$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.26$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.23$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.089$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.097$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.17$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.13$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.066$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.068$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.12$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.09$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.051$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.055$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.09$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.09$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.040$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.042$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.07$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.06$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.033$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.035$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.06$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.05$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
The DG-with-FR in the last column uses an insufficient quadrature.
\end_layout

\begin_layout Section
隐式时间推进
\end_layout

\begin_layout Subsection
隐式 Euler
\end_layout

\begin_layout Standard
第 
\begin_inset Formula $i$
\end_inset

 号单元
\begin_inset Formula 
\[
\underline{m}_{i}\,\dv{\underline{\hat{u}}_{i}}{t}=\underline{r}_{i},
\]

\end_inset

组装后得到
\begin_inset Formula 
\[
\underline{m}\,\dv{\underline{\hat{u}}}{t}=\underline{r},
\]

\end_inset

其中
\begin_inset Formula 
\[
\underline{m}\coloneqq\begin{bmatrix}\ddots\\
 & \underline{m}_{i}\\
 &  & \ddots\\
 &  &  & \underline{m}_{j}\\
 &  &  &  & \ddots
\end{bmatrix},\quad\underline{\hat{u}}\coloneqq\begin{bmatrix}\vdots\\
\underline{\hat{u}}_{i}\\
\vdots\\
\underline{\hat{u}}_{j}\\
\vdots
\end{bmatrix},\quad\underline{r}\coloneqq\begin{bmatrix}\vdots\\
\underline{r}_{i}\\
\vdots\\
\underline{r}_{j}\\
\vdots
\end{bmatrix}.
\]

\end_inset

对其应用隐式 Euler
\begin_inset Formula 
\[
\underline{m}\,\frac{\ket{\Delta\hat{u}}}{\Delta t}=\underline{r}^{n+1},\quad\begin{cases}
\Delta t\coloneqq t_{n+1}-t_{n},\\
\ket{\Delta\hat{u}}\coloneqq\underline{\hat{u}}(t_{n+1})-\underline{\hat{u}}(t_{n}),
\end{cases}
\]

\end_inset

并引入线性近似
\begin_inset Formula 
\[
\underline{r}^{n+1}\approx\underline{r}^{n}+\left(\frac{\partial\underline{r}}{\partial\underline{\hat{u}}}\right)^{n}\ket{\Delta\hat{u}},\quad\mel{i}{\frac{\partial\underline{r}}{\partial\underline{\hat{u}}}}{j}\coloneqq\frac{\partial\underline{r}_{i}}{\partial\underline{\hat{u}}_{j}},
\]

\end_inset

则转化为求解
\begin_inset Formula 
\[
\underline{A}^{n}\ket{\Delta\hat{u}}=\underline{r}^{n},\quad\underline{A}^{n}\coloneqq\frac{\underline{m}}{\Delta t}-\left(\frac{\partial\underline{r}}{\partial\underline{\hat{u}}}\right)^{n},
\]

\end_inset

当 
\begin_inset Formula $\Delta t\to\infty$
\end_inset

 时，退化为 Newton 法解非线性代数方程组
\begin_inset Formula 
\[
\underline{r}\qty(\underline{\hat{u}}(t_{n})+\ket{\Delta\hat{u}})=\underline{0},
\]

\end_inset

具有二阶收敛率。
\end_layout

\begin_layout Subsection
矩阵列化
\end_layout

\begin_layout Standard
考虑 
\begin_inset Formula $\underline{X}\in\mathbb{R}^{k\times l}$
\end_inset

 及 
\begin_inset Formula $\underline{Y}\colon\underline{X}\mapsto\underline{Y}(\underline{X})\in\mathbb{R}^{m\times n}$
\end_inset

，则在形式上有微分关系
\begin_inset Formula 
\[
\dd\underline{Y}=\frac{\partial\underline{Y}}{\partial\underline{X}}\,\dd\underline{X}
\]

\end_inset

但无法用常规矩阵运算无法表达。实际上，这是一组张量关系
\begin_inset Formula 
\[
\dd\langle r\vert\underline{Y}\vert s\rangle=\sum_{i=1}^{k}\sum_{j=1}^{l}\frac{\partial\langle r\vert\underline{Y}\vert s\rangle}{\partial\langle i\vert\underline{X}\vert j\rangle}\,\dd\langle i\vert\underline{X}\vert j\rangle,
\]

\end_inset

需要给定 
\begin_inset Formula $mn\times kl$
\end_inset

 个参数才能将 
\begin_inset Formula $\partial\underline{Y}/\partial\underline{X}$
\end_inset

 确定下来。
\end_layout

\begin_layout Standard
借助“列化”运算（对于 column-major 存储，无额外开销）
\begin_inset Formula 
\[
\underline{X}^{\mathrm{C}}=\begin{bmatrix}\underline{X}\vert1\rangle\\
\vdots\\
\underline{X}\vert l\rangle
\end{bmatrix}_{kl\times1},\quad\underline{Y}^{\mathrm{C}}=\begin{bmatrix}\underline{Y}\vert1\rangle\\
\vdots\\
\underline{Y}\vert n\rangle
\end{bmatrix}_{mn\times1},
\]

\end_inset

则有 well defined 导数矩阵
\begin_inset Formula 
\[
\frac{\partial\underline{Y}^{\mathrm{C}}}{\partial\underline{X}^{\mathrm{C}}}=\begin{bmatrix}\dfrac{\partial\underline{Y}\vert1\rangle}{\partial\underline{X}\vert1\rangle} & \cdots & \dfrac{\partial\underline{Y}\vert1\rangle}{\partial\underline{X}\vert l\rangle}\\
\ddots & \ddots & \vdots\\
\dfrac{\partial\underline{Y}\vert n\rangle}{\partial\underline{X}\vert1\rangle} & \cdots & \dfrac{\partial\underline{Y}\vert n\rangle}{\partial\underline{X}\vert l\rangle}
\end{bmatrix}\in\mathbb{R}^{mn\times kl},\quad\underbrace{\dd\underline{Y}^{\mathrm{C}}}_{mn\times1}=\frac{\partial\underline{Y}^{\mathrm{C}}}{\partial\underline{X}^{\mathrm{C}}}\,\underbrace{\dd\underline{X}^{\mathrm{C}}}_{kl\times1},
\]

\end_inset

其中
\begin_inset Formula 
\[
\frac{\partial\underline{Y}\vert i\rangle}{\partial\underline{X}\vert j\rangle}=\begin{bmatrix}\dfrac{\partial\langle1\vert\underline{Y}\vert i\rangle}{\partial\langle1\vert\underline{X}\vert j\rangle} & \cdots & \dfrac{\partial\langle1\vert\underline{Y}\vert i\rangle}{\partial\langle k\vert\underline{X}\vert j\rangle}\\
\ddots & \ddots & \vdots\\
\dfrac{\partial\langle m\vert\underline{Y}\vert i\rangle}{\partial\langle1\vert\underline{X}\vert j\rangle} & \cdots & \dfrac{\partial\langle m\vert\underline{Y}\vert i\rangle}{\partial\langle k\vert\underline{X}\vert j\rangle}
\end{bmatrix}\in\mathbb{R}^{m\times k},\quad\begin{cases}
i=1,\dots,n,\\
j=1,\dots,l,
\end{cases}
\]

\end_inset


\end_layout

\begin_layout Standard
因此，各单元上的有限元方程
\begin_inset Formula 
\[
\frac{\dd}{\dd t}\left(\underline{\hat{u}}_{i}\right)_{N\times K}=\left(\underline{m}_{i}\right)_{N\times N}^{-1}\left(\underline{r}_{i}\right)_{N\times K},
\]

\end_inset

可以被 columnized 为
\begin_inset Formula 
\[
\dv{}{t}\ket{\hat{u}_{i}}=\underline{M}_{i}^{-1}\ket{r_{i}},
\]

\end_inset

其中
\begin_inset Formula 
\[
\underline{M}_{i}=\begin{bmatrix}\underline{m}_{i}\\
 & \ddots\\
 &  & \underline{m}_{i}
\end{bmatrix}_{NK\times NK},\quad\ket{\hat{u}_{i}}=\begin{bmatrix}\underline{\hat{u}}_{i}\vert1\rangle\\
\vdots\\
\underline{\hat{u}}_{i}\vert K\rangle
\end{bmatrix}_{NK\times1},\quad\ket{r_{i}}=\begin{bmatrix}\underline{r}_{i}\vert1\rangle\\
\vdots\\
\underline{r}_{i}\vert K\rangle
\end{bmatrix}_{NK\times1}.
\]

\end_inset

组装后得到
\begin_inset Formula 
\[
\underline{M}\,\dv{}{t}\ket{\hat{u}}=\ket{r},
\]

\end_inset

其中
\begin_inset Formula 
\[
\underline{M}\coloneqq\begin{bmatrix}\ddots\\
 & \underline{M}_{i}\\
 &  & \ddots\\
 &  &  & \underline{M}_{j}\\
 &  &  &  & \ddots
\end{bmatrix},\quad\ket{\hat{u}}\coloneqq\begin{bmatrix}\vdots\\
\ket{\hat{u}_{i}}\\
\vdots\\
\ket{\hat{u}_{j}}\\
\vdots
\end{bmatrix},\quad\ket{r}\coloneqq\begin{bmatrix}\vdots\\
\ket{r_{i}}\\
\vdots\\
\ket{r_{j}}\\
\vdots
\end{bmatrix}.
\]

\end_inset

按此记法，隐式 Euler 需求解的线性代数方程组为
\begin_inset Formula 
\[
\underline{A}^{n}\ket{\Delta\hat{u}}=\ket{r^{n}},\quad\underline{A}^{n}\coloneqq\frac{\underline{M}}{\Delta t}-\frac{\partial\ket{r^{n}}}{\partial\bra{\hat{u}^{n}}},\quad\mel{i}{\frac{\partial\ket{r^{n}}}{\partial\bra{\hat{u}^{n}}}}{j}\coloneqq\frac{\partial\ket{r_{i}^{n}}}{\partial\bra{\hat{u}_{j}^{n}}}.
\]

\end_inset


\end_layout

\begin_layout Standard
本节剩余部分将尽可能使用 columnized 矩阵。
\end_layout

\begin_layout Subsection
LU-SGS
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\underline{A}=\underline{L}+\underline{D}+\underline{U},
\]

\end_inset

其中 
\begin_inset Formula $\underline{L},\underline{D},\underline{U}$
\end_inset

 分别为严格下三角阵、块状对角阵、严格上三角阵。于是
\begin_inset Formula 
\[
\underline{A}\ket{\Delta\hat{u}}=\ket{r}
\]

\end_inset

可化为
\begin_inset Formula 
\[
(\underline{L}+\underline{D})\,\underline{D}^{-1}\,(\underline{D}+\underline{U})\ket{\Delta\hat{u}}=\ket{r}+(\underline{L}\,\underline{D}^{-1}\,\underline{U})\ket{\Delta\hat{u}}.
\]

\end_inset

忽略
\begin_inset CommandInset citation
LatexCommand cite
key "Sharov_1997"
literal "true"

\end_inset

最后一项，所得的方程
\begin_inset Formula 
\[
(\underline{L}+\underline{D})\,\underline{D}^{-1}\,(\underline{D}+\underline{U})\ket{\Delta\hat{u}}=\ket{r}
\]

\end_inset

可分两步求解（记 
\begin_inset Formula $\ket{\Delta\hat{u}^{*}}\coloneqq\underline{D}^{-1}\,(\underline{D}+\underline{U})\ket{\Delta\hat{u}}$
\end_inset

）：
\end_layout

\begin_layout Itemize
先逐行向下，解出 
\begin_inset Formula $\ket{\Delta\hat{u}^{*}}$
\end_inset

：
\begin_inset Formula 
\[
(\underline{L}+\underline{D})\ket{\Delta\hat{u}^{*}}=\ket{r}
\]

\end_inset


\end_layout

\begin_layout Itemize
再逐行向上，解出 
\begin_inset Formula $\ket{\Delta\hat{u}}$
\end_inset

：
\begin_inset Formula 
\[
(\underline{D}+\underline{U})\ket{\Delta\hat{u}}=\underline{D}\ket{\Delta\hat{u}^{*}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
该方法首先由 
\begin_inset CommandInset citation
LatexCommand cite
key "Yoon_1988"
literal "true"

\end_inset

 针对结构网格提出，后经 
\begin_inset CommandInset citation
LatexCommand cite
key "Sharov_1997"
literal "true"

\end_inset

 等推广到非结构网格。
\end_layout

\begin_layout Subsection
GMRES+LU-SGS
\end_layout

\begin_layout Standard
以 LU-SGS 中的系数矩阵
\begin_inset Formula 
\[
\underline{P}=(\underline{L}+\underline{D})\,\underline{D}^{-1}\,(\underline{D}+\underline{U})
\]

\end_inset

为 left preconditioner:
\begin_inset Formula 
\[
\underline{P}^{-1}\,\underline{A}\ket{\Delta\hat{u}}=\underline{P}^{-1}\ket{r},
\]

\end_inset

调用 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:GMRES"

\end_inset

 迭代法解
\begin_inset Formula 
\[
\underline{\tilde{A}}\ket{\Delta\hat{u}}=\ket{\tilde{r}},\quad\underline{\tilde{A}}\coloneqq\underline{P}^{-1}\,\underline{A},\quad\ket{\tilde{r}}\coloneqq\underline{P}^{-1}\ket{r}.
\]

\end_inset


\end_layout

\begin_layout Subsection
精确 Jacobian 矩阵
\end_layout

\begin_layout Standard
GMRES 迭代需频繁计算 
\begin_inset Formula $\underline{A}\ket{\Delta\hat{u}}$
\end_inset

，可近似为
\begin_inset Formula 
\[
\underline{A}\ket{\Delta\hat{u}}=\frac{\underline{M}}{\Delta t}\ket{\Delta\hat{u}}-\frac{\partial\ket{r}}{\partial\bra{\hat{u}}}\ket{\Delta\hat{u}}\approx\frac{\underline{M}}{\Delta t}\ket{\Delta\hat{u}}-\frac{\ket{r}_{\ket{\hat{u}}+\varepsilon\ket{\Delta\hat{u}}}-\ket{r}_{\ket{\hat{u}}}}{\varepsilon},
\]

\end_inset

但 
\begin_inset CommandInset citation
LatexCommand cite
key "Yang_2019"
literal "true"

\end_inset

 指出用精确 Jacobian 矩阵有若干优势。
\end_layout

\begin_layout Standard
对于第 
\begin_inset Formula $i$
\end_inset

 号单元 
\begin_inset Formula $E_{i}$
\end_inset

，实际需要计算的是 
\begin_inset Formula $\underline{A}$
\end_inset

 的第 
\begin_inset Formula $i$
\end_inset

 行（以块为元）与 
\begin_inset Formula $\ket{\Delta\hat{u}}$
\end_inset

 的乘积，而 
\begin_inset Formula $\langle i\vert\underline{A}$
\end_inset

 的非零元（块）只会出现在满足 
\begin_inset Formula $\partial E_{i}\cap\partial E_{j}\ne\varnothing$
\end_inset

 的第 
\begin_inset Formula $j$
\end_inset

 列，即
\begin_inset Formula 
\[
\partial E_{i}\cap\partial E_{j}\ne\varnothing\iff\underline{0}\ne\langle i\vert\underline{A}\vert j\rangle.
\]

\end_inset

具体的有
\begin_inset Formula 
\[
\langle i\vert\underline{A}\vert j\rangle=\begin{cases}
\langle i\vert\underline{L}\vert j\rangle=-\pdv*{\ket{r_{i}}}{\bra{\hat{u}_{j}}}, & i>j\\
\langle i\vert\underline{D}\vert j\rangle=-\pdv*{\ket{r_{i}}}{\bra{\hat{u}_{i}}}+\underline{M}_{i}/\Delta t, & i=j\\
\langle i\vert\underline{U}\vert j\rangle=-\pdv*{\ket{r_{i}}}{\bra{\hat{u}_{j}}}, & i<j
\end{cases}
\]

\end_inset

对于标量守恒律，由
\begin_inset Formula 
\[
\ket{r_{i}}=\int_{E_{i}}\ket{\partial_{s}\,b_{i}}f_{s}^{h}\qty(\ket{\hat{u}_{i}})-\int_{\partial E_{i}}\ket{b_{i}}f_{n}^{h}\qty(\ket{\hat{u}_{i}},\ket{\hat{u}_{j}}),
\]

\end_inset

可知
\begin_inset Formula 
\[
\pdv{\ket{r_{i}}}{\bra{\hat{u}_{i}}}=\int_{E_{i}}\ket{\partial_{s}\,b_{i}}\frac{\partial f_{s}^{h}}{\partial\bra{\hat{u}_{i}}}-\int_{\partial E_{i}}\ket{b_{i}}\frac{\partial f_{n}^{h}}{\partial\bra{\hat{u}_{i}}},
\]

\end_inset


\begin_inset Formula 
\[
\pdv{\ket{r_{i}}}{\bra{\hat{u}_{j}}}=-\int_{\partial E_{i}}\ket{b_{i}}\frac{\partial f_{n}^{h}}{\partial\bra{\hat{u}_{j}}},\quad i\ne j
\]

\end_inset

其中 
\begin_inset Formula $\partial f_{n}^{h}/\partial\bra{\hat{u}_{j}}$
\end_inset

 需根据具体的 Riemann 解推导，而 
\begin_inset Formula $\partial f_{s}^{h}/\partial\bra{\hat{u}_{i}}$
\end_inset

 只依赖于 
\begin_inset Formula $f_{s}^{h}$
\end_inset

 的取法。若 
\begin_inset Formula $f_{s}^{h}=f_{s}(u^{h})=f_{s}\qty(\ip{b_{i}}{\hat{u}_{i}})$
\end_inset

，则 
\begin_inset Formula $\partial f_{s}^{h}/\partial\bra{\hat{u}_{i}}$
\end_inset

 可化为
\begin_inset Formula 
\[
\frac{\partial f_{s}^{h}}{\partial\bra{\hat{u}_{i}}}=\frac{\partial f_{s}\circ u^{h}}{\partial\bra{\hat{u}_{i}}}=\frac{\partial f_{s}}{\partial u^{h}}\frac{\partial u^{h}}{\partial\bra{\hat{u}_{i}}}=\left(a_{s}\circ u^{h}\right)\bra{b_{i}},
\]

\end_inset

对于守恒律系统，该式形式上仍成立，但需注意各矩阵的维数：
\begin_inset Formula 
\[
\frac{\partial\ket{f_{s}^{h}}_{K}}{\partial\bra{\hat{u}_{i}}_{NK}}=\frac{\partial\ket{f_{s}}\circ\ket{u^{h}}}{\partial\bra{\hat{u}_{i}}}=\frac{\partial\ket{f_{s}}_{K}}{\partial\bra{u^{h}}_{K}}\frac{\partial\ket{u^{h}}_{K}}{\partial\bra{\hat{u}_{i}}_{NK}}=\left(\underline{a_{s}}\circ\ket{u^{h}}\right)_{K\times K}\begin{bmatrix}\bra{b_{i}}\\
 & \ddots\\
 &  & \bra{b_{i}}
\end{bmatrix}_{K\times NK},
\]

\end_inset

其中最后一个矩阵来源于
\begin_inset Formula 
\[
\ket{u^{h}}_{K}=\begin{bmatrix}\bra{b_{i}}\\
 & \ddots\\
 &  & \bra{b_{i}}
\end{bmatrix}_{K\times NK}\ket{\hat{u}_{i}}_{NK}.
\]

\end_inset


\end_layout

\begin_layout Subsection
免矩阵
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand cite
key "Sharov_1997"
literal "true"

\end_inset

 提出将 
\begin_inset Formula $\partial\underline{f}/\partial\underline{u}$
\end_inset

 与 
\begin_inset Formula $\Delta\underline{u}$
\end_inset

 的乘积近似为 
\begin_inset Formula $\Delta\underline{f}$
\end_inset

，即
\begin_inset Formula 
\[
\frac{\partial\underline{f}}{\partial\underline{u}}\,\Delta\underline{u}\approx\Delta\underline{f}\equiv\underline{f}(\underline{u}+\Delta\underline{u})-\underline{f}(\underline{u}),
\]

\end_inset

由此免除矩阵 
\begin_inset Formula $\partial\underline{f}/\partial\underline{u}$
\end_inset

 的计算，从而免除 
\begin_inset Formula $\underline{L},\underline{U}$
\end_inset

 的计算及存储。
\end_layout

\end_body
\end_document
