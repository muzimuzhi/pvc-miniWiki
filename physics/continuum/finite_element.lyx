#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties false
\origin unavailable
\textclass book
\begin_preamble
\usepackage{pvcstyle}
\end_preamble
\use_default_options true
\begin_modules
theorems-ams
theorems-ams-extended
theorems-chap
\end_modules
\maintain_unincluded_children true
\language chinese-simplified
\language_package default
\inputencoding utf8-plain
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts true
\font_sc true
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 12
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered true
\pdf_bookmarksopen true
\pdf_bookmarksopenlevel 1
\pdf_breaklinks true
\pdf_pdfborder true
\pdf_colorlinks true
\pdf_backref false
\pdf_pdfusetitle true
\pdf_pagemode FullScreen
\papersize a4paper
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 0.5cm
\topmargin 1.5cm
\rightmargin 0.5cm
\bottommargin 0.5cm
\secnumdepth 2
\tocdepth 2
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style cjk
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle fancy
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Chapter
有限单元法
\end_layout

\begin_layout Section
DG (Discontinuous Galerkin)
\begin_inset CommandInset label
LatexCommand label
name "sec:DG"

\end_inset


\end_layout

\begin_layout Subsection
For Conservation Laws
\end_layout

\begin_layout Subsubsection
弱形式
\end_layout

\begin_layout Standard
偏微分方程
\begin_inset Formula 
\begin{equation}
\partial_{t}\,u+\partial_{s}\,f_{s}=0,\quad(s=x,y,z)\label{eq:间断有限元：微分方程}
\end{equation}

\end_inset

等价于微分积分方程
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\ip{w}{\partial_{t}\,u+\partial_{s}\,f_{s}}_{\varOmega}=0,\quad\forall\varOmega,\forall w\colon\varOmega\to\mathbb{R}
\]

\end_inset

经过一次
\color red
分部积分 (integral by parts)
\color inherit
 并利用 
\color red
Gauss 散度定理
\color inherit
可得
\begin_inset Formula 
\begin{equation}
\ip{w}{\partial_{t}\,u}_{\varOmega}=\ip{\partial_{s}\,w}{f_{s}}_{\varOmega}-\ip{w}{n_{s}\,f_{s}}_{\partial\varOmega},\label{eq:间断有限元：积分方程}
\end{equation}

\end_inset

该式对 
\begin_inset Formula $f_{s}$
\end_inset

 的光滑性要求低于式 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:间断有限元：微分方程"

\end_inset

，因此被称作其
\color red
弱形式 (weak form)
\color inherit
。
\end_layout

\begin_layout Subsubsection
空间离散
\end_layout

\begin_layout Standard
取两组定义在 
\begin_inset Formula $\varOmega$
\end_inset

 上的充分光滑的函数 
\begin_inset Formula $\left\{ \phi_{k}\right\} _{k=1}^{K}$
\end_inset

 与 
\begin_inset Formula $\left\{ \psi_{l}\right\} _{l=1}^{L}$
\end_inset

 作为
\color red
基 (basis)
\color inherit
，则 
\begin_inset Formula $u$
\end_inset

 与 
\begin_inset Formula $w$
\end_inset

 可以分别近似为
\begin_inset Formula 
\[
u(\vec{x},t)\approx u^{h}(\vec{x},t)=\sum_{k=1}^{K}\hat{u}_{k}(t)\,\phi_{k}(\vec{x}),\quad w(\vec{x})\approx w^{h}(\vec{x})=\sum_{l=1}^{L}\hat{w}_{l}\,\psi_{l}(\vec{x})
\]

\end_inset

其中 
\begin_inset Formula $\left\{ \hat{u}_{k}\right\} _{k=1}^{K}$
\end_inset

 为未知量，
\begin_inset Formula $\left\{ \hat{w}_{l}\right\} _{l=1}^{L}$
\end_inset

 为任意常数。将 
\begin_inset Formula $u^{h}$
\end_inset

 与 
\begin_inset Formula $w^{h}$
\end_inset

 代入弱形式 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:间断有限元：积分方程"

\end_inset

 可得
\begin_inset Formula 
\[
\ip{w}{\partial_{t}\,u}_{\varOmega}\approx\ip{w^{h}}{\partial_{t}\,u^{h}}_{\varOmega}=\hat{w}_{l}\ip{\psi_{l}}{\phi_{k}}_{\varOmega}\dv{\hat{u}_{k}}{t}
\]

\end_inset


\begin_inset Formula 
\[
\ip{\partial_{s}\,w}{f_{s}}_{\varOmega}\approx\ip{\partial_{s}\,w^{h}}{f_{s}^{h}}_{\varOmega}=\hat{w}_{l}\ip{\partial_{s}\,\psi_{l}}{f_{s}^{h}}
\]

\end_inset


\begin_inset Formula 
\[
\ip{w}{n_{s}\,f_{s}}_{\partial\varOmega}\approx\ip{w^{h}}{f_{n}^{h}}=\hat{w}_{l}\ip{\psi_{l}}{f_{n}^{h}}_{\partial\varOmega}
\]

\end_inset

其中
\end_layout

\begin_layout Itemize
\begin_inset Formula $f_{s}^{h}$
\end_inset

 为通量分量 
\begin_inset Formula $f_{s}$
\end_inset

 在 
\begin_inset Formula $\varOmega$
\end_inset

 内部的近似值，通常取 
\begin_inset Formula $f_{s}^{h}=f_{s}(u^{h})$
\end_inset

。
\end_layout

\begin_layout Itemize
\begin_inset Formula $f_{n}^{h}$
\end_inset

 为边界 
\begin_inset Formula $\partial\varOmega$
\end_inset

 上的法向通量 
\begin_inset Formula $f_{n}\coloneqq n_{s}\,f_{s}$
\end_inset

 的近似值，通常取为某种精确或
\begin_inset CommandInset ref
LatexCommand nameref
reference "sec:有限体积：近似 Riemann 解"

\end_inset

。
\end_layout

\begin_layout Standard
由 
\begin_inset Formula $\left\{ \hat{w}_{l}\right\} _{l=1}^{L}$
\end_inset

 的任意性，可得 
\begin_inset Formula $L$
\end_inset

 个等式：
\begin_inset Formula 
\[
\ip{\psi_{l}}{\phi_{k}}_{\varOmega}\dv{\hat{u}_{k}}{t}=\ip{\partial_{s}\,\psi_{l}}{f_{s}^{h}}_{\varOmega}-\ip{\psi_{l}}{f_{n}^{h}}_{\partial\varOmega},\quad l=1,\dots,L,
\]

\end_inset

写成矩阵形式即
\begin_inset Formula 
\[
\underline{m}\dv{\underline{\hat{u}}}{t}=\underline{r}_{\varOmega}-\underline{r}_{\partial\varOmega},
\]

\end_inset

其中
\begin_inset Formula 
\[
\underline{m}\coloneqq\begin{bmatrix}\ip{\psi_{1}}{\phi_{1}}_{\varOmega} & \cdots & \ip{\psi_{1}}{\phi_{K}}_{\varOmega}\\
\vdots & \ddots & \vdots\\
\ip{\psi_{L}}{\phi_{1}}_{\varOmega} & \cdots & \ip{\psi_{L}}{\phi_{K}}_{\varOmega}
\end{bmatrix},\quad\underline{\hat{u}}\coloneqq\begin{bmatrix}\hat{u}_{1}\\
\vdots\\
\hat{u}_{K}
\end{bmatrix},
\]

\end_inset


\begin_inset Formula 
\[
\underline{r}_{\varOmega}\coloneqq\begin{bmatrix}\ip{\partial_{s}\,\psi_{1}}{f_{s}^{h}}_{\varOmega}\\
\vdots\\
\ip{\partial_{s}\,\psi_{L}}{f_{s}^{h}}_{\varOmega}
\end{bmatrix},\quad\underline{r}_{\partial\varOmega}\coloneqq\begin{bmatrix}\ip{\psi_{1}}{f_{n}^{h}}_{\partial\varOmega}\\
\vdots\\
\ip{\psi_{L}}{f_{n}^{h}}_{\partial\varOmega}
\end{bmatrix}.
\]

\end_inset

令 
\begin_inset Formula $\varOmega$
\end_inset

 取遍所有单元，即得最一般的
\color red
有限单元法 (Finite Element Methods, FEM)
\color inherit
 方程。
\end_layout

\begin_layout Standard
若 
\begin_inset Formula $K=L$
\end_inset

 且 
\begin_inset Formula $(\forall k)\,\phi_{k}=\psi_{k}\eqqcolon b_{k}$
\end_inset

，则称相应的 FEM 为 
\color red
Galerkin FEM
\color inherit
，否则称之为 
\color red
Petrov–Galerkin FEM
\color inherit
。作为 
\color red
Galerkin FEM
\color inherit
 的特例，
\color red
Discontinuous Galerkin (DG)
\color inherit
 FEM 令 
\begin_inset Formula $\eval{u^{h}}_{E}$
\end_inset

 与 
\begin_inset Formula $\eval{w^{h}}_{E}$
\end_inset

 取自（定义在单元 
\begin_inset Formula $E$
\end_inset

 上的）同一函数空间（并记 
\begin_inset Formula $N\coloneqq K=L$
\end_inset

），则上述矩阵方程变为
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "eq:间断有限元：矩阵方程"

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{\dd}{\dd t}\underline{\hat{u}}=\underline{m}^{-1}\,\underline{r}(\underline{\hat{u}})
\end{equation}

\end_inset

其中
\begin_inset Formula 
\[
\underline{m}\coloneqq\begin{bmatrix}\ip{b_{1}}{b_{1}}_{\varOmega} & \cdots & \ip{b_{1}}{b_{N}}_{\varOmega}\\
\vdots & \ddots & \vdots\\
\ip{b_{N}}{b_{1}}_{\varOmega} & \cdots & \ip{b_{N}}{b_{N}}_{\varOmega}
\end{bmatrix},\quad\underline{\hat{u}}\coloneqq\begin{bmatrix}\hat{u}_{1}\\
\vdots\\
\hat{u}_{N}
\end{bmatrix},
\]

\end_inset


\begin_inset Formula 
\[
\underline{r}(\underline{\hat{u}})\coloneqq\begin{bmatrix}\ip{\partial_{s}\,b_{1}}{f_{s}^{h}}_{\varOmega}\\
\vdots\\
\ip{\partial_{s}\,b_{N}}{f_{s}^{h}}_{\varOmega}
\end{bmatrix}-\begin{bmatrix}\ip{b_{1}}{f_{n}^{h}}_{\partial\varOmega}\\
\vdots\\
\ip{b_{N}}{f_{n}^{h}}_{\partial\varOmega}
\end{bmatrix}.
\]

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
基函数选取
\end_layout

\begin_layout Standard
若式 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:间断有限元：矩阵方程"

\end_inset

 中的 
\begin_inset Formula $\underline{m}$
\end_inset

 是
\color red
满阵 (full matrix)
\color inherit
，则每次求逆（或解线性方程组）都需要 
\begin_inset Formula $\order{N^{3}}$
\end_inset

 次浮点运算；即使缓存了 
\begin_inset Formula $\underline{m}^{-1}$
\end_inset

，每次计算矩阵乘积 
\begin_inset Formula $\underline{m}^{-1}\underline{r}$
\end_inset

 时仍需 
\begin_inset Formula $\order{N^{2}}$
\end_inset

 次浮点运算。适当选取基函数可以显著提升性能：
\end_layout

\begin_layout Itemize
若 
\begin_inset Formula $\underline{b}$
\end_inset

 选取为 
\begin_inset Formula $E$
\end_inset

 上的
\color red
正交基 (orthogonal basis)
\color inherit

\begin_inset Formula 
\[
\ip{b_{k}}{b_{l}}_{E}=\ip{b_{k}}{b_{k}}_{E}\delta_{kl},\quad\forall k,\forall l,
\]

\end_inset

则 
\begin_inset Formula $\underline{m}$
\end_inset

 退化为
\color red
对角阵 (diagonal matrix)
\color inherit
，每次求逆只需要 
\begin_inset Formula $\order{N}$
\end_inset

 次浮点运算。
\end_layout

\begin_layout Itemize
若进一步将 
\begin_inset Formula $\underline{b}$
\end_inset

 限制为
\color red
归一的 (normalized)
\color inherit
 正交基
\begin_inset Formula 
\[
\ip{b_{k}}{b_{l}}_{E}=\delta_{kl},\quad\forall k,\forall l,
\]

\end_inset

则 
\begin_inset Formula $\underline{m}$
\end_inset

 退化为
\color red
单位阵 (unit matrix)
\color inherit
，其求逆运算可以完全省去。
\end_layout

\begin_layout Standard
正交（归一）基底的构造过程详见《
\begin_inset CommandInset ref
LatexCommand nameref
reference "sec:orthogonal_functions"

\end_inset

》。
\end_layout

\begin_layout Standard
除上述正交归一基外，还可以取
\end_layout

\begin_layout Itemize
Lagrange 插值基函数，由此导出 nodal DG；
\end_layout

\begin_layout Itemize
Taylor 基函数，由此导出 modal DG；
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Subsubsection
空间分辨率
\end_layout

\begin_layout Standard
考虑无界问题
\begin_inset Formula 
\[
\frac{\partial u}{\partial t}+a\frac{\partial u}{\partial x}=0,\quad a>0;\quad u(x,0)=\exp(\ii kx).
\]

\end_inset

其精确解为
\begin_inset Formula 
\[
u(x,t)=\frac{\exp(\ii kx)}{\exp(\ii\omega t)},\quad\omega=ka.
\]

\end_inset


\end_layout

\begin_layout Standard
在弱形式
\begin_inset Formula 
\[
\left\langle \partial_{t}\,u^{h}\middle\vert w^{h}\right\rangle _{E_{j}}+\left\langle n_{x}\,f^{\mathrm{I}}\middle\vert w^{h}\right\rangle _{\partial E_{j}}=\left\langle f^{\mathrm{D}}\middle\vert\partial_{x}\,w^{h}\right\rangle _{E_{j}},
\]

\end_inset

中，取迎风通量
\begin_inset Formula 
\[
n_{x}\,f^{\mathrm{I}}=\begin{cases}
au_{j}^{h}(x_{j+1/2},t), & x=x_{j+1/2}\\
-au_{j-1}^{h}(x_{j-1/2},t), & x=x_{j-1/2}
\end{cases}
\]

\end_inset

及域内通量
\begin_inset Formula 
\[
\left.f^{\mathrm{D}}\right\vert _{E_{j}}=f(u_{j}^{h}(x,t))=a\underline{\hat{u}}_{j}^{\mathrm{T}}\,\underline{b}_{j}=\underline{b}_{j}^{\mathrm{T}}\,a\underline{\hat{u}}_{j}
\]

\end_inset

则
\begin_inset Formula 
\[
\ip{\partial_{x}\,\underline{b}}{f^{\mathrm{D}}}_{E_{j}}=\ip{\partial_{x}\,\underline{b}}{\underline{b}^{\mathrm{T}}\,a\underline{\hat{u}}}_{E_{j}}=\ip{\partial_{x}\,\underline{b}}{\underline{b}^{\mathrm{T}}}_{E_{j}}a\underline{\hat{u}}_{j}(t),
\]

\end_inset


\begin_inset Formula 
\[
\left\langle \underline{b}\middle\vert n_{x}\,f^{\mathrm{I}}\right\rangle _{\partial E_{j}}=\underline{b}_{j}(x_{j+1/2})\,\underbrace{\underline{b}_{j}^{\mathrm{T}}(x_{j+1/2})\,a\underline{\hat{u}}_{j}(t)}_{au_{j}^{h}(x_{j+1/2},t)}-\underline{b}_{j}(x_{j-1/2})\,\underbrace{\underline{b}_{j-1}^{\mathrm{T}}(x_{j-1/2})\,a\underline{\hat{u}}_{j-1}(t)}_{au_{j-1}^{h}(x_{j-1/2},t)},
\]

\end_inset

因此可将半离散格式归结为
\begin_inset Formula 
\[
\underline{X}_{j}\frac{\dd}{\dd t}\underline{\hat{u}}_{j}+\underline{Y}_{j}\,\underline{\hat{u}}_{j}+\underline{Z}_{j}\,\underline{\hat{u}}_{j-1}=\underline{0},
\]

\end_inset

 不失一般性，基函数 
\begin_inset Formula $\underline{b}_{j}$
\end_inset

 可定义为相对坐标 
\begin_inset Formula $x'=x-x_{j-1/2}$
\end_inset

 的多项式，若网格均匀，则 
\begin_inset Formula $\underline{X}_{j},\underline{Y}_{j},\underline{Z}_{j}$
\end_inset

 与 
\begin_inset Formula $j$
\end_inset

 无关，从而可省略其下标。不失一般性，下面在均匀网格 
\begin_inset Formula $x_{j-1/2}=jh$
\end_inset

 上分析。
\end_layout

\begin_layout Standard
初始条件 
\begin_inset Formula $u(x,0)=\exp(\ii kx)$
\end_inset

 被各单元近似为
\begin_inset Formula 
\[
u_{j}^{h}(x,0)=\underline{b}_{j}^{\mathrm{T}}(x)\,\underline{\hat{u}}_{j}(0)=\sum_{l=1}^{N}b_{l}^{j}(x)\,\hat{u}_{l}^{j}(0),
\]

\end_inset

若 
\begin_inset Formula $\underline{b}_{j}$
\end_inset

 为归一化的正交基，则
\begin_inset Formula 
\[
\hat{u}_{l}^{j}(0)=\langle b_{l}^{j}\vert\exp(\ii kx)\rangle_{E_{j}}=\langle b_{l}^{j}\vert\exp(\ii kx')\rangle_{E_{j}}\exp(\ii kjh),
\]

\end_inset

右端的积分项与 
\begin_inset Formula $j$
\end_inset

 无关，可记为 
\begin_inset Formula $\hat{u}_{l}$
\end_inset

，因此 
\begin_inset Formula $\underline{\hat{u}}_{j}(0)$
\end_inset

 可以表示为不依赖于 
\begin_inset Formula $j$
\end_inset

 的 
\begin_inset Formula $\underline{\hat{u}}$
\end_inset

 与 
\begin_inset Formula $\exp(\ii kjh)$
\end_inset

 的乘积：
\begin_inset Formula 
\[
\underline{\hat{u}}_{j}(0)=\underline{\hat{u}}\exp(\ii kjh),\quad\underline{\hat{u}}\coloneqq\langle\underline{b}\vert\exp(\ii kx')\rangle_{E_{j}},
\]

\end_inset

若 
\begin_inset Formula $\underline{b}_{j}$
\end_inset

 为其他多项式基，则总可以表示为正交基的线性组合，故结论依然成立。
\end_layout

\begin_layout Standard
线性格式不产生新的谐波分量，据此 
\begin_inset CommandInset citation
LatexCommand citet
key "Hu_1999"
literal "false"

\end_inset

 设
\begin_inset Formula 
\[
\underline{\hat{u}}_{j}(t)=\frac{\underline{\tilde{u}}\exp(\ii kjh)}{\exp(\ii\omega t)},
\]

\end_inset

其中 
\begin_inset Formula $\underline{\tilde{u}}$
\end_inset

 为独立于 
\begin_inset Formula $j,t$
\end_inset

 的待定列阵，则
\begin_inset Formula 
\[
\underline{\hat{u}}_{j-1}(t)=\frac{\underline{\hat{u}}_{j}(t)}{\exp(\ii kh)},
\]

\end_inset

从而有
\begin_inset Formula 
\[
\left(-\ii\omega\underline{X}+\underline{Y}+\frac{\underline{Z}}{\exp(\ii kh)}\right)\underline{\tilde{u}}=\underline{0},
\]

\end_inset

它相当于特征值问题
\begin_inset Formula 
\[
\underline{M}\,\underline{\tilde{u}}=\omega\,\underline{\tilde{u}},\quad\underline{M}\coloneqq\left(\ii\underline{X}\right)^{-1}\left(\underline{Y}+\frac{\underline{Z}}{\exp(\ii kh)}\right),
\]

\end_inset

解之得 
\begin_inset Formula $N$
\end_inset

 个模态 
\begin_inset Formula $\left\{ \left(\omega_{l},\underline{\tilde{u}}_{l}\right)\right\} _{l=1}^{N}$
\end_inset

。实际解是这 
\begin_inset Formula $N$
\end_inset

 个模态的叠加：
\begin_inset Formula 
\[
\underline{\hat{u}}_{j}(t)=\sum_{l=1}^{N}\lambda_{l}\,\underline{\tilde{u}}_{l}\frac{\exp(\ii kjh)}{\exp(\ii\omega_{l}t)},
\]

\end_inset


\begin_inset CommandInset citation
LatexCommand citet
key "Hu_1999"
literal "false"

\end_inset

 定义：在一定波数范围内，满足 
\begin_inset Formula $\omega_{l}\approx ka$
\end_inset

 的那个模态为物理模态，其余为寄生模态。
\end_layout

\begin_layout Standard
定义无量纲波数 
\begin_inset Formula $K=kh$
\end_inset

 及无量纲频率 
\begin_inset Formula $\Omega=(\omega/a)h$
\end_inset

，则
\begin_inset Formula 
\[
\Omega=\Re(\Omega)+\ii\Im(\Omega)
\]

\end_inset

之实部表示色散，虚部表示耗散，精确解
\begin_inset Formula 
\[
\Omega=K\impliedby\omega=ka.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
方程组
\end_layout

\begin_layout Standard
微分方程 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:间断有限元：微分方程"

\end_inset

 与有限元方程 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:间断有限元：矩阵方程"

\end_inset

 都是针对标量守恒律而言的；对于含有 
\begin_inset Formula $K$
\end_inset

 个方程的守恒律组，只需将未知量 
\begin_inset Formula $u$
\end_inset

 替换为 
\begin_inset Formula $\underline{u}_{1\times K}\coloneqq\begin{bmatrix}u_{1} & \cdots & u_{K}\end{bmatrix}$
\end_inset

，将通量分量 
\begin_inset Formula $f_{s}$
\end_inset

 替换为 
\begin_inset Formula $\underline{f_{s}}_{1\times K}$
\end_inset

，就得到相应的微分方程组
\begin_inset Formula 
\[
\partial_{t}\underline{u}_{1\times K}+\partial_{s}\,\underline{f_{s}}_{1\times K}=\underline{0}_{1\times K},
\]

\end_inset

及对应的有限元方程
\begin_inset Formula 
\[
\frac{\dd}{\dd t}\underline{\hat{u}}_{N\times K}=\underline{m}_{N\times N}^{-1}\,\underline{r}_{N\times K},
\]

\end_inset

其中，基函数及质量阵保持不变：
\begin_inset Formula 
\[
\underline{b}_{N\times1}(\vec{x})\coloneqq\begin{bmatrix}b_{1}(\vec{x}) & \cdots & b_{N}(\vec{x})\end{bmatrix}^{\mathrm{T}},
\]

\end_inset


\begin_inset Formula 
\[
\underline{m}_{N\times N}\coloneqq\ip{\underline{b}_{N\times1}}{\left(\underline{b}^{\mathrm{T}}\right)_{1\times N}}_{E}=\begin{bmatrix}\ip{b_{1}}{b_{1}}_{E} & \cdots & \ip{b_{1}}{b_{N}}_{E}\\
\vdots & \ddots & \vdots\\
\ip{b_{N}}{b_{1}}_{E} & \cdots & \ip{b_{N}}{b_{N}}_{E}
\end{bmatrix},
\]

\end_inset

未知量系数变为
\begin_inset Formula 
\[
\underline{\hat{u}}_{N\times K}(t)\coloneqq\ip{\underline{b}_{N\times1}}{\underline{u}_{1\times K}}_{E}=\begin{bmatrix}\langle b_{1}\vert u_{1}\rangle_{E} & \cdots & \langle b_{1}\vert u_{K}\rangle_{E}\\
\vdots & \ddots & \vdots\\
\langle b_{N}\vert u_{1}\rangle_{E} & \cdots & \langle b_{N}\vert u_{K}\rangle_{E}
\end{bmatrix},
\]

\end_inset

残值项变为
\begin_inset Formula 
\[
\underline{r}_{N\times K}\coloneqq\ip{\partial_{s}\,\underline{b}}{\underline{f_{s}^{h}}}_{E}-\ip{\underline{b}}{\underline{f_{n}^{h}}}_{\partial E}.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
有源问题
\end_layout

\begin_layout Standard
若在守恒律方程组的右端添加源项：
\begin_inset Formula 
\[
\partial_{t}\,\underline{u}+\partial_{s}\,\underline{f_{s}}=\underline{q},
\]

\end_inset

则整个推导过程大致相同，只需在弱形式、残值项中补充源项。所得有限元方程（形式上）仍为
\begin_inset Formula 
\[
\frac{\dd}{\dd t}\underline{\hat{u}}_{N\times K}=\underline{m}_{N\times N}^{-1}\,\underline{r}_{N\times K},
\]

\end_inset

唯一的区别在于
\begin_inset Formula 
\[
\underline{r}_{K\times N}\coloneqq\ip{\partial_{s}\,\underline{b}}{\underline{f_{s}^{h}}}_{E}-\ip{\underline{b}}{\underline{f_{n}^{h}}}_{\partial E}{\color{red}+\ip{\underline{b}}{\underline{q^{h}}}_{E}}.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
时间推进
\end_layout

\begin_layout Standard
不失一般性，忽略常微分方程组 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:间断有限元：矩阵方程"

\end_inset

 中的 
\begin_inset Formula $\underline{m}$
\end_inset

，即
\begin_inset Formula 
\[
\frac{\dd}{\dd t}\underline{\hat{u}}=\underline{r}(\underline{\hat{u}}).
\]

\end_inset

它是一个标准的常微分方程组，因此可以照搬《
\begin_inset CommandInset ref
LatexCommand nameref
reference "chap:有限差分法"

\end_inset

》之《
\begin_inset CommandInset ref
LatexCommand nameref
reference "sec:有限差分：时间推进"

\end_inset

》一节的算法。
\end_layout

\begin_layout Paragraph
隐式 Euler
\end_layout

\begin_layout Standard
第 
\begin_inset Formula $i$
\end_inset

 号单元
\begin_inset Formula 
\[
\underline{m}_{i}\dv{\underline{\hat{u}}_{i}}{t}=\underline{r}_{i},
\]

\end_inset

组装后得到
\begin_inset Formula 
\[
\underline{m}\dv{\underline{\hat{u}}}{t}=\underline{r},
\]

\end_inset

其中
\begin_inset Formula 
\[
\underline{m}\coloneqq\begin{bmatrix}\ddots\\
 & \underline{m}_{i}\\
 &  & \ddots\\
 &  &  & \underline{m}_{j}\\
 &  &  &  & \ddots
\end{bmatrix},\quad\underline{\hat{u}}\coloneqq\begin{bmatrix}\vdots\\
\underline{\hat{u}}_{i}\\
\vdots\\
\underline{\hat{u}}_{j}\\
\vdots
\end{bmatrix},\quad\underline{r}\coloneqq\begin{bmatrix}\vdots\\
\underline{r}_{i}\\
\vdots\\
\underline{r}_{j}\\
\vdots
\end{bmatrix}.
\]

\end_inset

对其应用隐式 Euler
\begin_inset Formula 
\[
\underline{m}\frac{\Delta\underline{\hat{u}}}{\Delta t}=\underline{r}^{n+1},\quad\begin{cases}
\Delta t\coloneqq t_{n+1}-t_{n},\\
\Delta\underline{\hat{u}}\coloneqq\underline{\hat{u}}(t_{n+1})-\underline{\hat{u}}(t_{n}),
\end{cases}
\]

\end_inset

并引入线性近似
\begin_inset Formula 
\[
\underline{r}^{n+1}\approx\underline{r}^{n}+\left(\frac{\partial\underline{r}}{\partial\underline{\hat{u}}}\right)^{n}\Delta\underline{\hat{u}},\quad\left\langle i\middle\vert\frac{\partial\underline{r}}{\partial\underline{\hat{u}}}\middle\vert j\right\rangle \coloneqq\frac{\partial\underline{r}_{i}}{\partial\underline{\hat{u}}_{j}},
\]

\end_inset

则转化为求解
\begin_inset Formula 
\[
\underline{A}^{n}\,\Delta\underline{\hat{u}}=\underline{r}^{n},\quad\underline{A}^{n}\coloneqq\frac{\underline{m}}{\Delta t}-\left(\frac{\partial\underline{r}}{\partial\underline{\hat{u}}}\right)^{n},
\]

\end_inset

当 
\begin_inset Formula $\Delta t\to\infty$
\end_inset

 时，退化为 Newton 法解非线性代数方程组
\begin_inset Formula 
\[
\underline{r}\big(\underline{\hat{u}}(t_{n})+\Delta\underline{\hat{u}}\big)=\underline{0},
\]

\end_inset

具有二阶收敛率。
\end_layout

\begin_layout Paragraph
矩阵列化
\end_layout

\begin_layout Standard
考虑 
\begin_inset Formula $\underline{X}\in\mathbb{R}^{k\times l}$
\end_inset

 及 
\begin_inset Formula $\underline{Y}\colon\underline{X}\mapsto\underline{Y}(\underline{X})\in\mathbb{R}^{m\times n}$
\end_inset

，则在形式上有微分关系
\begin_inset Formula 
\[
\dd\underline{Y}=\frac{\partial\underline{Y}}{\partial\underline{X}}\,\dd\underline{X}
\]

\end_inset

但矩阵运算无法表达。实际上，这是一组张量关系
\begin_inset Formula 
\[
\dd\langle r\vert\underline{Y}\vert s\rangle=\frac{\partial\langle r\vert\underline{Y}\vert s\rangle}{\partial\langle i\vert\underline{X}\vert j\rangle}\,\dd\langle i\vert\underline{X}\vert j\rangle,
\]

\end_inset

需要给定 
\begin_inset Formula $mn\times kl$
\end_inset

 个参数才能表达。
\end_layout

\begin_layout Standard
借助“列化”运算
\begin_inset Formula 
\[
\underline{X}^{\mathrm{C}}=\begin{bmatrix}\underline{X}\vert1\rangle\\
\vdots\\
\underline{X}\vert l\rangle
\end{bmatrix}_{kl\times1},\quad\underline{Y}^{\mathrm{C}}=\begin{bmatrix}\underline{Y}\vert1\rangle\\
\vdots\\
\underline{Y}\vert n\rangle
\end{bmatrix}_{mn\times1},
\]

\end_inset

则有 well defined 导数矩阵
\begin_inset Formula 
\[
\frac{\partial\underline{Y}^{\mathrm{C}}}{\partial\underline{X}^{\mathrm{C}}}=\begin{bmatrix}\dfrac{\partial\underline{Y}\vert1\rangle}{\partial\underline{X}\vert1\rangle} & \cdots & \dfrac{\partial\underline{Y}\vert1\rangle}{\partial\underline{X}\vert l\rangle}\\
\ddots & \ddots & \vdots\\
\dfrac{\partial\underline{Y}\vert n\rangle}{\partial\underline{X}\vert1\rangle} & \cdots & \dfrac{\partial\underline{Y}\vert n\rangle}{\partial\underline{X}\vert l\rangle}
\end{bmatrix}\in\mathbb{R}^{mn\times kl},\quad\underbrace{\dd\underline{Y}^{\mathrm{C}}}_{mn\times1}=\frac{\partial\underline{Y}^{\mathrm{C}}}{\partial\underline{X}^{\mathrm{C}}}\,\underbrace{\dd\underline{X}^{\mathrm{C}}}_{kl\times1},
\]

\end_inset

其中
\begin_inset Formula 
\[
\frac{\partial\underline{Y}\vert i\rangle}{\partial\underline{X}\vert j\rangle}=\begin{bmatrix}\dfrac{\partial\langle1\vert\underline{Y}\vert i\rangle}{\partial\langle1\vert\underline{X}\vert j\rangle} & \cdots & \dfrac{\partial\langle1\vert\underline{Y}\vert i\rangle}{\partial\langle k\vert\underline{X}\vert j\rangle}\\
\ddots & \ddots & \vdots\\
\dfrac{\partial\langle m\vert\underline{Y}\vert i\rangle}{\partial\langle1\vert\underline{X}\vert j\rangle} & \cdots & \dfrac{\partial\langle m\vert\underline{Y}\vert i\rangle}{\partial\langle k\vert\underline{X}\vert j\rangle}
\end{bmatrix}\in\mathbb{R}^{m\times k},\quad j=1,\dots,l,\quad,i=1,\dots,n,
\]

\end_inset


\end_layout

\begin_layout Standard
因此，各单元上的
\begin_inset Formula 
\[
\underline{m}_{N\times N}\dv{}{t}\underline{\hat{u}}_{N\times K}=\underline{r}_{N\times K},
\]

\end_inset

可以被 columnized 为
\begin_inset Formula 
\[
\underline{M}\dv{}{t}\underline{\hat{u}}^{\mathrm{C}}=\underline{r}^{\mathrm{C}},
\]

\end_inset

其中
\begin_inset Formula 
\[
\underline{M}=\begin{bmatrix}\underline{m}\\
 & \ddots\\
 &  & \underline{m}
\end{bmatrix}_{NK\times NK},\quad\underline{\hat{u}}^{\mathrm{C}}=\begin{bmatrix}\underline{\hat{u}}\vert1\rangle\\
\vdots\\
\underline{\hat{u}}\vert K\rangle
\end{bmatrix}_{NK\times1},\quad\underline{r}^{\mathrm{C}}=\begin{bmatrix}\underline{r}\vert1\rangle\\
\vdots\\
\underline{r}\vert K\rangle
\end{bmatrix}_{NK\times1},
\]

\end_inset


\end_layout

\begin_layout Standard
本节剩余部分将假设各单元上的矩阵都是 columnized，并以 
\begin_inset Formula $\vert r\rangle,\vert\Delta\hat{u}\rangle$
\end_inset

 等符号强调之。
\end_layout

\begin_layout Paragraph
LU-SGS
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\underline{A}=\underline{L}+\underline{D}+\underline{U},
\]

\end_inset

其中 
\begin_inset Formula $\underline{L},\underline{D},\underline{U}$
\end_inset

 分别为严格下三角阵、对角阵、严格上三角阵。于是
\begin_inset Formula 
\[
\underline{A}\,\vert\Delta\hat{u}\rangle=\vert r\rangle
\]

\end_inset

可化为
\begin_inset Formula 
\[
(\underline{L}+\underline{D})\,\underline{D}^{-1}\,(\underline{D}+\underline{U})\,\vert\Delta\hat{u}\rangle=\vert r\rangle+(\underline{L}\,\underline{D}^{-1}\,\underline{U})\,\vert\Delta\hat{u}\rangle.
\]

\end_inset

忽略
\begin_inset CommandInset citation
LatexCommand cite
key "Sharov_1997"
literal "true"

\end_inset

最后一项，所得的方程
\begin_inset Formula 
\[
(\underline{L}+\underline{D})\,\underline{D}^{-1}\,(\underline{D}+\underline{U})\,\vert\Delta\hat{u}\rangle=\vert r\rangle
\]

\end_inset

可分两步求解（记 
\begin_inset Formula $\vert\Delta\hat{u}^{*}\rangle\coloneqq\underline{D}^{-1}\,(\underline{D}+\underline{U})\,\vert\Delta\hat{u}\rangle$
\end_inset

）：
\end_layout

\begin_layout Itemize
先逐行向下，解出 
\begin_inset Formula $\vert\Delta\hat{u}^{*}\rangle$
\end_inset

：
\begin_inset Formula 
\[
(\underline{L}+\underline{D})\,\vert\Delta\hat{u}^{*}\rangle=\vert r\rangle
\]

\end_inset


\end_layout

\begin_layout Itemize
再逐行向上，解出 
\begin_inset Formula $\vert\Delta\hat{u}\rangle$
\end_inset

：
\begin_inset Formula 
\[
(\underline{D}+\underline{U})\,\vert\Delta\hat{u}\rangle=\underline{D}\,\vert\Delta\hat{u}^{*}\rangle
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
该方法首先由 
\begin_inset CommandInset citation
LatexCommand cite
key "Yoon_1988"
literal "true"

\end_inset

 针对结构网格提出，后经 
\begin_inset CommandInset citation
LatexCommand cite
key "Sharov_1997"
literal "true"

\end_inset

 等推广到非结构网格。
\end_layout

\begin_layout Paragraph
GMRES+LU-SGS
\end_layout

\begin_layout Standard
以 LU-SGS 中的系数矩阵
\begin_inset Formula 
\[
\underline{P}=(\underline{L}+\underline{D})\,\underline{D}^{-1}\,(\underline{D}+\underline{U})
\]

\end_inset

为 left preconditioner:
\begin_inset Formula 
\[
\underline{P}^{-1}\,\underline{A}\,\vert\Delta\hat{u}\rangle=\underline{P}^{-1}\,\vert r\rangle,
\]

\end_inset

调用 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:GMRES"

\end_inset

 迭代法解
\begin_inset Formula 
\[
\underline{\tilde{A}}\,\vert\Delta\hat{u}\rangle=\vert\tilde{r}\rangle,\quad\underline{\tilde{A}}\coloneqq\underline{P}^{-1}\,\underline{A},\quad\vert\tilde{r}\rangle\coloneqq\underline{P}^{-1}\,\vert r\rangle.
\]

\end_inset


\end_layout

\begin_layout Paragraph
免矩阵
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand cite
key "Sharov_1997"
literal "true"

\end_inset

 提出将 
\begin_inset Formula $\partial\underline{f}/\partial\underline{u}$
\end_inset

 与 
\begin_inset Formula $\Delta\underline{u}$
\end_inset

 的乘积近似为 
\begin_inset Formula $\Delta\underline{f}$
\end_inset

，即
\begin_inset Formula 
\[
\frac{\partial\underline{f}}{\partial\underline{u}}\,\Delta\underline{u}\approx\Delta\underline{f}\equiv\underline{f}(\underline{u}+\Delta\underline{u})-\underline{f}(\underline{u}),
\]

\end_inset

由此免除矩阵 
\begin_inset Formula $\partial\underline{f}/\partial\underline{u}$
\end_inset

 的计算，从而免除 
\begin_inset Formula $\underline{L},\underline{U}$
\end_inset

 的计算及存储。
\end_layout

\begin_layout Subsection
LDG (Local DG)
\end_layout

\begin_layout Subsubsection
一维传热问题
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Cockburn_2001"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
一维传热方程
\begin_inset Formula 
\[
\partial_{t}u-\partial_{x}^{2}u=0,\quad(x,t)\in(0,2\pi)\times(0,T)
\]

\end_inset

及初始条件
\begin_inset Formula 
\[
u(x,0)=\sin(x),\quad x\in(0,2\pi)
\]

\end_inset


\end_layout

\begin_layout Paragraph
错误格式
\end_layout

\begin_layout Standard
将 
\begin_inset Formula $-\partial_{x}u$
\end_inset

 视为守恒律中的 
\begin_inset Formula $f(u)$
\end_inset

，在形式上应用 DG 方法：
\begin_inset Formula 
\[
\int_{I_{i}}\left(\partial_{t}u^{h}\right)v^{h}\dd{x}+\int_{I_{i}}\left(\partial_{x}u^{h}\right)\left(\partial_{x}v^{h}\right)\dd{x}=\left.\widehat{\partial_{x}u^{h}}\,v^{h}\right|_{x_{i-1/2}}^{x_{i+1/2}}
\]

\end_inset

其中 
\begin_inset Formula $u^{h},v^{h}$
\end_inset

 均取自 
\begin_inset Formula $\mathbb{P}^{k}(I_{i})$
\end_inset


\end_layout

\begin_layout Standard
边界项中的 
\begin_inset Formula $\widehat{\partial_{x}u^{h}}$
\end_inset

 为“数值通量”，因缺少迎风性质，自然地取平均值
\begin_inset Formula 
\[
\widehat{\partial_{x}u^{h}}=\frac{\left(\partial_{x}u^{h}\right)_{\mathrm{L}}+\left(\partial_{x}u^{h}\right)_{\mathrm{R}}}{2}
\]

\end_inset

时间离散用 TVD RK3 格式，所得结果表现出 inconsistency。
\end_layout

\begin_layout Paragraph
正确格式
\end_layout

\begin_layout Standard
引入新变量 
\begin_inset Formula $q\coloneqq\partial_{x}u$
\end_inset

，将方程 
\begin_inset Formula $\partial_{t}u-\partial_{x}^{2}u=0$
\end_inset

 化为一阶，二者合并组成一阶方程组
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{cases}
\partial_{t}u-\partial_{x}q=0,\\
q-\partial_{x}u=0,
\end{cases}
\]

\end_inset


\end_layout

\begin_layout Standard
在形式上应用 DG 方法：
\begin_inset Formula 
\[
\begin{cases}
\int_{I_{i}}\left(\partial_{t}u^{h}\right)v^{h}\dd{x}+\int_{I_{i}}q^{h}\left(\partial_{x}v^{h}\right)\dd{x}=\left.\widehat{q^{h}}\,v^{h}\right|_{x_{i-1/2}}^{x_{i+1/2}}\\
\int_{I_{i}}q^{h}\,w^{h}\dd{x}+\int_{I_{i}}u^{h}\left(\partial_{x}w^{h}\right)\dd{x}=\left.\widehat{u^{h}}\,w^{h}\right|_{x_{i-1/2}}^{x_{i+1/2}}
\end{cases}
\]

\end_inset

其中 
\begin_inset Formula $u^{h},v^{h},w^{h},q^{h}$
\end_inset

 均取自 
\begin_inset Formula $\mathbb{P}^{k}(I_{i})$
\end_inset


\end_layout

\begin_layout Standard
边界项中的 
\begin_inset Formula $\widehat{u^{h}}$
\end_inset

 及 
\begin_inset Formula $\widehat{q^{h}}$
\end_inset

 为“数值通量”，因缺少迎风性质，可以自然地取平均值
\begin_inset Formula 
\[
\widehat{u^{h}}=\frac{u_{\mathrm{L}}^{h}+u_{\mathrm{R}}^{h}}{2},\quad\widehat{q^{h}}=\frac{q_{\mathrm{L}}^{h}+q_{\mathrm{R}}^{h}}{2}
\]

\end_inset

或按 
\begin_inset CommandInset citation
LatexCommand citet
key "Cockburn_1998b"
literal "false"

\end_inset

 建议取
\begin_inset Formula 
\[
\widehat{u^{h}}=u_{\mathrm{L}}^{h},\quad\widehat{q^{h}}=q_{\mathrm{R}}^{h}
\]

\end_inset

 或
\begin_inset Formula 
\[
\widehat{u^{h}}=u_{\mathrm{R}}^{h},\quad\widehat{q^{h}}=q_{\mathrm{L}}^{h}
\]

\end_inset


\end_layout

\begin_layout Subsubsection
高维标量问题
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\partial_{t}u+\partial_{i}\left(f_{i}(u)-a_{ik}(u)\left(\partial_{k}u\right)\right)=0,\quad(t,\vec{r})\in(0,T)\times(0,1)^{d}
\]

\end_inset


\begin_inset Formula 
\[
u(t,\vec{r})=u_{0}(\vec{r}),\quad\vec{r}\in(0,1)^{d}
\]

\end_inset

其中 
\begin_inset Formula $a_{ik}(u)$
\end_inset

 对称、半正定，从而存在矩阵 
\begin_inset Formula $b_{ik}(u)$
\end_inset

 使得
\begin_inset Formula 
\[
a_{ik}(u)=b_{il}(u)\,b_{lk}(u)
\]

\end_inset


\end_layout

\begin_layout Standard
定义辅助变量
\begin_inset Formula 
\[
q_{l}(t,\vec{r})\coloneqq b_{lk}(u)\left(\partial_{k}u\right),\quad l=1,2,\dots,d
\]

\end_inset

则高阶方程化为一阶方程组
\begin_inset Formula 
\[
\begin{cases}
\partial_{t}u+\partial_{i}\left(f_{i}(u)-b_{il}(u)\,q_{l}\right)=0,\\
q_{l}-\partial_{k}g_{lk}(u)=0, & l=1,2,\dots,d
\end{cases}
\]

\end_inset

其中
\begin_inset Formula 
\[
g_{lk}(u)\coloneqq\int^{u}b_{lk}(s)\dd{s}
\]

\end_inset


\end_layout

\begin_layout Standard
在形式上应用 DG 方法：
\begin_inset Formula 
\[
\int_{E}\left(\partial_{t}u^{h}\right)v^{h}+\oint_{\partial E}\nu_{i}\left(f_{i}(u^{h})-b_{il}(u^{h})\,q_{l}^{h}\right)v^{h}=\int_{E}\left(\partial_{i}v^{h}\right)\left(f_{i}(u^{h})-b_{il}(u^{h})\,q_{l}^{h}\right),
\]

\end_inset


\begin_inset Formula 
\[
\int_{E}q_{l}^{h}\,w^{h}+\int_{E}\left(\partial_{k}w^{h}\right)\left(g_{lk}(u^{h})\right)=\oint_{\partial E}\nu_{k}\,g_{lk}(u^{h})\,w^{h},\quad l=1,2,\dots,d
\]

\end_inset

其中对流通量
\begin_inset Formula 
\[
\left(\nu_{i}\,f_{i}(u^{h})\right)_{\partial E}\approx f_{\nu}(u_{\mathrm{L}}^{h},u_{\mathrm{R}}^{h})
\]

\end_inset

由纯对流问题的 Riemann 解给出；而扩散通量取作
\begin_inset Formula 
\[
\left(\nu_{i}\,b_{il}(u^{h})\,q_{l}^{h}\right)_{\partial E}\approx\frac{\left\llbracket \nu_{k}\,g_{lk}(u^{h})\right\rrbracket }{\left\llbracket u^{h}\right\rrbracket }\left\{ q_{l}^{h}\right\} +C_{11}\left\llbracket u^{h}\right\rrbracket +C_{1l}\left\{ q_{l}^{h}\right\} 
\]

\end_inset


\begin_inset Formula 
\[
\left(\nu_{k}\,g_{lk}(u^{h})\right)_{\partial E}\approx\left\{ \nu_{k}\,g_{lk}(u^{h})\right\} -C_{1l}\left\llbracket u^{h}\right\rrbracket ,\quad l=1,2,\dots,d
\]

\end_inset


\end_layout

\begin_layout Subsubsection
高维系统问题
\end_layout

\begin_layout Subsection
CDG (Compact DG)
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Peraire_2008"
literal "true"

\end_inset


\end_layout

\begin_layout Standard
...
 to overcome the issue that LDG method is not compact when applied to multidimen
sional problems.
\end_layout

\begin_layout Subsection
RDG (Recovery-based DG)
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "van_Leer_2005,van_Leer_2007"
literal "true"

\end_inset


\end_layout

\begin_layout Standard
...
 recovers a smooth continuous solution that in the weak sense is indistinguishab
le from the discontinuous discrete solution.
\end_layout

\begin_layout Subsection
rDG (Reconstructed DG)
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Luo_2010"
literal "true"

\end_inset


\end_layout

\begin_layout Standard
...
 a smooth continuous solution is reconstructed at each cell interface from
 the discontinuous discrete solution and the diffusive fluxes are then obtained
 based on the smooth reconstructed solution.
\end_layout

\begin_layout Subsection
DDG (Direct DG)
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Liu_2009_DDG,Liu_2010_DDG"
literal "true"

\end_inset

 求解扩散问题，
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Cheng_2016,Yang_2019"
literal "true"

\end_inset

 求解 Navier–Stokes 方程
\end_layout

\begin_layout Subsubsection
空间离散
\end_layout

\begin_layout Standard
对流–扩散方程组
\begin_inset Formula 
\[
\partial_{t}\,\underline{u}+\partial_{s}\,\underline{f_{s}}(\underline{u})=\partial_{s}\,\underline{g_{s}}(\underline{u},\underline{\partial}\,\underline{u}),
\]

\end_inset

其中
\begin_inset Formula 
\[
\underline{\partial}\,\underline{u}\equiv\underline{\partial}\otimes\underline{u},
\]

\end_inset

弱形式
\begin_inset Formula 
\[
\ip{w}{\partial_{t}\,\underline{u}}_{E}+\ip{w}{n_{s}\,\underline{f_{s}}}_{\partial E}-\ip{\partial_{s}\,w}{\underline{f_{s}}}_{E}=\ip{w}{n_{s}\,\underline{g_{s}}}_{\partial E}-\ip{\partial_{s}\,w}{\underline{g_{s}}}_{E},
\]

\end_inset

移项得
\begin_inset Formula 
\[
\ip{w}{\partial_{t}\,\underline{u}}_{E}=\ip{\partial_{s}\,w}{\underline{f_{s}}-\underline{g_{s}}}_{E}-\ip{w}{n_{s}\,\underline{f_{s}}-n_{s}\,\underline{g_{s}}}_{\partial E},
\]

\end_inset


\end_layout

\begin_layout Standard
引入 
\begin_inset Formula $p$
\end_inset

 次多项式近似
\begin_inset Formula 
\[
\underline{u}\approx\underline{u^{h}}=\sum_{k=1}^{N(p,d)}\underline{\hat{u}_{k}}(t)\,b_{k}(\vec{r}),\quad w\approx w^{h}=\sum_{l=1}^{N(p,d)}\hat{w}_{l}\,b_{l}(\vec{r}),\quad\Span\left\{ b_{k}\right\} _{k=1}^{N(p,d)}=\mathbb{P}_{p}(E)
\]

\end_inset

代入弱形式，得
\begin_inset Formula 
\[
\ip{\hat{w}_{l}\,b_{l}}{\partial_{t}\,\underline{\hat{u}_{k}}\,b_{k}}_{E}=\ip{\partial_{s}\,\hat{w}_{l}\,b_{l}}{\underline{f_{s}^{h}}-\underline{g_{s}^{h}}}_{E}-\ip{\hat{w}_{l}\,b_{l}}{\underline{f_{n}^{h}}-\underline{g_{n}^{h}}}_{\partial E},
\]

\end_inset

其中
\end_layout

\begin_layout Itemize
\begin_inset Formula $\left.\underline{f_{s}}\right\vert _{E}\approx\underline{f_{s}^{h}}$
\end_inset

 及 
\begin_inset Formula $\left.\underline{g_{s}}\right\vert _{E}\approx\underline{g_{s}^{h}}$
\end_inset

 为域内通量近似值，可取 
\begin_inset Formula $\underline{f_{s}}\qty(\underline{u^{h}})$
\end_inset

 及 
\begin_inset Formula $\underline{g_{s}}\qty(\underline{u^{h}},\underline{\partial}\,\underline{u^{h}})$
\end_inset

，亦可取其他插值函数；
\end_layout

\begin_layout Itemize
\begin_inset Formula $\left.n_{s}\,\underline{f_{s}}\right\vert _{\partial E}\approx\underline{f_{n}^{h}}\qty(\left.\underline{u^{h}}\right|_{\pm};\vec{n})$
\end_inset

 及 
\begin_inset Formula $\left.n_{s}\,\underline{g_{s}}\right\vert _{\partial E}\approx\underline{g_{n}^{h}}\qty(\left.\underline{u^{h}}\right|_{\pm},\underline{\partial}\left.\underline{u^{h}}\right|_{\pm};\vec{n})$
\end_inset

 为边界法向通量近似值，即数值通量。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
将不含空间坐标的 
\begin_inset Formula $\partial_{t}\,\underline{\hat{u}_{k}}(t)$
\end_inset

 及 
\begin_inset Formula $\hat{w}_{l}$
\end_inset

 提到积分号外，并利用 
\begin_inset Formula $\left\{ \hat{w}_{l}\right\} _{l=1}^{N}$
\end_inset

 的任意性，得 
\begin_inset Formula $N$
\end_inset

 个等式：
\begin_inset Formula 
\[
\langle b_{l}\vert b_{k}\rangle_{E}\dv{\underline{\hat{u}_{k}}}{t}=\underline{r_{l}},\quad l=1,\dots,N,
\]

\end_inset

其中
\begin_inset Formula 
\[
\underline{r_{l}}=\ip{\partial_{s}\,b_{l}}{\underline{f_{s}^{h}}-\underline{g_{s}^{h}}}_{E}-\ip{b_{l}}{\underline{f_{n}^{h}}-\underline{g_{n}^{h}}}_{\partial E}.
\]

\end_inset

以其为第 
\begin_inset Formula $l$
\end_inset

 行，可得矩阵形式：
\begin_inset Formula 
\[
\dv{}{t}\underline{\hat{u}}_{N\times K}=\underline{m}_{N\times N}^{-1}\,\underline{r}_{N\times K}(\underline{\hat{u}}),
\]

\end_inset

其中，基函数阵
\begin_inset Formula 
\[
\underline{b}_{N\times1}(\vec{x})\coloneqq\begin{bmatrix}b_{1}(\vec{x})\\
\vdots\\
b_{N}(\vec{x})
\end{bmatrix},
\]

\end_inset

质量阵
\begin_inset Formula 
\[
\underline{m}_{N\times N}\coloneqq\ip{\underline{b}_{N\times1}}{\left(\underline{b}^{\mathrm{T}}\right)_{1\times N}}_{E}=\begin{bmatrix}\ip{b_{1}}{b_{1}}_{E} & \cdots & \ip{b_{1}}{b_{N}}_{E}\\
\vdots & \ddots & \vdots\\
\ip{b_{N}}{b_{1}}_{E} & \cdots & \ip{b_{N}}{b_{N}}_{E}
\end{bmatrix},
\]

\end_inset

未知量系数阵
\begin_inset Formula 
\[
\underline{\hat{u}}_{N\times K}(t)\coloneqq\ip{\underline{b}_{N\times1}}{\underline{u}_{1\times K}}_{E}=\begin{bmatrix}\langle b_{1}\vert u_{1}\rangle_{E} & \cdots & \langle b_{1}\vert u_{N}\rangle_{E}\\
\vdots & \ddots & \vdots\\
\langle b_{K}\vert u_{1}\rangle_{E} & \cdots & \langle b_{K}\vert u_{N}\rangle_{E}
\end{bmatrix},
\]

\end_inset

在形式上均与纯对流问题相同，而残值项则变为
\begin_inset Formula 
\[
\underline{r}_{N\times K}\coloneqq\ip{\partial_{s}\,\underline{b}}{\underline{f_{s}^{h}}-\underline{g_{s}^{h}}}_{E}-\ip{\underline{b}}{\underline{f_{n}^{h}}-\underline{g_{n}^{h}}}_{\partial E}.
\]

\end_inset

最终的近似解为
\begin_inset Formula 
\[
\underbrace{\underline{u^{h}}(\vec{x},t)}_{1\times K}\approx\underbrace{\underline{b}^{\mathrm{T}}(\vec{x})}_{1\times N}\underbrace{\underline{\hat{u}}(t)}_{N\times K}
\]

\end_inset


\end_layout

\begin_layout Subsubsection
数值通量
\end_layout

\begin_layout Standard
分别记状态阶跃值、均值为
\begin_inset Formula 
\[
\left\llbracket \underline{u^{h}}\right\rrbracket =\left.\underline{u^{h}}\right|_{+}-\left.\underline{u^{h}}\right|_{-},\quad\left\{ \underline{u^{h}}\right\} =\frac{1}{2}\left(\left.\underline{u^{h}}\right|_{+}+\left.\underline{u^{h}}\right|_{-}\right),
\]

\end_inset

DDG 法的关键步骤，在于构造 
\begin_inset Formula $\underline{\partial}\,\underline{u}\equiv\underline{\partial}\otimes\underline{u}$
\end_inset

 在界面处的近似值：
\begin_inset Formula 
\begin{equation}
\boxed{\left(\underline{\partial}\otimes\underline{u}\right)_{\partial E}\approx\left(\underline{\partial}\,\underline{u}\right)^{h}\coloneqq\beta_{0}\,\Delta^{-1}\left\llbracket \underline{n}\otimes\underline{u^{h}}\right\rrbracket +\left\{ \underline{\partial}\otimes\underline{u^{h}}\right\} +\beta_{1}\,\Delta\left\llbracket \underline{n}\cdot\underline{\partial}\otimes\underline{\partial}\otimes\underline{u^{h}}\right\rrbracket },\label{eq:DDG-grad-at-interface}
\end{equation}

\end_inset

其中
\begin_inset Formula 
\[
\underline{\partial}\otimes\underline{u}\equiv\underline{\partial}\,\underline{u}=\begin{bmatrix}\partial_{x}\,\underline{u}\\
\partial_{y}\,\underline{u}
\end{bmatrix},\quad\underline{n}\otimes\underline{u^{h}}=\begin{bmatrix}n_{x}\,\underline{u^{h}}\\
n_{y}\,\underline{u^{h}}
\end{bmatrix},\quad\underline{\partial}\otimes\underline{\partial}\otimes\underline{u^{h}}=\begin{bmatrix}\partial_{x}\partial_{x}\,\underline{u^{h}} & \partial_{x}\partial_{y}\,\underline{u^{h}}\\
\partial_{y}\partial_{x}\,\underline{u^{h}} & \partial_{y}\partial_{y}\,\underline{u^{h}}
\end{bmatrix},
\]

\end_inset

故 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DDG-grad-at-interface"

\end_inset

 式的展开形式为
\begin_inset Formula 
\[
\begin{aligned}\left(\partial_{x}\,\underline{u}\right)^{h} & =\beta_{0}\,\Delta^{-1}\left\llbracket n_{x}\,\underline{u^{h}}\right\rrbracket +\left\{ \partial_{x}\,\underline{u^{h}}\right\} +\beta_{1}\,\Delta\left(n_{x}\left\llbracket \partial_{x}\partial_{x}\,\underline{u^{h}}\right\rrbracket +n_{y}\left\llbracket \partial_{x}\partial_{y}\,\underline{u^{h}}\right\rrbracket \right),\\
\left(\partial_{y}\,\underline{u}\right)^{h} & =\beta_{0}\,\Delta^{-1}\left\llbracket n_{y}\,\underline{u^{h}}\right\rrbracket +\left\{ \partial_{y}\,\underline{u^{h}}\right\} +\beta_{1}\,\Delta\left(n_{y}\left\llbracket \partial_{y}\partial_{x}\,\underline{u^{h}}\right\rrbracket +n_{y}\left\llbracket \partial_{y}\partial_{y}\,\underline{u^{h}}\right\rrbracket \right).
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Liu_2009_DDG,Liu_2010_DDG"
literal "true"

\end_inset

：
\begin_inset Formula 
\[
\beta_{0}\in[2,4],\quad\beta_{1}=\frac{1}{12},
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Cheng_2016"
literal "true"

\end_inset

 测试过
\begin_inset Formula 
\[
\Delta=d(\vec{c}_{i},\vec{c}_{j}),\quad\Delta=\vert(\vec{c}_{i}-\vec{c_{j}})\vdot\vec{n}_{ij}\vert,\quad\Delta=\frac{\vert E_{i}\vert+\vert E_{j}\vert}{2\vert(\partial E)_{ij}\vert},
\]

\end_inset

其中第二种效果最好，且等价于 
\begin_inset CommandInset citation
LatexCommand citet
key "Yang_2019"
literal "true"

\end_inset

 采用的
\begin_inset Formula 
\[
\Delta=d(\vec{c}_{i},(\partial E)_{ij})+d(\vec{c}_{j},(\partial E)_{ij})
\]

\end_inset


\end_layout

\begin_layout Standard
在物理边界处，由于缺少邻接单元，无法直接套用 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:DDG-grad-at-interface"

\end_inset

 式。
\begin_inset CommandInset citation
LatexCommand citet
key "Cheng_2016"
literal "true"

\end_inset

 令边界处的二阶导数阶跃值为零，即取
\begin_inset Formula 
\[
\left(\partial_{n}\,\underline{u}\right)^{h}=\beta_{0}\,\Delta^{-1}\left\llbracket \underline{u^{h}}\right\rrbracket +\partial_{n}\left.\underline{u^{h}}\right|_{-},
\]

\end_inset

其中
\begin_inset Formula 
\[
\Delta=d(\vec{c}_{i},\partial\Omega)\times\begin{cases}
2, & \text{ghost cell}\\
1, & \text{prescribed}
\end{cases}
\]

\end_inset


\end_layout

\begin_layout Section
FR (Flux Reconstruction)
\begin_inset CommandInset label
LatexCommand label
name "sec:FR"

\end_inset


\end_layout

\begin_layout Subsection
For 1D Conservation Laws
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\partial u(x,t)}{\partial t}+\frac{\partial f(u)}{\partial x}=0
\]

\end_inset


\end_layout

\begin_layout Standard
在第 
\begin_inset Formula $j$
\end_inset

 号单元 
\begin_inset Formula $E_{j}$
\end_inset

 上，定义坐标变换 
\begin_inset Formula $E_{j}\mapsto I\equiv[-1,1]$
\end_inset

 为
\begin_inset Formula 
\[
x|_{E_{j}}(\xi)=c_{j}+\frac{h_{j}}{2}\,\xi,\quad J_{j}=\left|\frac{\partial x}{\partial\xi}\right|\equiv\frac{h_{j}}{2}.
\]

\end_inset

其中 
\begin_inset Formula $c_{j}$
\end_inset

 为单元中心坐标，
\begin_inset Formula $h_{j}$
\end_inset

 为单元长度。
\end_layout

\begin_layout Subsubsection
Lagrange 插值
\end_layout

\begin_layout Standard
在 
\begin_inset Formula $E_{j}$
\end_inset

 内选定 
\begin_inset Formula $N$
\end_inset

 个未知量求值点，记为 
\begin_inset Formula $\left\{ x_{j,k}\equiv x|_{E_{j}}(\xi_{k})\right\} _{k=1}^{N}$
\end_inset

，并记 
\begin_inset Formula $u(x_{j,k},t)\eqqcolon u_{j,k}(t)$
\end_inset

。
\end_layout

\begin_layout Standard
\begin_inset Formula $\forall x_{j,k}$
\end_inset

 可构造 
\begin_inset Formula $(N-1)$
\end_inset

-次 Lagrange 多项式
\begin_inset Formula 
\[
\mathrm{La}_{j,k}(x)=\prod_{l=1,l\ne k}^{N}\frac{x-x_{j,l}}{x_{j,k}-x_{j,l}},\quad\mathrm{La}_{k}(\xi)=\prod_{l=1,l\ne k}^{N}\frac{\xi-\xi_{l}}{\xi_{k}-\xi_{l}},
\]

\end_inset

从而得到 
\begin_inset Formula $u$
\end_inset

 的 
\begin_inset Formula $(N-1)$
\end_inset

-次多项式近似
\begin_inset Formula 
\[
u_{j}^{h}(x,t)=\sum_{k=1}^{N}u_{j,k}(t)\,\mathrm{La}_{j,k}(x),
\]

\end_inset

或局部坐标系下的
\begin_inset Formula 
\[
\boxed{u_{j}^{h}(x(\xi),t)=\sum_{k=1}^{N}u_{j,k}(t)\,\mathrm{La}_{k}(\xi)}.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
间断通量
\end_layout

\begin_layout Standard
在 求值点 处计算通量值 
\begin_inset Formula 
\[
f_{j,k}\coloneqq f(u_{j,k}),\quad k=1,\dots,N.
\]

\end_inset

定义离散通量
\begin_inset Formula 
\[
f_{j}^{\mathrm{D}}(x,t)=\sum_{k=1}^{N}f_{j,k}(t)\,\mathrm{La}_{j,k}(x),
\]

\end_inset

或局部坐标下的
\begin_inset Formula 
\[
\boxed{f_{j}^{\mathrm{D}}(x(\xi),t)=\sum_{k=1}^{N}f_{j,k}(t)\,\mathrm{La}_{k}(\xi)}.
\]

\end_inset

其在 
\begin_inset Formula $x_{j,l}\equiv x|_{E_{j}}(\xi_{l})$
\end_inset

 处的导数为
\begin_inset Formula 
\[
\left.\frac{\partial f_{j}}{\partial\xi}\right|_{\xi_{l}}=\sum_{k=1}^{N}f_{j,k}(t)\,\underbrace{\left.\frac{\partial\mathrm{La}_{k}}{\partial\xi}\right|_{\xi_{l}}}_{\eqqcolon d_{l,k}}=\sum_{k=1}^{N}d_{l,k}\,f_{j,k}(t)
\]

\end_inset

或
\begin_inset Formula 
\[
\left.\frac{\partial f_{j}}{\partial x}\right|_{x_{j,l}}=\left.\frac{\partial x}{\partial\xi}\right|_{\xi_{l}}^{-1}\left.\frac{\partial f_{j}}{\partial\xi}\right|_{\xi_{l}}.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
界面通量
\end_layout

\begin_layout Standard
在单元界面 
\begin_inset Formula $x_{j+1/2}$
\end_inset

 处，未知量近似解的左右值
\begin_inset Formula 
\[
u_{\mathrm{L}}\coloneqq u_{j}^{h}(x_{j+1/2}),\quad u_{\mathrm{R}}\coloneqq u_{j+1}^{h}(x_{j+1/2}),
\]

\end_inset

及间断通量的左右值
\begin_inset Formula 
\[
f_{\mathrm{L}}\coloneqq f_{j}^{\mathrm{D}}(x_{j+1/2}),\quad f_{\mathrm{R}}\coloneqq f_{j+1}^{\mathrm{D}}(x_{j+1/2}),
\]

\end_inset

通常是间断的：
\begin_inset Formula 
\[
u_{\mathrm{L}}\ne u_{\mathrm{R}},\quad f_{\mathrm{L}}\ne f_{\mathrm{R}},\quad f_{\mathrm{L}}\ne f(u_{\mathrm{L}}),\quad f_{\mathrm{R}}\ne f(u_{\mathrm{R}}).
\]

\end_inset

需要补充某种界面通量（某种 Riemann 求解器），记为 
\begin_inset Formula $f^{\mathrm{I}}(x,t)$
\end_inset

。这里省略下标（即视为全局函数），乃因其在界面处的取值唯一，故不偏向于任意一侧。
\end_layout

\begin_layout Standard
一种常用的界面通量为
\begin_inset Formula 
\[
f_{j+1/2}^{\mathrm{I}}=\frac{f(u_{\mathrm{R}})+f(u_{\mathrm{L}})}{2}-\left|a(\tilde{u})\right|\frac{u_{\mathrm{R}}-u_{\mathrm{L}}}{2},
\]

\end_inset

其中
\begin_inset Formula 
\[
a(\tilde{u})=\begin{cases}
\dfrac{f(u_{\mathrm{R}})-f(u_{\mathrm{L}})}{u_{\mathrm{R}}-u_{\mathrm{L}}}, & u_{\mathrm{L}}\ne u_{\mathrm{R}};\\
a(u_{\mathrm{L}})=a(u_{\mathrm{R}}), & u_{\mathrm{L}}=u_{\mathrm{R}}.
\end{cases}
\]

\end_inset

推广到 Euler 系统即 Roe 平均，通常需要熵修正。
\end_layout

\begin_layout Subsubsection
连续通量
\end_layout

\begin_layout Standard
通过对 
\begin_inset Formula $f_{j}^{\mathrm{D}}$
\end_inset

 引入修正函数 
\begin_inset Formula $f_{j}^{\mathrm{C}}$
\end_inset

，可以重构出连续的近似通量：
\begin_inset Formula 
\[
\boxed{f_{j}^{\mathrm{R}}\coloneqq f_{j}^{\mathrm{D}}+f_{j}^{\mathrm{C}}},
\]

\end_inset

要求其在单元界面处等于迎风通量：
\begin_inset Formula 
\[
\boxed{\left.f_{j}^{\mathrm{R}}\right|_{x_{j\pm1/2}}=f_{j\pm1/2}^{\mathrm{I}}},
\]

\end_inset

并且在单元内部（按某种度量）接近间断通量：
\begin_inset Formula 
\[
\boxed{\left.f_{j}^{\mathrm{R}}\right|_{x}\approx\left.f_{j}^{\mathrm{D}}\right|_{x}},\quad\forall x\in E_{j}.
\]

\end_inset


\end_layout

\begin_layout Standard
不失一般性，可定义归一化的修正函数
\begin_inset Formula 
\[
g_{-1}(\xi)\begin{cases}
=1, & \xi=-1,\\
\approx0, & \xi\in(-1,+1),\\
=0, & \xi=+1,
\end{cases}\quad g_{+1}(\xi)\begin{cases}
=0, & \xi=-1,\\
\approx0, & \xi\in(-1,+1),\\
=1, & \xi=+1.
\end{cases}
\]

\end_inset

由此得连续通量
\begin_inset Formula 
\[
f_{j}^{\mathrm{R}}(x(\xi),t)=f_{j}^{\mathrm{D}}(x(\xi),t)+\overbrace{\sum_{\zeta=\pm1}\left(f^{\mathrm{I}}(x(\zeta),t)-f_{j}^{\mathrm{D}}(x(\zeta),t)\right)g_{\zeta}(\xi)}^{f_{j}^{\mathrm{C}}(x(\xi),t)},
\]

\end_inset

其局部导数为
\begin_inset Formula 
\[
\frac{\partial f_{j}^{\mathrm{R}}(x(\xi),t)}{\partial\xi}=\frac{\partial f_{j}^{\mathrm{D}}(x(\xi),t)}{\partial\xi}+\sum_{\zeta=\pm1}\left(f^{\mathrm{I}}(x(\zeta),t)-f_{j}^{\mathrm{D}}(x(\zeta),t)\right)\frac{\dd g_{\zeta}(\xi)}{\dd\xi}.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
半离散格式
\end_layout

\begin_layout Standard
上述 
\begin_inset Formula $f_{j}^{\mathrm{R}}$
\end_inset

 的全局导数为
\begin_inset Formula 
\[
\frac{\partial f_{j}^{\mathrm{R}}(x,t)}{\partial x}=\left(\frac{\partial x(\xi)}{\partial\xi}\right)^{-1}\frac{\partial f_{j}^{\mathrm{R}}(x(\xi),t)}{\partial\xi},
\]

\end_inset

用其近似原 PDE 中的 
\begin_inset Formula $\partial_{x}\,f$
\end_inset

，即得半离散的 FR 格式：
\begin_inset Formula 
\[
\boxed{\dv{u_{j,k}(t)}{t}=-\left.\frac{\partial f_{j}^{\mathrm{R}}(x,t)}{\partial x}\right|_{x_{j,k}}},\quad k=1,\dots,N.
\]

\end_inset

考虑显式 Euler 推进：
\begin_inset Formula 
\[
u_{j}^{n+1}=u_{j}^{n}-\frac{\partial f_{j}^{\mathrm{R}}(x,t)}{\partial x}h_{t},
\]

\end_inset

为保持 
\begin_inset Formula $u_{j}^{n+1}$
\end_inset

 的次数仍为 
\begin_inset Formula $N-1$
\end_inset

，连续通量 
\begin_inset Formula $f_{j}^{\mathrm{R}}$
\end_inset

 及修正函数 
\begin_inset Formula $g_{\pm1}$
\end_inset

 均应为 
\begin_inset Formula $N$
\end_inset

 次多项式。由于 
\begin_inset Formula $g_{\pm1}$
\end_inset

 已给定两点取值，故仍需给定 
\begin_inset Formula $N-1$
\end_inset

 个独立条件。
\end_layout

\begin_layout Subsubsection
Quadratures and Polynomials
\end_layout

\begin_layout Paragraph
Legendre
\end_layout

\begin_layout Standard
By requiring the algebraic precision of the 
\begin_inset Formula $N$
\end_inset

-point quadrature rule, i.e.
\begin_inset Formula 
\[
\int_{-1}^{+1}f(\xi)\dd{\xi}\approx\sum_{k=1}^{N}w_{k}\,f(\xi_{k}),\quad\xi_{1}=-1,
\]

\end_inset

to be as high as possible, one gets the Gauss–Legendre quadrature.
 It is exact for members in 
\begin_inset Formula $\mathbb{P}_{2N-1}([-1,+1])$
\end_inset

.
\end_layout

\begin_layout Standard
The Legendre polynomial of degree 
\begin_inset Formula $k$
\end_inset

 is
\begin_inset Formula 
\[
\mathrm{Le}_{k}(\xi)=\frac{1}{2^{k}\,k!}\frac{\dd^{k}}{\dd\xi^{k}}\left(\xi^{2}-1\right)^{k},
\]

\end_inset

whose zeros in 
\begin_inset Formula $[-1,+1]$
\end_inset

 are the Gauss–Legendre quadrature points.
 It is easy to see that
\begin_inset Formula 
\[
\mathrm{Le}_{k}(-1)=(-1)^{k},\quad\mathrm{Le}_{k}(+1)=1,\quad\mathrm{Le}_{k}(-\xi)=(-1)^{k}\,\mathrm{Le}_{k}(\xi),\quad\mathrm{Le}_{k}\perp\mathbb{P}_{k-1}.
\]

\end_inset


\end_layout

\begin_layout Paragraph
Radau
\end_layout

\begin_layout Standard
By requiring 
\begin_inset Formula $\xi_{1}=-1$
\end_inset

 in the 
\begin_inset Formula $N$
\end_inset

-point quadrature rule, i.e.
\begin_inset Formula 
\[
\int_{-1}^{+1}f(\xi)\dd{\xi}\approx\sum_{k=1}^{N}w_{k}\,f(\xi_{k}),\quad\xi_{1}=-1,
\]

\end_inset

and requiring the rule's algebraic precision to be as high as possible,
 one gets the left Radau quadrature.
 It is exact for members in 
\begin_inset Formula $\mathbb{P}_{2N-2}([-1,+1])$
\end_inset

.
\end_layout

\begin_layout Standard
The left Radau polynomial of degree 
\begin_inset Formula $k$
\end_inset

 is
\begin_inset Formula 
\[
\mathrm{Ra}_{\mathrm{L},k}(\xi)=\frac{\mathrm{Le}_{k}(\xi)+\mathrm{Le}_{k-1}(\xi)}{2},
\]

\end_inset

whose zeros in 
\begin_inset Formula $[-1,+1]$
\end_inset

 are the left Radau quadrature points.
 Actually, 
\begin_inset Formula $\mathrm{Ra}_{\mathrm{L},k}(\xi)$
\end_inset

 can be determined from the following 
\begin_inset Formula $2+(k-1)$
\end_inset

 condition
\begin_inset Formula 
\[
\mathrm{Ra}_{\mathrm{L},k}(-1)=0,\quad\mathrm{Ra}_{\mathrm{L},k}(+1)=1,\quad\mathrm{Ra}_{\mathrm{L},k}\perp\mathbb{P}_{k-2}.
\]

\end_inset


\end_layout

\begin_layout Standard
Similarly, the right Radau polynomials of degree 
\begin_inset Formula $k$
\end_inset

 is 
\begin_inset Formula 
\[
\mathrm{Ra}_{\mathrm{R},k}(\xi)=(-1)^{k}\frac{\mathrm{Le}_{k}(\xi)-\mathrm{Le}_{k-1}(\xi)}{2}.
\]

\end_inset

 It is easy to see that
\begin_inset Formula 
\[
\mathrm{Ra}_{\mathrm{R},k}(-1)=1,\quad\mathrm{Ra}_{\mathrm{R},k}(+1)=0,\quad\mathrm{Ra}_{\mathrm{R},k}\perp\mathbb{P}_{k-2}.
\]

\end_inset


\end_layout

\begin_layout Paragraph
Lobatto
\end_layout

\begin_layout Standard
Suppose 
\begin_inset Formula $N\ge2$
\end_inset

.
\end_layout

\begin_layout Standard
By requiring 
\begin_inset Formula $\xi_{1}=-1$
\end_inset

 and 
\begin_inset Formula $\xi_{K}=+1$
\end_inset

 in the 
\begin_inset Formula $N$
\end_inset

-point quadrature rule, i.e.
\begin_inset Formula 
\[
\int_{-1}^{+1}f(\xi)\dd{\xi}\approx\sum_{k=1}^{N}w_{k}\,f(\xi_{k}),\quad\xi_{1}=-1,\quad\xi_{N}=+1,
\]

\end_inset

and requiring the rule's algebraic precision to be as high as possible,
 one gets the Lobatto quadrature.
 It is exact for members in 
\begin_inset Formula $\mathbb{P}_{2N-3}([-1,+1])$
\end_inset

.
\end_layout

\begin_layout Standard
The Lobatto polynomial of degree 
\begin_inset Formula $k$
\end_inset

 is
\begin_inset Formula 
\[
\mathrm{Lo}_{k}(\xi)=\mathrm{Le}_{k}(\xi)-\mathrm{Le}_{k-2}(\xi),
\]

\end_inset

whose zeros in 
\begin_inset Formula $[-1,+1]$
\end_inset

 are the Lobatto quadrature points.
 It is easy to see that
\begin_inset Formula 
\[
\mathrm{Lo}_{k}(-1)=0,\quad\mathrm{Lo}_{k}(+1)=0,\quad\mathrm{Lo}_{k}\perp\mathbb{P}_{k-3}.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
修正函数实例
\end_layout

\begin_layout Paragraph
\begin_inset Formula $g\perp\mathbb{P}_{N-2}$
\end_inset


\end_layout

\begin_layout Standard
前面提到 
\begin_inset Formula $g(\xi)$
\end_inset

 应在“某种意义”下等于 
\begin_inset Formula $0(\xi)$
\end_inset

，其中一种意义是正交性：使 
\begin_inset Formula $g\perp\mathbb{P}_{L}$
\end_inset

 对尽可能高的 
\begin_inset Formula $L$
\end_inset

 成立。由于 
\begin_inset Formula $\dim\mathbb{P}_{L}=L+1$
\end_inset

，故 
\begin_inset Formula $g_{\pm1}\perp\mathbb{P}_{L}$
\end_inset

 相当于给出了 
\begin_inset Formula $L+1$
\end_inset

 个独立等式：
\begin_inset Formula 
\[
g\perp\phi_{l},\quad l=0,1,\dots,L,
\]

\end_inset

其中 
\begin_inset Formula $\left\{ \phi_{l}\right\} _{l=1}^{L}$
\end_inset

 是 
\begin_inset Formula $\mathbb{P}_{L}$
\end_inset

 的一组正交基；又因为 
\begin_inset Formula $N$
\end_inset

 次多项式 
\begin_inset Formula $g$
\end_inset

 只有 
\begin_inset Formula $N+1$
\end_inset

 个自由度，其中两个已被端点值锁定，对于 
\begin_inset Formula $g_{+1}$
\end_inset

 它们是
\begin_inset Formula 
\[
g_{+1}(-1)=0,\quad g_{+1}(+1)=1,
\]

\end_inset

故至多还可提 
\begin_inset Formula $N-1$
\end_inset

 个正交性条件，即 
\begin_inset Formula $g_{+1}\perp\mathbb{P}_{N-2}$
\end_inset

，从而有
\begin_inset Formula 
\[
g_{+1}(\xi)=\frac{\mathrm{Le}_{N}(\xi)+\mathrm{Le}_{N-1}(\xi)}{2}\equiv\mathrm{Ra}_{\mathrm{L},N}(\xi),
\]

\end_inset


\begin_inset Formula 
\[
g_{-1}(\xi)=g_{+1}(-\xi)=\frac{\mathrm{Le}_{N}(-\xi)+\mathrm{Le}_{N-1}(-\xi)}{2}=(-1)^{N}\frac{\mathrm{Le}_{N}(\xi)-\mathrm{Le}_{N-1}(\xi)}{2}\equiv\mathrm{Ra}_{\mathrm{R},N}(\xi),
\]

\end_inset

其导数为
\begin_inset Formula 
\[
\frac{\dd g_{+1}(\xi)}{\dd\xi}=\frac{1}{2}\left(\frac{\dd\mathrm{Le}_{N}(\xi)}{\dd\xi}+\frac{\dd\mathrm{Le}_{N-1}(\xi)}{\dd\xi}\right),
\]

\end_inset


\begin_inset Formula 
\[
\frac{\dd g_{-1}(\xi)}{\dd\xi}=\frac{(-1)^{N}}{2}\left(\frac{\dd\mathrm{Le}_{N}(\xi)}{\dd\xi}-\frac{\dd\mathrm{Le}_{N-1}(\xi)}{\dd\xi}\right),
\]

\end_inset

其中 Legendre 多项式的导数由递归关系算出：
\begin_inset Formula 
\[
\frac{\dd\mathrm{Le}_{0}(\xi)}{\dd\xi}=0;\quad\frac{\dd\mathrm{Le}_{k}(\xi)}{\dd\xi}=k\,\mathrm{Le}_{k-1}(\xi)+\xi\,\frac{\dd\mathrm{Le}_{k-1}(\xi)}{\dd\xi},\quad k=1,\dots,N.
\]

\end_inset

由此导出的 FR 格式与某种 DG 格式等价，详见 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:DGequivFR"

\end_inset

 节。
\end_layout

\begin_layout Paragraph
\begin_inset Formula $g\perp\mathbb{P}_{N-3}$
\end_inset


\end_layout

\begin_layout Standard
Relaxing 
\begin_inset Formula $g\perp\mathbb{P}_{N-2}$
\end_inset

 in the DG scheme to 
\begin_inset Formula $g\perp\mathbb{P}_{N-3}$
\end_inset

 and requiring 
\begin_inset Formula $g_{+1}'(-1)=0$
\end_inset

 (i.e.
 requiring 
\begin_inset Formula $\xi=-1$
\end_inset

 to be a zero of multiplicity 2) gives
\begin_inset Formula 
\[
\begin{aligned}g_{+1}(\xi) & =\frac{N-1}{2N-1}\mathrm{Ra}_{\mathrm{L},N}(\xi)+\frac{N}{2N-1}\mathrm{Ra}_{\mathrm{L},N-1}(\xi)\\
 & =\frac{N-1}{2N-1}\frac{\mathrm{Le}_{N}(\xi)+\mathrm{Le}_{N-1}(\xi)}{2}+\frac{N}{2N-1}\frac{\mathrm{Le}_{N-1}(\xi)+\mathrm{Le}_{N-2}(\xi)}{2}\\
 & =\frac{N-1}{2N-1}\frac{\mathrm{Le}_{N}(\xi)}{2}+\frac{\mathrm{Le}_{N-1}(\xi)}{2}+\frac{N}{2N-1}\frac{\mathrm{Le}_{N-2}(\xi)}{2}
\end{aligned}
\]

\end_inset

whose derivative vanishes at the right 
\begin_inset Formula $N-1$
\end_inset

 Lobatto points and thus corrects 
\begin_inset Formula $f_{j}'(\xi)$
\end_inset

 only at the left boundary.
\end_layout

\begin_layout Standard
The resulting scheme is accurate to order 
\begin_inset Formula $2N-2$
\end_inset

 and has a CFL limit roughly twice as large as that of DG.
\end_layout

\begin_layout Standard
该过程可以进一步推广：Requiring 
\begin_inset Formula $g_{+1}(+1)=1$
\end_inset

 and 
\begin_inset Formula $\xi=-1$
\end_inset

 to be a zero of multiplicity 
\begin_inset Formula $m$
\end_inset

, i.e.
\begin_inset Formula 
\[
\dv[l]{\xi}g_{+1}(-1)=0,\quad l=0,1,\dots,m-1,
\]

\end_inset

and 
\begin_inset Formula $g_{+1}\perp\mathbb{P}_{N-1-m}$
\end_inset

 , gives 
\begin_inset Formula $g_{m}$
\end_inset

 (e.g.
 
\begin_inset Formula $g_{1}=g_{\text{DG}}$
\end_inset

, 
\begin_inset Formula $g_{2}=g_{\text{Lump, Lo}}$
\end_inset

).
\end_layout

\begin_layout Standard
The resulting scheme is accurate to order 
\begin_inset Formula $2N-m$
\end_inset

.
\begin_inset CommandInset citation
LatexCommand citet
key "Huynh_2007"
literal "true"

\end_inset


\end_layout

\begin_layout Paragraph
Staggered Grid
\end_layout

\begin_layout Standard
注意到 
\begin_inset Formula $N$
\end_inset

-次多项式至多有 
\begin_inset Formula $N$
\end_inset

 个（实）零点，记为 
\begin_inset Formula $\left\{ \zeta_{k}\right\} _{k=1}^{N}$
\end_inset

。对于 
\begin_inset Formula $g_{-1}(\xi)$
\end_inset

，其中之一已被给定，记为 
\begin_inset Formula $\zeta_{N}=1$
\end_inset

。剩下的任务便是给出其余 
\begin_inset Formula $N-1$
\end_inset

 个零点。
\end_layout

\begin_layout Standard
Consider the 
\begin_inset Formula $N+1$
\end_inset

 Chebyshev–Lobatto points
\begin_inset Formula 
\[
\zeta_{k}=-\cos(\frac{k\pi}{N}),\quad k=0,1,\dots,N.
\]

\end_inset

Requiring
\begin_inset Formula 
\[
g(\zeta_{0})=1,\quad g(\zeta_{k})=0,\quad k=1,\dots,N,
\]

\end_inset

which leads to a simplified version of the SG scheme.
\end_layout

\begin_layout Standard
The resulting scheme is less accurate than DG but has a CFL limit more than
 
\begin_inset Formula $3/2$
\end_inset

 as large as that of DG.
\end_layout

\begin_layout Paragraph
Energy Stable FR by Vincent et al.
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Vincent_2010"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $u$
\end_inset

 以 
\begin_inset Formula $N$
\end_inset

 次多项式近似，则修正函数需 
\begin_inset Formula $N+1$
\end_inset

 次：
\begin_inset Formula 
\[
g_{+1}(\xi)=\frac{\mathrm{Le}_{N}(\xi)+\lambda\,\mathrm{Le}_{N-1}(\xi)+\mu\,\mathrm{Le}_{N+1}(\xi)}{2}
\]

\end_inset


\begin_inset Formula 
\[
g_{-1}(\xi)=g_{+1}(-\xi)=(-1)^{N}\frac{\mathrm{Le}_{N}(\xi)-\lambda\,\mathrm{Le}_{N-1}(\xi)-\mu\,\mathrm{Le}_{N+1}(\xi)}{2}
\]

\end_inset

其中
\begin_inset Formula 
\[
\lambda=\frac{\eta}{1+\eta},\quad\mu=\frac{1}{1+\eta},\quad\eta=\frac{c}{-c_{-}},
\]

\end_inset


\begin_inset Formula 
\[
c_{-}=\frac{-2}{2N+1}\overbrace{\left(\frac{2^{N}\,N!}{(2N)!}\right)^{2}}^{A_{N}},\quad c_{-}<c<\infty.
\]

\end_inset

参数 
\begin_inset Formula $c$
\end_inset

 的某些特殊值可以导出既有格式：
\end_layout

\begin_layout Description
Discontinuous
\begin_inset space \space{}
\end_inset

Galerkin 
\begin_inset Formula 
\[
c=0,\quad\eta=0,\quad\lambda=0,\quad\mu=1.
\]

\end_inset


\end_layout

\begin_layout Description
Spectral
\begin_inset space \space{}
\end_inset

Difference 
\begin_inset Formula 
\[
c=\frac{2N}{(2N+1)(N+1)}A_{N},\quad\eta=\frac{N}{N+1},\quad\lambda=\frac{N}{2N+1},\quad\mu=\frac{N+1}{2N+1}.
\]

\end_inset


\end_layout

\begin_layout Description
Huyhn's
\begin_inset space \space{}
\end_inset


\begin_inset Formula $g_{2}$
\end_inset

 
\begin_inset Formula 
\[
c=\frac{2(N+1)}{(2N+1)N}A_{N},\quad\eta=\frac{N+1}{N},\quad\lambda=\frac{N+1}{2N+1},\quad\mu=\frac{N}{2N+1}.
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Subsection
For 2D Conservation Laws
\end_layout

\begin_layout Subsubsection
FR on Global Triangles
\end_layout

\begin_layout Standard
标量守恒律
\begin_inset Formula 
\[
\partial_{t}\,u+\divg\vec{f}=0,
\]

\end_inset

在单元 
\begin_inset Formula $E$
\end_inset

 上，以关于 
\begin_inset Formula $(x,y)$
\end_inset

 的 
\begin_inset Formula $K$
\end_inset

 次多项式 
\begin_inset Formula $u^{h}$
\end_inset

 作为对 
\begin_inset Formula $u$
\end_inset

 的近似，以分量为关于 
\begin_inset Formula $(x,y)$
\end_inset

 的 
\begin_inset Formula $K$
\end_inset

 次多项式的向量函数 
\begin_inset Formula $\vec{f}^{h}$
\end_inset

作为对 
\begin_inset Formula $\vec{f}$
\end_inset

 的近似。
\end_layout

\begin_layout Standard
\begin_inset Formula $\forall\phi\in\mathbb{P}_{K}(E)$
\end_inset

，该守恒律成立的必要条件为
\begin_inset Formula 
\[
\langle\partial_{t}\,u^{h}\vert\phi\rangle_{E}+\langle\divg\vec{f}^{\mathrm{D}}\vert\phi\rangle_{E}=0.
\]

\end_inset

分部积分一次，得弱形式
\begin_inset Formula 
\[
\langle\partial_{t}\,u^{h}\vert\phi\rangle_{E}+\langle\vec{\nu}\vdot\vec{f}^{\mathrm{D}}\vert\phi\rangle_{\partial E}-\langle\vec{f}^{\mathrm{D}}\vert\grad\phi\rangle_{E}=0,
\]

\end_inset

将 
\begin_inset Formula $\vec{\nu}\vdot\vec{f}^{\mathrm{D}}\eqqcolon f_{\nu}^{\mathrm{D}}$
\end_inset

 用迎风通量 
\begin_inset Formula $f_{\nu}^{\mathrm{I}}$
\end_inset

 替换，得弱形式
\begin_inset Formula 
\[
\langle\partial_{t}\,u^{h}\vert\phi\rangle_{E}+\langle f_{\nu}^{\mathrm{I}}\vert\phi\rangle_{\partial E}-\langle\vec{f}^{\mathrm{D}}\vert\grad\phi\rangle_{E}=0.
\]

\end_inset

由此可以导出 DG 格式。
\end_layout

\begin_layout Standard
再次分部积分，并记通量阶跃值
\begin_inset Formula 
\[
[f_{\nu}]\coloneqq f_{\nu}^{\mathrm{I}}-f_{\nu}^{\mathrm{D}},
\]

\end_inset

得强形式
\begin_inset Formula 
\[
\langle\partial_{t}\,u^{h}\vert\phi\rangle_{E}+\langle[f_{\nu}]\vert\phi\rangle_{\partial E}+\langle\divg\vec{f}^{\mathrm{D}}\vert\phi\rangle_{E}=0,
\]

\end_inset

为提取出 
\begin_inset Formula $\phi$
\end_inset

，需将 
\begin_inset Formula $\partial E$
\end_inset

 上的积分化为 
\begin_inset Formula $E$
\end_inset

 上的积分。
\end_layout

\begin_layout Standard
三角形 
\begin_inset Formula $E$
\end_inset

 上的次数不超过 
\begin_inset Formula $K$
\end_inset

 的单项式有 
\begin_inset Formula 
\[
\dim\mathbb{P}_{K}(E)=K_{N}=\binom{K+2}{2}
\]

\end_inset

个。令 
\begin_inset Formula $\phi_{k}$
\end_inset

 为 
\begin_inset Formula $E$
\end_inset

 上的第 
\begin_inset Formula $k$
\end_inset

 个多项式基；令 
\begin_inset Formula $(x,y)_{e,l}$
\end_inset

 为 
\begin_inset Formula $E$
\end_inset

 的第 
\begin_inset Formula $e$
\end_inset

 条边上的第 
\begin_inset Formula $l$
\end_inset

 个（共 
\begin_inset Formula $K+1$
\end_inset

 个）通量计算点；令 
\begin_inset Formula $\varphi_{e,l}$
\end_inset

 为该点对应的 
\begin_inset Formula $K$
\end_inset

 次 Lagrange 多项式，并将其延拓到 
\begin_inset Formula $\partial E$
\end_inset

 上（在其他边上取值为 
\begin_inset Formula $0$
\end_inset

），从而有
\begin_inset Formula 
\[
[f_{\nu}]\approx\sum_{e=1}^{3}\sum_{l=1}^{K+1}[f_{\nu}]_{e,l}\,\varphi_{e,l}(x,y)
\]

\end_inset

更进一步地，可以将 
\begin_inset Formula $\varphi_{e,l}$
\end_inset

 延拓到整个 
\begin_inset Formula $E$
\end_inset

 上，即寻找 
\begin_inset Formula $K_{N}$
\end_inset

 个独立参数以确定 
\begin_inset Formula $\gamma_{e,l}\in\mathbb{P}_{K}(E)$
\end_inset

，使其满足以下 
\begin_inset Formula $K_{N}$
\end_inset

 个独立等式：
\begin_inset Formula 
\[
\langle\gamma_{e,l}\vert\phi_{k}\rangle_{E}=\langle\varphi_{e,l}\vert\phi_{k}\rangle_{\partial E},\quad k=1,\dots,K_{N}.
\]

\end_inset

利用所得的 
\begin_inset Formula $\gamma_{e,l}$
\end_inset

 可以将 
\begin_inset Formula $\partial E$
\end_inset

 上的积分化为 
\begin_inset Formula $E$
\end_inset

 上 的积分：
\begin_inset Formula 
\[
\begin{aligned}\langle[f_{\nu}]\vert\phi_{k}\rangle_{\partial E} & \approx\left\langle \sum_{e=1}^{3}\sum_{l=1}^{K+1}[f_{\nu}]_{e,l}\,\varphi_{e,l}\middle\vert\phi_{k}\right\rangle _{\partial E}\\
 & =\sum_{e=1}^{3}\sum_{l=1}^{K+1}[f_{\nu}]_{e,l}\,\langle\varphi_{e,l}\vert\phi_{k}\rangle_{\partial E}=\sum_{e=1}^{3}\sum_{l=1}^{K+1}[f_{\nu}]_{e,l}\,\langle\gamma_{e,l}\vert\phi_{k}\rangle_{E}
\end{aligned}
\]

\end_inset

从而可以提出 
\begin_inset Formula $\phi_{k}$
\end_inset

，得 FR 格式。
\end_layout

\begin_layout Standard
若通量计算点 
\begin_inset Formula $(x,y)_{e,l}$
\end_inset

 取为所属边的 Gauss 积分点，则该点对应的权重为
\begin_inset Formula 
\[
w_{e,l}=\langle\varphi_{e,l}\vert1\rangle_{\partial E}.
\]

\end_inset

又因 
\begin_inset Formula $(\varphi_{e,l}\,\phi)\in\mathbb{P}_{2K}(T)$
\end_inset

，故 
\begin_inset Formula $\langle\varphi_{e,l}\vert\phi\rangle_{\partial E}$
\end_inset

 可以被 
\begin_inset Formula $K+1$
\end_inset

 点 Gauss 积分公式精确计算，即
\begin_inset Formula 
\[
\langle\varphi_{e,l}\vert\phi\rangle_{\partial E}=\sum_{k=1}^{K+1}w_{e,k}\,\phi(x_{e,k},y_{e,k})=w_{e,l}\,\phi(x_{e,k},y_{e,l}),
\]

\end_inset

故
\begin_inset Formula 
\[
\langle\gamma_{e,l}\vert\phi\rangle_{E}=\langle\varphi_{e,l}\vert\phi\rangle_{\partial E}=w_{e,l}\,\phi(x_{e,k},y_{e,l}),
\]

\end_inset

因此 
\begin_inset Formula $\gamma_{e,l}/w_{e,l}$
\end_inset

 是 
\begin_inset Formula $E$
\end_inset

 上的 Dirac 函数的一种近似。
\end_layout

\begin_layout Standard
\begin_inset Formula $K$
\end_inset

 次多项式 
\begin_inset Formula $\gamma_{e,l}$
\end_inset

 是对通量散度 
\begin_inset Formula $\divg\vec{f}^{h}$
\end_inset

 的修正。若能构造出分量为 
\begin_inset Formula $K+1$
\end_inset

 次多项式的 
\begin_inset Formula $\vec{g}_{e,l}$
\end_inset

，使得
\begin_inset Formula 
\[
\divg\vec{g}_{e,l}=\gamma_{e,l},
\]

\end_inset

则得对通量本身的修正，即连续通量
\begin_inset Formula 
\[
\vec{F}^{h}=\vec{f}^{h}+\sum_{e=1}^{3}\sum_{l=1}^{K+1}[f_{\nu}]_{e,l}\,\vec{g}_{e,l},
\]

\end_inset


\end_layout

\begin_layout Subsubsection
FR on Standard Triangule
\end_layout

\begin_layout Standard
利用坐标变换 
\begin_inset Formula $\underbrace{(x,y)}_{\vec{r}}\mapsto\underbrace{(\xi,\eta)}_{\vec{\rho}}$
\end_inset

 及相应的导数变换（下标表示求导）
\begin_inset Formula 
\[
\begin{bmatrix}\phi_{\xi} & \phi_{\eta}\end{bmatrix}=\begin{bmatrix}\phi_{x} & \phi_{y}\end{bmatrix}\underbrace{\begin{bmatrix}x_{\xi} & x_{\eta}\\
y_{\xi} & y_{\eta}
\end{bmatrix}}_{\underline{J}},
\]

\end_inset

可将一般三角形 
\begin_inset Formula $E$
\end_inset

 上的守恒律
\begin_inset Formula 
\[
\partial_{t}\,u+\partial_{\vec{r}}\vdot\vec{f}=0,\quad\partial_{\vec{r}}\vdot\vec{f}\equiv\partial_{x}\,f+\partial_{y}\,g,
\]

\end_inset

化为标准三角形 
\begin_inset Formula $T$
\end_inset

 上的守恒律
\begin_inset Formula 
\[
\partial_{t}\,U+\partial_{\vec{\rho}}\vdot\vec{F}=0,\quad\partial_{\vec{\rho}}\vdot\vec{F}\equiv\partial_{\xi}\,F+\partial_{\eta}\,G,
\]

\end_inset

其中
\begin_inset Formula 
\[
U=J\,u,\quad\begin{bmatrix}F\\
G
\end{bmatrix}=\underbrace{\begin{bmatrix}y_{\eta} & -x_{\eta}\\
-y_{\xi} & x_{\xi}
\end{bmatrix}}_{J\,\underline{J}^{-1}\equiv\underline{J}^{*}}\begin{bmatrix}f\\
g
\end{bmatrix}.
\]

\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Proof
由导数变换公式
\begin_inset Formula 
\[
\begin{bmatrix}\phi_{\xi} & \phi_{\eta}\end{bmatrix}=\begin{bmatrix}\phi_{x} & \phi_{y}\end{bmatrix}\underbrace{\begin{bmatrix}x_{\xi} & x_{\eta}\\
y_{\xi} & y_{\eta}
\end{bmatrix}}_{\underline{J}}
\]

\end_inset

得
\begin_inset Formula 
\[
\begin{bmatrix}\phi_{x} & \phi_{y}\end{bmatrix}=\begin{bmatrix}\phi_{\xi} & \phi_{\eta}\end{bmatrix}\underbrace{J^{-1}\begin{bmatrix}y_{\eta} & -x_{\eta}\\
-y_{\xi} & x_{\xi}
\end{bmatrix}}_{\underline{J}^{-1}},
\]

\end_inset

从而得
\begin_inset Formula 
\[
\begin{bmatrix}f_{x} & f_{y}\\
g_{x} & g_{y}
\end{bmatrix}=\begin{bmatrix}f_{\xi} & f_{\eta}\\
g_{\xi} & g_{\eta}
\end{bmatrix}\underbrace{J^{-1}\begin{bmatrix}y_{\eta} & -x_{\eta}\\
-y_{\xi} & x_{\xi}
\end{bmatrix}}_{\underline{J}^{-1}}.
\]

\end_inset

于是，通量在全局坐标下的散度为
\begin_inset Formula 
\[
\begin{aligned}f_{x}+g_{y} & =\begin{bmatrix}f_{\xi} & f_{\eta}\end{bmatrix}J^{-1}\begin{bmatrix}y_{\eta}\\
-y_{\xi}
\end{bmatrix}+\begin{bmatrix}g_{\xi} & g_{\eta}\end{bmatrix}J^{-1}\begin{bmatrix}-x_{\eta}\\
x_{\xi}
\end{bmatrix}\\
 & =\left(f_{\xi}\,y_{\eta}-f_{\eta}\,y_{\xi}-g_{\xi}\,x_{\eta}+g_{\eta}\,x_{\xi}\right)J^{-1}.
\end{aligned}
\]

\end_inset

定义局部坐标下的通量为
\begin_inset Formula 
\[
\begin{bmatrix}F\\
G
\end{bmatrix}=\begin{bmatrix}y_{\eta} & -x_{\eta}\\
-y_{\xi} & x_{\xi}
\end{bmatrix}\begin{bmatrix}f\\
g
\end{bmatrix}\equiv J\,\underline{J}^{-1}\begin{bmatrix}f\\
g
\end{bmatrix},
\]

\end_inset

即
\begin_inset Formula 
\[
F=f\,y_{\eta}-g\,x_{\eta},\quad G=-f\,y_{\xi}+g\,x_{\xi},
\]

\end_inset

则其在局部坐标下的散度为
\begin_inset Formula 
\[
\begin{aligned}F_{\xi}+G_{\eta} & =\left(f\,y_{\eta}-g\,x_{\eta}\right)_{\xi}+\left(-f\,y_{\xi}+g\,x_{\xi}\right)_{\eta}\\
\text{展开乘积之导} & =\left(f_{\xi}\,y_{\eta}+f\,y_{\eta\xi}\right)-\left(g_{\xi}\,x_{\eta}+g\,x_{\eta\xi}\right)-\left(f_{\eta}\,y_{\xi}+f\,y_{\xi\eta}\right)+\left(g_{\eta}\,x_{\xi}+g\,x_{\xi\eta}\right)\\
\text{合并二阶导数} & =\underbrace{\left(f_{\xi}\,y_{\eta}-g_{\xi}\,x_{\eta}-f_{\eta}\,y_{\xi}+g_{\eta}\,x_{\xi}\right)}_{\left(f_{x}+g_{y}\right)J}+\underbrace{\left(f\,y_{\eta\xi}-g\,x_{\eta\xi}-f\,y_{\xi\eta}+g\,x_{\xi\eta}\right)}_{0}
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Separator plain
\end_inset


\end_layout

\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Proof
上述证明可推广到三维。由导数变换公式
\begin_inset Formula 
\[
\begin{bmatrix}\phi_{\xi} & \phi_{\eta} & \phi_{\zeta}\end{bmatrix}=\begin{bmatrix}\phi_{x} & \phi_{y} & \phi_{z}\end{bmatrix}\underbrace{\begin{bmatrix}x_{\xi} & x_{\eta} & x_{\zeta}\\
y_{\xi} & y_{\eta} & y_{\zeta}\\
z_{\xi} & z_{\eta} & z_{\zeta}
\end{bmatrix}}_{\underline{J}}
\]

\end_inset

得
\begin_inset Formula 
\[
\begin{bmatrix}\phi_{x} & \phi_{y} & \phi_{z}\end{bmatrix}=\begin{bmatrix}\phi_{\xi} & \phi_{\eta} & \phi_{\zeta}\end{bmatrix}\underbrace{J^{-1}\overbrace{\begin{bmatrix}y_{\eta}\,z_{\zeta}-y_{\zeta}\,z_{\eta} & x_{\zeta}\,z_{\eta}-x_{\eta}\,z_{\zeta} & x_{\eta}\,y_{\zeta}-x_{\zeta}\,y_{\eta}\\
y_{\zeta}\,z_{\xi}-y_{\xi}\,z_{\zeta} & x_{\xi}\,z_{\zeta}-x_{\zeta}\,z_{\xi} & x_{\zeta}\,y_{\xi}-x_{\xi}\,y_{\zeta}\\
y_{\xi}\,z_{\eta}-y_{\eta}\,z_{\xi} & x_{\eta}\,z_{\xi}-x_{\xi}\,z_{\eta} & x_{\xi}\,y_{\eta}-x_{\eta}\,y_{\xi}
\end{bmatrix}}}_{\underline{J}^{-1}}^{\underline{J}^{*}},
\]

\end_inset

或
\begin_inset Formula 
\[
\begin{bmatrix}\phi_{x} & \phi_{y} & \phi_{z}\end{bmatrix}J=\begin{bmatrix}\phi_{\xi} & \phi_{\eta} & \phi_{\zeta}\end{bmatrix}\underline{J}^{*},
\]

\end_inset

从而得
\begin_inset Formula 
\[
\begin{bmatrix}f_{x} & f_{y} & f_{z}\\
g_{x} & g_{y} & g_{z}\\
h_{x} & h_{y} & h_{z}
\end{bmatrix}J=\begin{bmatrix}f_{\xi} & f_{\eta} & f_{\zeta}\\
g_{\xi} & g_{\eta} & g_{\zeta}\\
h_{\xi} & h_{\eta} & h_{\zeta}
\end{bmatrix}\underline{J}^{*},
\]

\end_inset

于是，通量在全局坐标下的散度与 
\begin_inset Formula $J$
\end_inset

 之积为
\begin_inset Formula 
\[
\left(f_{x}+g_{y}+h_{z}\right)J=\begin{bmatrix}f_{\xi} & f_{\eta} & f_{\zeta}\end{bmatrix}\underline{J}^{*}\vert1\rangle+\begin{bmatrix}g_{\xi} & g_{\eta} & g_{\zeta}\end{bmatrix}\underline{J}^{*}\vert2\rangle+\begin{bmatrix}h_{\xi} & h_{\eta} & h_{\zeta}\end{bmatrix}\underline{J}^{*}\vert3\rangle,
\]

\end_inset

其中 
\begin_inset Formula $\underline{J}^{*}\vert c\rangle$
\end_inset

 表示取 
\begin_inset Formula $\underline{J}^{*}$
\end_inset

 的第 
\begin_inset Formula $c$
\end_inset

 列。
\end_layout

\begin_layout Proof
定义局部坐标下的通量为
\begin_inset Formula 
\[
\begin{bmatrix}F\\
G\\
H
\end{bmatrix}=\underline{J}^{*}\begin{bmatrix}f\\
g\\
h
\end{bmatrix}\equiv\begin{bmatrix}y_{\eta}\,z_{\zeta}-y_{\zeta}\,z_{\eta} & x_{\zeta}\,z_{\eta}-x_{\eta}\,z_{\zeta} & x_{\eta}\,y_{\zeta}-x_{\zeta}\,y_{\eta}\\
y_{\zeta}\,z_{\xi}-y_{\xi}\,z_{\zeta} & x_{\xi}\,z_{\zeta}-x_{\zeta}\,z_{\xi} & x_{\zeta}\,y_{\xi}-x_{\xi}\,y_{\zeta}\\
y_{\xi}\,z_{\eta}-y_{\eta}\,z_{\xi} & x_{\eta}\,z_{\xi}-x_{\xi}\,z_{\eta} & x_{\xi}\,y_{\eta}-x_{\eta}\,y_{\xi}
\end{bmatrix}\begin{bmatrix}f\\
g\\
h
\end{bmatrix},
\]

\end_inset

则其在局部坐标下的散度为
\begin_inset Formula 
\[
\begin{aligned}F_{\xi}+G_{\eta}+H_{\zeta} & =\left(\langle1\vert\underline{J}^{*}\vert1\rangle\,f+\langle1\vert\underline{J}^{*}\vert2\rangle\,g+\langle1\vert\underline{J}^{*}\vert3\rangle\,h\right)_{\xi}\\
 & +\left(\langle2\vert\underline{J}^{*}\vert1\rangle\,f+\langle2\vert\underline{J}^{*}\vert2\rangle\,g+\langle2\vert\underline{J}^{*}\vert3\rangle\,h\right)_{\eta}\\
 & +\left(\langle3\vert\underline{J}^{*}\vert1\rangle\,f+\langle3\vert\underline{J}^{*}\vert2\rangle\,g+\langle3\vert\underline{J}^{*}\vert3\rangle\,h\right)_{\zeta},
\end{aligned}
\]

\end_inset

其中 
\begin_inset Formula $\langle r\vert\underline{J}^{*}\vert c\rangle$
\end_inset

 表示取 
\begin_inset Formula $\underline{J}^{*}$
\end_inset

 的第 
\begin_inset Formula $r$
\end_inset

 行、第 
\begin_inset Formula $c$
\end_inset

 列。按 
\begin_inset Formula $f,g,h$
\end_inset

 分行，即
\begin_inset Formula 
\[
\begin{aligned}F_{\xi}+G_{\eta}+H_{\zeta} & =\left(\langle1\vert\underline{J}^{*}\vert1\rangle\,f\right)_{\xi}+\left(\langle2\vert\underline{J}^{*}\vert1\rangle\,f\right)_{\eta}+\left(\langle3\vert\underline{J}^{*}\vert1\rangle\,f\right)_{\zeta}\\
 & +\left(\langle1\vert\underline{J}^{*}\vert2\rangle\,g\right)_{\xi}+\left(\langle2\vert\underline{J}^{*}\vert2\rangle\,g\right)_{\eta}+\left(\langle3\vert\underline{J}^{*}\vert2\rangle\,g\right)_{\zeta}\\
 & +\left(\langle1\vert\underline{J}^{*}\vert3\rangle\,h\right)_{\xi}+\left(\langle2\vert\underline{J}^{*}\vert3\rangle\,h\right)_{\eta}+\left(\langle3\vert\underline{J}^{*}\vert3\rangle\,h\right)_{\zeta}.
\end{aligned}
\]

\end_inset

分别考虑一阶导数与二阶导数。
\begin_inset Formula 
\[
\begin{aligned}\sum\text{不含二阶导数的项} & =\underbrace{\langle1\vert\underline{J}^{*}\vert1\rangle\,f_{\xi}+\langle2\vert\underline{J}^{*}\vert1\rangle\,f_{\eta}+\langle3\vert\underline{J}^{*}\vert1\rangle\,f_{\zeta}}_{\begin{bmatrix}f_{\xi} & f_{\eta} & f_{\zeta}\end{bmatrix}\underline{J}^{*}\vert1\rangle}\\
 & +\underbrace{\langle1\vert\underline{J}^{*}\vert2\rangle\,g_{\xi}+\langle2\vert\underline{J}^{*}\vert2\rangle\,g_{\eta}+\langle3\vert\underline{J}^{*}\vert2\rangle\,g_{\zeta}}_{\begin{bmatrix}f_{\xi} & f_{\eta} & f_{\zeta}\end{bmatrix}\underline{J}^{*}\vert2\rangle}\\
 & +\underbrace{\langle1\vert\underline{J}^{*}\vert3\rangle\,h_{\xi}+\langle2\vert\underline{J}^{*}\vert3\rangle\,h_{\eta}+\langle3\vert\underline{J}^{*}\vert3\rangle\,h_{\zeta}}_{\begin{bmatrix}h_{\xi} & h_{\eta} & h_{\zeta}\end{bmatrix}\underline{J}^{*}\vert3\rangle}\\
 & =\left(f_{x}+g_{y}+h_{z}\right)J.
\end{aligned}
\]

\end_inset

于是，只需证明剩余项之和为零。
\begin_inset Formula 
\[
\begin{aligned}\sum\text{含二阶导数的项} & =\left(\langle1\vert\underline{J}^{*}\vert1\rangle_{\xi}+\langle2\vert\underline{J}^{*}\vert1\rangle_{\eta}+\langle3\vert\underline{J}^{*}\vert1\rangle_{\zeta}\right)f\\
 & +\left(\langle1\vert\underline{J}^{*}\vert2\rangle_{\xi}+\langle2\vert\underline{J}^{*}\vert2\rangle_{\eta}+\langle3\vert\underline{J}^{*}\vert2\rangle_{\zeta}\right)g\\
 & +\left(\langle1\vert\underline{J}^{*}\vert3\rangle_{\xi}+\langle2\vert\underline{J}^{*}\vert3\rangle_{\eta}+\langle3\vert\underline{J}^{*}\vert3\rangle_{\zeta}\right)h.
\end{aligned}
\]

\end_inset

注意到 
\begin_inset Formula $f,g,h$
\end_inset

 的系数分别等于
\begin_inset Formula 
\[
\det\begin{bmatrix}\partial_{\xi} & \partial_{\eta} & \partial_{\zeta}\\
y_{\xi} & y_{\eta} & y_{\zeta}\\
z_{\xi} & z_{\eta} & z_{\zeta}
\end{bmatrix},\quad\det\begin{bmatrix}\partial_{\xi} & \partial_{\eta} & \partial_{\zeta}\\
z_{\xi} & z_{\eta} & z_{\zeta}\\
x_{\xi} & x_{\eta} & x_{\zeta}
\end{bmatrix},\quad\det\begin{bmatrix}\partial_{\xi} & \partial_{\eta} & \partial_{\zeta}\\
x_{\xi} & x_{\eta} & x_{\zeta}\\
y_{\xi} & y_{\eta} & y_{\zeta}
\end{bmatrix},
\]

\end_inset

三者在形式上相同，故只需证明其中之一为零。考虑 
\begin_inset Formula $f$
\end_inset

 的系数
\begin_inset Formula 
\[
\left(y_{\eta}\,z_{\zeta}-y_{\zeta}\,z_{\eta}\right)_{\xi}+\left(y_{\zeta}\,z_{\xi}-y_{\xi}\,z_{\zeta}\right)_{\eta}+\left(y_{\xi}\,z_{\eta}-y_{\eta}\,z_{\xi}\right)_{\zeta},
\]

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
展开乘积之导，得
\begin_inset Formula 
\[
\begin{aligned}\left(y_{\eta}\,z_{\zeta}-y_{\zeta}\,z_{\eta}\right)_{\xi} & =y_{\eta\xi}\,z_{\zeta}-y_{\zeta\xi}\,z_{\eta}+y_{\eta}\,z_{\zeta\xi}-y_{\zeta}\,z_{\eta\xi},\\
\left(y_{\zeta}\,z_{\xi}-y_{\xi}\,z_{\zeta}\right)_{\eta} & =y_{\zeta\eta}\,z_{\xi}-y_{\xi\eta}\,z_{\zeta}+y_{\zeta}\,z_{\xi\eta}-y_{\xi}\,z_{\zeta\eta},\\
\left(y_{\xi}\,z_{\eta}-y_{\eta}\,z_{\xi}\right)_{\zeta} & =y_{\xi\zeta}\,z_{\eta}-y_{\eta\zeta}\,z_{\xi}+y_{\xi}\,z_{\eta\zeta}-y_{\eta}\,z_{\xi\zeta}.
\end{aligned}
\]

\end_inset

利用交叉导数相等，可得三行之和为零。
\end_layout

\begin_layout Plain Layout
\begin_inset Separator plain
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
局部坐标下的标量函数 
\begin_inset Formula $U,F,G$
\end_inset

 可以由标准三角形 
\begin_inset Formula $T$
\end_inset

 上的 
\begin_inset Formula $p$
\end_inset

-次 Lagrange 插值多项式来近似：
\begin_inset Formula 
\[
\begin{bmatrix}U(\vec{\rho})\\
F(\vec{\rho})\\
G(\vec{\rho})
\end{bmatrix}\approx\begin{bmatrix}U^{\delta D}(\vec{\rho})\\
F^{\delta D}(\vec{\rho})\\
G^{\delta D}(\vec{\rho})
\end{bmatrix}=\sum_{i=1}^{N_{T}(p)}\begin{bmatrix}U_{i}^{\delta D}\\
F_{i}^{\delta D}\\
G_{i}^{\delta D}
\end{bmatrix}l_{i}(\vec{\rho}),
\]

\end_inset

其中 
\begin_inset Formula $N_{T}(p)\equiv\binom{p+2}{2}$
\end_inset

 为内部取值点个数，上标中的 
\begin_inset Formula $D$
\end_inset

 表示间断。于是，间断通量的散度可表示为
\begin_inset Formula 
\[
\partial_{\vec{\rho}}\vdot\vec{F}^{\delta D}\equiv\partial_{\xi}\,F^{\delta D}+\partial_{\eta}\,G^{\delta D}\approx\sum_{i=1}^{N_{T}(p)}\left(F_{i}^{\delta D}\frac{\partial l_{i}(\vec{\rho})}{\partial\xi}+G_{i}^{\delta D}\frac{\partial l_{i}(\vec{\rho})}{\partial\eta}\right).
\]

\end_inset

定义局部坐标下的修正通量
\begin_inset Formula 
\[
\vec{F}^{\delta C}(\vec{\rho})=\sum_{j=1}^{N_{\partial T}(p)}[F_{\nu}]_{j}\,\vec{\varphi}_{j}(\vec{\rho}),
\]

\end_inset

其中
\end_layout

\begin_layout Itemize
\begin_inset Formula $N_{\partial T}(p)$
\end_inset

 为边界取值点总数；
\end_layout

\begin_layout Itemize
\begin_inset Formula $[F_{\nu}]\coloneqq F_{\nu}^{\delta I}-\vec{\nu}\vdot\vec{F}^{\delta D}$
\end_inset

 为通量阶跃值；
\end_layout

\begin_layout Itemize
向量修正函数 
\begin_inset Formula $\vec{\varphi}_{j}$
\end_inset

 取自 Raviart–Thomas 空间：
\begin_inset Formula 
\[
\begin{aligned}\mathbb{RT}_{p}(T) & \coloneqq\left(\mathbb{P}_{p}(T)\right)^{2}+\vec{\rho}\,\mathbb{P}_{p}(T)\\
 & =\left\{ \begin{bmatrix}f(\xi,\eta)\\
g(\xi,\eta)
\end{bmatrix}+\begin{bmatrix}\xi\\
\eta
\end{bmatrix}h(\xi,\eta):(f,g,h)\in\left(\mathbb{P}_{p}(T)\right)^{3}\right\} 
\end{aligned}
\]

\end_inset

从而有
\begin_inset Formula 
\[
\partial_{\vec{\rho}}\vdot\vec{\varphi}_{j}\in\mathbb{P}_{p}(T)\impliedby\mathbb{RT}_{p}(T)\subset\left(\mathbb{P}_{p+1}(T)\right)^{2}
\]

\end_inset


\begin_inset Formula 
\[
\vec{\nu}\vdot\vec{\varphi}_{j}|_{\partial T}\in\mathbb{R}_{p}(\partial T)\equiv\left\{ f:\left(f\in L_{2}(\partial T)\right)\land\left(f|_{\Gamma_{e}}\in\mathbb{P}_{p}(\Gamma_{e}),\forall e\right)\right\} ,
\]

\end_inset

除此之外，
\begin_inset Formula $\vec{\varphi}_{j}$
\end_inset

 还应有 Kronecker delta 性质：
\begin_inset Formula 
\[
\vec{\varphi}_{j}(\vec{\rho}_{k})\vdot\vec{\nu}(\vec{\rho}_{k})=\delta_{jk}.
\]

\end_inset


\end_layout

\begin_layout Standard
由此得近似通量在边界求值点上的值：
\begin_inset Formula 
\[
\vec{F}^{\delta C}(\vec{\rho}_{j})\vdot\vec{\nu}(\vec{\rho}_{j})=[F_{\nu}]_{j},\quad\vec{F}^{\delta}(\vec{\rho}_{j})=F_{\nu}^{\delta I}(\vec{\rho}_{j}).
\]

\end_inset


\end_layout

\begin_layout Standard
将
\begin_inset Formula 
\[
U(\vec{\rho})\approx U^{\delta D}(\vec{\rho})=\sum_{i=1}^{N_{T}(p)}U_{i}^{\delta D}\,l_{i}(\vec{\rho})
\]

\end_inset

及
\begin_inset Formula 
\[
\vec{F}(\vec{\rho})\approx\vec{F}^{\delta}(\vec{\rho})=\vec{F}^{\delta D}(\vec{\rho})+\vec{F}^{\delta C}(\vec{\rho})=\left(\sum_{i=1}^{N_{T}(p)}\vec{F}_{i}^{\delta D}\,l_{i}(\vec{\rho})\right)+\left(\sum_{j=1}^{N_{\partial T}(p)}[F_{\nu}]_{j}\,\vec{\varphi}_{j}(\vec{\rho})\right)
\]

\end_inset

代入 
\begin_inset Formula $\vec{\rho}_{k}$
\end_inset

 点的守恒律
\begin_inset Formula 
\[
\partial_{t}\,U^{\delta D}(\vec{\rho}_{k})+\partial_{\vec{\rho}}\vdot\vec{F}^{\delta}(\vec{\rho}_{k})=0,
\]

\end_inset

并利用 
\begin_inset Formula $l_{i}(\vec{\rho}_{k})=\delta_{ik}$
\end_inset

，得半离散 FR 格式：
\begin_inset Formula 
\[
\begin{aligned}\dv{U_{k}^{\delta D}}{t} & =-\sum_{i=1}^{N_{T}(p)}\left(F_{i}^{\delta D}\frac{\partial l_{i}(\vec{\rho}_{k})}{\partial\xi}+G_{i}^{\delta D}\frac{\partial l_{i}(\vec{\rho}_{k})}{\partial\eta}\right)\\
 & -\sum_{j=1}^{N_{\partial T}(p)}[F_{\nu}]_{j}\,\underbrace{\partial_{\vec{\rho}}\vdot\vec{\varphi}_{j}}_{\phi_{j}}(\vec{\rho}_{k}),\quad k=1,\dots,N_{T}(p).
\end{aligned}
\]

\end_inset

上述 FR 格式的具体形式，取决于
\end_layout

\begin_layout Itemize
单元内部求值点 
\begin_inset Formula $\left\{ \vec{\rho}_{k}\right\} _{k=1}^{N_{T}(p)}$
\end_inset

 的分布。
\end_layout

\begin_layout Itemize
单元边界求值点 
\begin_inset Formula $\left\{ \vec{\rho}_{j}\right\} _{j=1}^{N_{\partial T}(p)}$
\end_inset

 的分布。
\end_layout

\begin_layout Itemize
向量修正函数 
\begin_inset Formula $\left\{ \vec{\varphi}_{j}\right\} _{j=1}^{N_{\partial T}(p)}$
\end_inset

 或标量修正场 
\begin_inset Formula $\left\{ \phi_{j}\equiv\partial_{\vec{\rho}}\vdot\vec{\varphi}_{j}\right\} _{j=1}^{N_{\partial T}(p)}$
\end_inset

 的选取。
\end_layout

\begin_layout Itemize
法向数值通量 
\begin_inset Formula $F_{\nu}$
\end_inset

 的构造。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Section
DG vs.
 FR
\end_layout

\begin_layout Subsection
空间离散
\end_layout

\begin_layout Standard
为求解线性标量守恒律
\begin_inset Formula 
\[
\frac{\partial u}{\partial t}+\frac{\partial f(u)}{\partial x}=0,\quad f(u)=au,\quad a>0,
\]

\end_inset

在单元 
\begin_inset Formula $E_{j}$
\end_inset

 上引入解的多项式近似
\begin_inset Formula 
\[
u^{h}(x,t)=\sum_{k=1}^{N}\hat{u}_{k}(t)\,b_{k}(x),\quad\Span\left\{ b_{k}\right\} _{k=1}^{N}=\mathbb{P}_{N-1},
\]

\end_inset

及相应的近似通量
\begin_inset Formula 
\[
f^{h}(x,t)\coloneqq f(u^{h})=a\sum_{k=1}^{N}\hat{u}_{k}(t)\,b_{k}(x)=\sum_{j=1}^{N}\underbrace{a\hat{u}_{k}(t)}_{\hat{f}_{k}(t)}\,b_{k}(x).
\]

\end_inset

因其在定义单元界面处间断，可记为
\begin_inset Formula 
\[
f^{h}(x,t)\eqqcolon f^{\mathrm{D}}(x,t).
\]

\end_inset


\end_layout

\begin_layout Subsubsection
DG
\end_layout

\begin_layout Standard
借用 
\begin_inset Formula $u^{h}$
\end_inset

 的同一组基，定义近似 test 函数
\begin_inset Formula 
\[
w^{h}(x)=\sum_{l=1}^{N}\hat{w}_{l}\,b_{l}(x)\in\mathbb{P}_{N-1}(E_{j}),
\]

\end_inset

代入 weak form
\begin_inset Formula 
\[
\ip{w^{h}}{\partial_{t}\,u^{h}}_{E_{j}}+\ip{w^{h}}{n_{x}\,f^{\mathrm{U}}}_{\partial E_{j}}=\ip{\partial_{x}\,w^{h}}{f^{\mathrm{D}}}_{E_{j}},
\]

\end_inset

其中 
\begin_inset Formula $f^{\mathrm{U}}$
\end_inset

 为迎风 (Upwind) 通量。利用 
\begin_inset Formula $\left\{ \hat{w}_{l}\right\} _{l=1}^{N}$
\end_inset

 的任意性，可得 
\begin_inset Formula $N$
\end_inset

 个 ODEs：
\begin_inset Formula 
\[
\ip{b_{l}}{b_{k}}_{E_{j}}\frac{\dd\hat{u}_{k}}{\dd t}=\ip{\partial_{x}\,b_{l}}{f^{\mathrm{D}}}_{E_{j}}-\ip{b_{l}}{n_{x}\,f^{\mathrm{U}}}_{\partial E_{j}},\quad l=1,\dots,N.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
FR
\end_layout

\begin_layout Standard
借用 DG 的多项式近似
\begin_inset Formula 
\[
u^{h}(x,t)=\sum_{k=1}^{N}\hat{u}_{k}(t)\,b_{k}(x),\quad f^{\mathrm{D}}(x,t)=\sum_{k=1}^{N}\hat{f}_{k}(t)\,b_{k}(x),
\]

\end_inset

定义通量修正 (Correction) 函数
\begin_inset Formula 
\[
f^{\mathrm{C}}(x(\xi),t)\coloneqq\sum_{\zeta=\pm1}\left(f^{\mathrm{U}}(x(\zeta),t)-f^{\mathrm{D}}(x(\zeta),t)\right)g_{\zeta}(\xi)\text{,}
\]

\end_inset

其中 
\begin_inset Formula $g_{\pm1}\in\mathbb{P}_{N}([-1,+1])$
\end_inset

 且
\begin_inset Formula 
\[
g_{-1}(-1)=g_{+1}(+1)=1,\quad g_{-1}(+1)=g_{+1}(-1)=0,
\]

\end_inset

可以重构 (Reconstruct) 出连续通量
\begin_inset Formula 
\[
f^{\mathrm{R}}(x,t)=f^{\mathrm{D}}(x,t)+f^{\mathrm{C}}(x,t)\in\mathbb{P}_{N}(E_{j}),
\]

\end_inset

则原 PDE 可近似为
\begin_inset Formula 
\[
\frac{\partial u^{h}}{\partial t}+\frac{\partial f^{\mathrm{R}}}{\partial x}\approx\frac{\partial u}{\partial t}+\frac{\partial f}{\partial x}=0,
\]

\end_inset

在 
\begin_inset Formula $N$
\end_inset

 个 Lagrange 结点处取值，可得 
\begin_inset Formula $N$
\end_inset

 个 ODEs：
\begin_inset Formula 
\[
\frac{\dd\hat{u}_{k}(t)}{\dd t}=-\frac{\partial f^{\mathrm{R}}(x_{k},t)}{\partial x},\quad k=1,\dots,N.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
DG-with-FR
\end_layout

\begin_layout Standard
借用 DG 的多项式近似
\begin_inset Formula 
\[
u^{h}(x,t)=\sum_{k=1}^{N}\hat{u}_{k}(t)\,b_{k}(x),\quad f^{\mathrm{D}}(x,t)=\sum_{k=1}^{N}\hat{f}_{k}(t)\,b_{k}(x),\quad w^{h}=w^{h}(x)=\sum_{l=1}^{N}\hat{w}_{l}\,b_{l}(x),
\]

\end_inset

及 FR 的重构通量
\begin_inset Formula 
\[
f^{\mathrm{R}}(x,t)=f^{\mathrm{D}}(x,t)+f^{\mathrm{C}}(x,t),
\]

\end_inset

代入积分式
\begin_inset Formula 
\[
\ip{w^{h}}{\partial_{t}\,u^{h}+\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}=0,
\]

\end_inset

利用 
\begin_inset Formula $\hat{w}_{l}$
\end_inset

 的任意性、
\begin_inset Formula $\hat{u}_{k}$
\end_inset

 的空间无关性，得 
\begin_inset Formula $N$
\end_inset

 个常微分方程：
\begin_inset Formula 
\[
\ip{b_{l}}{b_{k}}\frac{\dd\hat{u}_{k}}{\dd t}=-\ip{b_{l}}{\partial_{x}\,f^{\mathrm{R}}},\quad l=1,\dots,N,
\]

\end_inset

即
\begin_inset Formula 
\[
\underbrace{\begin{bmatrix}\ip{b_{1}}{b_{1}} & \cdots & \ip{b_{1}}{b_{N}}\\
\vdots & \ddots & \vdots\\
\ip{b_{N}}{b_{1}} & \cdots & \ip{b_{N}}{b_{N}}
\end{bmatrix}}_{=\ip{\underline{b}}{\underline{b}^{\mathrm{T}}}\eqqcolon\underline{m}}\frac{\dd}{\dd t}\underbrace{\begin{bmatrix}\hat{u}_{1}\\
\vdots\\
\hat{u}_{N}
\end{bmatrix}}_{\underline{\hat{u}}}=\underbrace{\begin{bmatrix}-\ip{b_{1}}{\partial_{x}\,f^{\mathrm{R}}}\\
\vdots\\
-\ip{b_{N}}{\partial_{x}\,f^{\mathrm{R}}}
\end{bmatrix}}_{=-\ip{\underline{b}}{\partial_{x}\,f^{\mathrm{R}}}\eqqcolon\underline{r}},
\]

\end_inset

其中 
\begin_inset Formula $\underline{b}\coloneqq\begin{bmatrix}b_{1} & \cdots & b_{N}\end{bmatrix}^{\mathrm{T}}$
\end_inset

.
\end_layout

\begin_layout Subsection
修正波数
\end_layout

\begin_layout Standard
上述所有格式都是线性的，可以统一为
\begin_inset Formula 
\[
\frac{\dd}{\dd t}\underline{\hat{u}}_{j}=\underline{r}_{j}\qty(\underline{\hat{u}}_{j},\underline{\hat{u}}_{j-1},\underline{\hat{u}}_{j+1})=\underline{S}_{j}\,\underline{\hat{u}}_{j}+\underline{S}_{j-1}\,\underline{\hat{u}}_{j-1}+\underline{S}_{j+1}\,\underline{\hat{u}}_{j+1},
\]

\end_inset

其中 
\begin_inset Formula $\underline{S}_{j},\underline{S}_{j-1},\underline{S}_{j+1}$
\end_inset

 为实常值矩阵，且可以数值地构造：遍历 
\begin_inset Formula $k=1,\dots,N$
\end_inset

，依次取
\begin_inset Formula 
\[
\underline{S}_{j}\vert k\rangle=\underline{r}_{j}\qty(\vert k\rangle,\vert0\rangle,\vert0\rangle),\quad\underline{S}_{j-1}\vert k\rangle=\underline{r}_{j}\qty(\vert0\rangle,\vert k\rangle,\vert0\rangle),\quad\underline{S}_{j+1}\vert k\rangle=\underline{r}_{j}\qty(\vert0\rangle,\vert0\rangle,\vert k\rangle).
\]

\end_inset

若网格均匀，且基函数 
\begin_inset Formula $\underline{b}_{j}$
\end_inset

 在相对坐标下具有相同的形式，则 
\begin_inset Formula $\underline{S}_{j},\underline{S}_{j-1},\underline{S}_{j+1}$
\end_inset

 对所有单元相同。
\end_layout

\begin_layout Standard
若初值为 
\begin_inset Formula $u(x,t=0)=\exp(\ii\kappa x)$
\end_inset

，则均匀网格 
\begin_inset Formula $x_{j}=jh$
\end_inset

 上的许可解为
\begin_inset Formula 
\[
\underline{\hat{u}}_{j}(t)=\underline{\tilde{u}}\exp(\ii\kappa jh-\ii\omega t)\implies\underline{\hat{u}}_{j-1}(t)=\underline{\hat{u}}_{j}(t)\exp(-\ii\kappa h),
\]

\end_inset

因此有
\begin_inset Formula 
\[
\frac{\dd}{\dd t}\underline{\hat{u}}_{j}=\underline{S}\,\underline{\hat{u}}_{j},\quad\underline{S}(\kappa h)\coloneqq\underline{S}_{j}+\underline{S}_{j-1}\exp(-\ii\kappa h)+\underline{S}_{j+1}\exp(+\ii\kappa h),
\]

\end_inset

其中 
\begin_inset Formula $\underline{S}$
\end_inset

 为复常值矩阵，均匀网格上不依赖于 
\begin_inset Formula $j$
\end_inset

，而只依赖于无量纲波数 
\begin_inset Formula $\kappa h$
\end_inset

。因 
\begin_inset Formula $\underline{S}$
\end_inset

 对 
\begin_inset Formula $\kappa h$
\end_inset

 具有周期性
\begin_inset Formula 
\[
\underline{S}(\kappa h)=\underline{S}(\kappa h+m2\mathrm{\pi}),\quad\forall m\in\mathbb{Z},
\]

\end_inset

故只需考虑 
\begin_inset Formula $\kappa h$
\end_inset

 在 
\begin_inset Formula $[-\mathrm{\pi},\mathrm{\pi}]$
\end_inset

 内取值。
\end_layout

\begin_layout Standard
特征值问题
\begin_inset Formula 
\[
-\ii\omega\,\underline{\tilde{u}}=\underline{S}\,\underline{\tilde{u}}\impliedby\begin{cases}
\frac{\dd}{\dd t}\underline{\hat{u}}_{j}=\underline{S}\,\underline{\hat{u}}_{j}\\
\underline{\hat{u}}_{j}(t)=\underline{\tilde{u}}\exp(\ii\kappa jh-\ii\omega t)
\end{cases}
\]

\end_inset

的解（修正波数 
\begin_inset Formula $\omega/a\eqqcolon\tilde{\kappa}$
\end_inset

）体现了空间离散格式的色散、耗散特性。解之得 
\begin_inset Formula $N$
\end_inset

 个模态 
\begin_inset Formula $\left\{ \left(\omega_{l},\underline{\tilde{u}}_{l}\right)\right\} _{l=1}^{N}$
\end_inset

，实际解是这 
\begin_inset Formula $N$
\end_inset

 个模态的叠加：
\begin_inset Formula 
\[
\underline{\hat{u}}_{j}(t)=\sum_{l=1}^{N}C_{l}\,\underline{\tilde{u}}_{l}\exp(\ii\kappa jh-\ii\omega_{l}t),
\]

\end_inset

其中 
\begin_inset Formula $C_{l}$
\end_inset

 由初始条件决定：
\begin_inset Formula 
\[
\underline{\hat{u}}_{j}(0)=\sum_{l=1}^{N}C_{l}\,\underline{\tilde{u}}_{l}\exp(\ii\kappa jh),\quad\hat{u}_{j,k}(0)=\begin{cases}
\exp(\ii\kappa x_{j,k}), & \text{Lagrange basis}\\
\dfrac{\ip{b_{k}}{\exp(\ii\kappa x)}}{\ip{b_{k}}{b_{k}}}, & \text{Legendre basis}
\end{cases}
\]

\end_inset


\end_layout

\begin_layout Subsubsection
物理模态与寄生模态
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Hu_1999"
literal "true"

\end_inset

 定义：在 
\begin_inset Formula $[-N\mathrm{\pi},+N\mathrm{\pi}]$
\end_inset

 内满足 
\begin_inset Formula $\omega_{l}\approx\kappa a$
\end_inset

 的那个模态为物理模态，其余为寄生模态。
\end_layout

\begin_layout Quote
The numerical solution (3.9) is a superposition of 
\begin_inset Formula $N$
\end_inset

 waves traveling at different phase speeds.
 We define the physical mode as one with the frequency that approximates
 the exact dispersion relation for a range of wave numbers.
 The others are the parasite modes associated with the numerical scheme.
 — 
\begin_inset CommandInset citation
LatexCommand citet
key "Hu_1999"
literal "true"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Subsubsection
基准波数与真实波数
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Helenbrook_2006"
literal "false"

\end_inset

 指出：寄生模态的 
\begin_inset Formula $\tilde{\kappa}h$
\end_inset

–
\begin_inset Formula $\kappa h$
\end_inset

 曲线，可以由物理模态的 
\begin_inset Formula $\tilde{\kappa}h$
\end_inset

–
\begin_inset Formula $\kappa h$
\end_inset

 曲线沿 
\begin_inset Formula $\kappa h$
\end_inset

 轴平移 
\begin_inset Formula $2\mathrm{\pi}$
\end_inset

 的整数倍而得到。在 
\begin_inset Formula $[(m-1)\mathrm{\pi},m\mathrm{\pi}]$
\end_inset

 内取 
\begin_inset Formula $\kappa h$
\end_inset

，将所得的 
\begin_inset Formula $\left\{ (\tilde{\kappa}h)_{l}\right\} _{l=1}^{N}$
\end_inset

 按模由小到大排序，其中排第 
\begin_inset Formula $m$
\end_inset

 的为物理模态。
\end_layout

\begin_layout Quote
We also have unrolled the 
\begin_inset Formula $p+1$
\end_inset

 eigenvalues in 
\begin_inset Formula $\theta$
\end_inset

; at any value of 
\begin_inset Formula $\theta$
\end_inset

 we have 
\begin_inset Formula $p+1$
\end_inset

 eigenvalues.
 The larger eigenvalues correspond physically to eigenfunctions with a wave
 number that is shifted by an integer multiple of 
\begin_inset Formula $2\mathrm{\pi}$
\end_inset

 from 
\begin_inset Formula $\theta$
\end_inset

.
 We order the eigenvalues by magnitude and then assign the eigenvalues to
 the expanded domain 
\begin_inset Formula $[0,(p+1)\mathrm{\pi}]$
\end_inset

.
 — 
\begin_inset CommandInset citation
LatexCommand citet
key "Helenbrook_2006"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Vincent_2011"
literal "true"

\end_inset

 给出一种方法，将每个模态都关联到 
\begin_inset Formula $[-N\mathrm{\pi},+N\mathrm{\pi}]$
\end_inset

 内的 true wavenumber 
\begin_inset Formula $\kappa h$
\end_inset

：在 
\begin_inset Formula $[-\mathrm{\pi},+\mathrm{\pi}]$
\end_inset

 内取充分多 baseline wavenumbers，对每个这样的 
\begin_inset Formula $\bar{\kappa}h$
\end_inset

：
\end_layout

\begin_layout Itemize
计算相应的 
\begin_inset Formula $\underline{S}$
\end_inset

 及 
\begin_inset Formula $\left\{ \left(\omega_{l},\underline{\tilde{u}}_{l}\right)\right\} _{l=1}^{N}$
\end_inset

，将每个 
\begin_inset Formula $\underline{\tilde{u}}_{l}$
\end_inset

 所表示的多项式在 Legendre 基上投影。
\end_layout

\begin_layout Itemize
假设已确定 
\begin_inset Formula $m$
\end_inset

 个模态所对应的 true wavenumbers 
\begin_inset Formula $\left\{ (\kappa h)_{l}\right\} _{l=1}^{m}$
\end_inset

，在第 
\begin_inset Formula $m+1$
\end_inset

 步：
\end_layout

\begin_deeper
\begin_layout Itemize
在剩余 
\begin_inset Formula $N-m$
\end_inset

 个模态中，寻找在第 
\begin_inset Formula $m+1$
\end_inset

 个 Legendre 基（
\begin_inset Formula $m$
\end_inset

 次 Legendre 多项式）上能量最大的一个。
\end_layout

\begin_layout Itemize
为其寻找 
\begin_inset Formula $n\in\mathbb{Z}$
\end_inset

，使得 
\begin_inset Formula $\vert\bar{\kappa}h+n2\mathrm{\pi}\vert$
\end_inset

 最小，且 
\begin_inset Formula $n$
\end_inset

 不曾被前 
\begin_inset Formula $m$
\end_inset

 个模态用过。以 
\begin_inset Formula $\bar{\kappa}h+n2\mathrm{\pi}$
\end_inset

 为第 
\begin_inset Formula $m+1$
\end_inset

 个 true wavenumber。
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
若 
\begin_inset Formula $E_{j}$
\end_inset

 非边界单元，则 
\begin_inset Formula $\bar{\kappa}h$
\end_inset

 可取 
\begin_inset Formula $[-\mathrm{\pi},\mathrm{\pi}]$
\end_inset

 内的任意值；否则只能考虑 
\begin_inset Formula $[-L,L]$
\end_inset

 内的周期解，即 
\begin_inset Formula $\bar{\kappa}h$
\end_inset

 只能取如下离散值：
\begin_inset Formula 
\[
\bar{k}\in\mathbb{Z}\cap\left[-\frac{N_{E}}{2},\frac{N_{E}}{2}\right]\impliedby\begin{cases}
\bar{\kappa}h\in[-\mathrm{\pi},\mathrm{\pi}]\\
\bar{\kappa}L/\mathrm{\pi}\eqqcolon\bar{k}\in\mathbb{Z}\\
h\coloneqq2L/N_{E}
\end{cases}
\]

\end_inset


\end_layout

\begin_layout Subsubsection
时域分析与空间分析
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Hu_2002,Mengaldo_2018"
literal "true"

\end_inset

 注意到特征值问题
\begin_inset Formula 
\[
(\tilde{\kappa}h)\,\frac{a}{\ii h}\,\underline{\tilde{u}}=\underline{S}(\kappa h)\,\underline{\tilde{u}}
\]

\end_inset

的自变量、应变量地位对等，故定义：
\end_layout

\begin_layout Itemize
以 
\begin_inset Formula $\kappa h$
\end_inset

 为实自变量，
\begin_inset Formula $\tilde{\kappa}h$
\end_inset

 为复应变量的分析为时域分析，每个 
\begin_inset Formula $\kappa h$
\end_inset

 对应 
\begin_inset Formula $N$
\end_inset

 个 
\begin_inset Formula $\tilde{\kappa}h$
\end_inset

。该方法只适用于均匀网格。
\end_layout

\begin_layout Itemize
以 
\begin_inset Formula $\tilde{\kappa}h$
\end_inset

 为实自变量，
\begin_inset Formula $\kappa h$
\end_inset

 为复应变量的分析为空间分析，每个 
\begin_inset Formula $\tilde{\kappa}h$
\end_inset

 对应 2 个 
\begin_inset Formula $\kappa h$
\end_inset

。该方法适用于非均匀网格。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Subsubsection
DFT
\end_layout

\begin_layout Standard
在全局取 
\begin_inset Formula $n=10N_{E}$
\end_inset

 个均布采样点，比较 
\begin_inset Formula $u^{h}(x,t)$
\end_inset

 在 
\begin_inset Formula $t=0$
\end_inset

 与 
\begin_inset Formula $t=\tau$
\end_inset

 的 DFT 系数：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\tilde{\kappa}h\coloneqq\frac{\ii h}{a\tau}\ln\frac{\hat{u}_{k}^{h}(t=\tau)}{\hat{u}_{k}^{h}(t=0)}=\frac{\ii h}{a\tau}\ln\frac{\sum_{j=0}^{n-1}u^{h}(x_{j},t=\tau)\,w^{-jk}}{\sum_{j=0}^{n-1}u^{h}(x_{j},t=0)\,w^{-jk}},\quad w\coloneqq\exp(\ii\frac{2\mathrm{\pi}}{n}).
\]

\end_inset


\end_layout

\begin_layout Subsubsection
CFL
\end_layout

\begin_layout Standard
The DG-with-FR in the last column uses an insufficient quadrature.
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $p$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset citation
LatexCommand citet
key "Cockburn_2001"
literal "true"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
FR (
\begin_inset Formula $g\perp\mathbb{P}_{N-2}$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
FR (
\begin_inset Formula $g\perp\mathbb{P}_{N-3}$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DG with FR
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.256$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.362$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.409$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.413$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.17$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.209$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.229$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.46$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.41$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.130$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.132$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.26$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.23$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.089$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.097$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.17$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.13$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.066$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.068$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.12$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.09$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.051$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.055$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.09$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.09$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.040$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.042$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.07$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.06$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.033$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.035$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.06$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.05$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsection
等价性
\begin_inset CommandInset label
LatexCommand label
name "sec:DGequivFR"

\end_inset


\end_layout

\begin_layout Subsubsection
DG 
\begin_inset Formula $\iff$
\end_inset

 DG-with-FR
\end_layout

\begin_layout Standard
DG 格式的 weak form 为
\begin_inset Formula 
\[
\ip{w^{h}}{\partial_{t}\,u^{h}}_{E_{j}}+\ip{w^{h}}{n_{x}\,f^{\mathrm{U}}}_{\partial E_{j}}=\ip{\partial_{x}\,w^{h}}{f^{\mathrm{D}}}_{E_{j}},
\]

\end_inset

对其右端项再次分部积分，得
\begin_inset Formula 
\[
\ip{w^{h}}{\partial_{t}\,u^{h}+\partial_{x}\,f^{\mathrm{D}}}_{E_{j}}+\ip{w^{h}}{n_{x}\,f^{\mathrm{U}}-n_{x}\,f^{\mathrm{D}}}_{\partial E_{j}}=0,
\]

\end_inset

为得到与 DG-with-FR 格式等价的
\begin_inset Formula 
\[
\ip{w^{h}}{\partial_{t}\,u^{h}+\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}=0,
\]

\end_inset

只需证明
\begin_inset Formula 
\[
\ip{w^{h}}{n_{x}\,f^{\mathrm{U}}-n_{x}\,f^{\mathrm{D}}}_{\partial E_{j}}=\ip{w^{h}}{\partial_{x}\,f^{\mathrm{C}}}_{E_{j}},
\]

\end_inset

即
\begin_inset Formula 
\[
\left(f^{\mathrm{U}}\,w^{h}-f^{\mathrm{D}}\,w^{h}\right)_{\xi=-1}^{\xi=+1}=\int_{-1}^{+1}\underbrace{\left(\frac{\partial x}{\partial\xi}\right)^{-1}\frac{\partial f^{\mathrm{C}}}{\partial\xi}}_{\partial_{x}\,f^{\mathrm{C}}}w^{h}\left|\frac{\partial x}{\partial\xi}\right|\dd{\xi},
\]

\end_inset

对于非退化且非变向坐标变换，有
\begin_inset Formula 
\[
\left(\frac{\partial x}{\partial\xi}\right)^{-1}\left|\frac{\partial x}{\partial\xi}\right|=1,
\]

\end_inset

故只需要证明
\begin_inset Formula 
\[
\left(f^{\mathrm{U}}\,w^{h}-f^{\mathrm{D}}\,w^{h}\right)_{\xi=-1}^{\xi=+1}=\int_{-1}^{+1}\frac{\partial f^{\mathrm{C}}}{\partial\xi}w^{h}\dd{\xi},
\]

\end_inset

根据修正函数 
\begin_inset Formula $f^{\mathrm{C}}$
\end_inset

 的定义，其局部导数为
\begin_inset Formula 
\[
\frac{\partial f^{\mathrm{C}}}{\partial\xi}=\sum_{\zeta=\pm1}\left(f^{\mathrm{U}}(x(\zeta),t)-f^{\mathrm{D}}(x(\zeta),t)\right)\frac{\dd g_{\zeta}(\xi)}{\dd\xi},
\]

\end_inset

代入上述右端积分，并分部积分，得
\begin_inset Formula 
\[
\begin{aligned}\int_{-1}^{+1}\frac{\partial f^{\mathrm{C}}}{\partial\xi}w^{h}\dd{\xi} & =\int_{-1}^{+1}\sum_{\zeta=\pm1}\left(f^{\mathrm{U}}(x(\zeta),t)-f^{\mathrm{D}}(x(\zeta),t)\right)\frac{\dd g_{\zeta}(\xi)}{\dd\xi}w^{h}(x(\xi))\dd{\xi}\\
 & =\sum_{\zeta=\pm1}\left(f^{\mathrm{U}}(x(\zeta),t)-f^{\mathrm{D}}(x(\zeta),t)\right)\left(g_{\zeta}(\xi)\,w^{h}(x(\xi))\right)_{\xi=-1}^{\xi=+1}\\
 & -\sum_{\zeta=\pm1}\left(f^{\mathrm{U}}(x(\zeta),t)-f^{\mathrm{D}}(x(\zeta),t)\right)\int_{-1}^{+1}g_{\zeta}(\xi)\frac{\dd w^{h}(x(\xi))}{\dd\xi}\dd{\xi},
\end{aligned}
\]

\end_inset

利用
\begin_inset Formula 
\[
g_{-1}(-1)=g_{+1}(+1)=1,\quad g_{-1}(+1)=g_{+1}(-1)=0,
\]

\end_inset

可得
\begin_inset Formula 
\[
\sum_{\zeta=\pm1}\left(f^{\mathrm{U}}(x(\zeta),t)-f^{\mathrm{D}}(x(\zeta),t)\right)\left(g_{\zeta}(\xi)\,w^{h}(x(\xi))\right)_{\xi=-1}^{\xi=+1}=\left(f^{\mathrm{U}}\,w^{h}-f^{\mathrm{D}}\,w^{h}\right)_{\xi=-1}^{\xi=+1},
\]

\end_inset

而最后一行的积分可由正交性消除：
\begin_inset Formula 
\[
\int_{-1}^{+1}g_{\zeta}(\xi)\frac{\dd w^{h}(x(\xi))}{\dd\xi}\dd{\xi}=0\impliedby\begin{cases}
w^{h}\in\mathbb{P}_{N-1}\\
g_{\zeta}\perp\mathbb{P}_{N-2}
\end{cases}
\]

\end_inset

因此，DG 与利用 
\begin_inset Formula $g_{\zeta}\perp\mathbb{P}_{N-2}$
\end_inset

 的 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
DG-with-FR
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
 等价。
\end_layout

\begin_layout Subsubsection
DG-with-FR 
\begin_inset Formula $\iff$
\end_inset

 FR
\end_layout

\begin_layout Standard
构造 DG-with-FR 的积分式
\begin_inset Formula 
\[
\ip{w^{h}}{\partial_{t}\,u^{h}+\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}=0,
\]

\end_inset

即
\begin_inset Formula 
\[
\ip{b_{k}}{\partial_{t}\,u^{h}+\partial_{x}\,f^{\mathrm{R}}}_{E_{j}},\quad\forall k\in\left\{ 1,\dots,N\right\} ,
\]

\end_inset

的被积函数至多为 
\begin_inset Formula $(N-1)+(N-1)$
\end_inset

 次，精确数值积分需 
\begin_inset Formula $N$
\end_inset

 个 Gauss–Legendre 积分点；FR 所用 Lagrange 插值亦需 
\begin_inset Formula $N$
\end_inset

 个结点；若二者相同，则 
\begin_inset Formula $\forall k\in\left\{ 1,\dots,N\right\} $
\end_inset

 有
\begin_inset Formula 
\[
\ip{b_{k}}{\partial_{t}\,u^{h}+\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}=\sum_{l=1}^{N}\underbrace{b_{k}(x_{l})}_{\delta_{kl}}\left(\partial_{t}\,u^{h}+\partial_{x}\,f^{\mathrm{R}}\right)_{x_{l}}W_{l}=\left(\partial_{t}\,u^{h}+\partial_{x}\,f^{\mathrm{R}}\right)_{x_{k}}W_{l}=0,
\]

\end_inset

因此，
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
DG-with-FR
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
 与以 Gauss–Legendre 积分点为 Lagrange 插值结点的 FR 等价。
\end_layout

\begin_layout Subsubsection
DG-with-FR without Quadrature
\end_layout

\begin_layout Standard
DG-with-FR 的另一种 quadrature free 实现：取正交基，则
\begin_inset Formula 
\[
0=\ip{b_{k}}{\partial_{t}\,u^{h}+\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}=\ip{b_{k}}{\partial_{t}\,u^{h}}_{E_{j}}+\ip{b_{k}}{\partial_{x}\,f^{\mathrm{D}}}_{E_{j}}+\ip{b_{k}}{\partial_{x}\,f^{\mathrm{C}}}_{E_{j}},
\]

\end_inset

可化为
\begin_inset Formula 
\[
\ip{b_{k}}{\partial_{t}\,u^{h}}_{E_{j}}=\ip{b_{k}}{\partial_{t}\,\sum_{l=1}^{N}\hat{u}_{l}\,b_{l}}_{E_{j}}=\sum_{l=1}^{N}\ip{b_{k}}{b_{l}}_{E_{j}}\left(\partial_{t}\,\hat{u}_{l}\right)=\ip{b_{k}}{b_{k}}_{E_{j}}\left(\partial_{t}\,\hat{u}_{k}\right),
\]

\end_inset


\begin_inset Formula 
\[
\ip{b_{k}}{\partial_{x}\,f^{\mathrm{D}}}_{E_{j}}=\ip{b_{k}}{\partial_{x}\,\sum_{l=1}^{N}\hat{f}_{l}\,b_{l}}_{E_{j}}=\sum_{l=1}^{N}\ip{b_{k}}{\partial_{x}\,b_{l}}_{E_{j}}\hat{f}_{l}=\sum_{l=k+1}^{N}\ip{b_{k}}{\partial_{x}\,b_{l}}_{E_{j}}\hat{f}_{l},
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\ip{b_{k}}{\partial_{x}\,f^{\mathrm{C}}}_{E_{j}}=\ip{b_{k}}{\sum_{\zeta=\pm1}\left(f^{\mathrm{U}}-f^{\mathrm{D}}\right)_{\zeta}\frac{\dd g_{\zeta}}{\dd x}}_{E_{j}}=\sum_{\zeta=\pm1}\left(f^{\mathrm{U}}-f^{\mathrm{D}}\right)_{\zeta}\ip{b_{k}}{\frac{\dd g_{\zeta}}{\dd x}}_{E_{j}},
\]

\end_inset

其中 
\begin_inset Formula $\ip{b_{k}}{\partial_{x}\,b_{l}}_{E_{j}}$
\end_inset

 为严格上三角阵，且不能进一步简化：
\begin_inset Formula 
\[
\ip{b_{k}}{\partial_{x}\,b_{l+2}}_{E_{j}}=\ip{b_{k}}{\partial_{x}\,b_{l}}_{E_{j}}\ne0\impliedby\begin{cases}
\ip{b_{k}}{\partial_{x}\,b_{l}}_{E_{j}}\ne0\\
\partial_{x}\,b_{l+2}-\partial_{x}\,b_{l}=(2l+3)\,b_{l+1}\\
\ip{b_{k}}{b_{l+1}}_{E_{j}}=0\impliedby k<l+1
\end{cases}
\]

\end_inset


\end_layout

\begin_layout Subsubsection
\begin_inset Formula $\mathbb{P}_{N-1}$
\end_inset

 的所有基等价
\end_layout

\begin_layout Standard
\begin_inset Formula $\mathbb{P}_{N-1}(E_{j})$
\end_inset

 的任意两组基之间有非退化的线性变换
\begin_inset Formula 
\[
\underline{b}_{j}=\underline{C}\,\underline{b}'_{j}\implies\begin{cases}
\underline{\hat{u}}_{j}=\underline{C}^{-\mathrm{T}}\,\underline{\hat{u}}_{j}',\\
\underline{\hat{w}}_{j}=\underline{C}^{-\mathrm{T}}\,\underline{\hat{w}}_{j}',
\end{cases}
\]

\end_inset

因此有
\begin_inset Formula 
\[
\begin{aligned}\ip{w^{h}}{\partial_{t}\,u^{h}}_{E_{j}} & =\ip{\underline{\hat{w}}_{j}^{\mathrm{T}}\,\underline{b}_{j}}{\partial_{t}\,\underline{\hat{u}}_{j}^{\mathrm{T}}\,\underline{b}_{j}}_{E_{j}}=\ip{\left(\underline{C}^{-\mathrm{T}}\,\underline{\hat{w}}'_{j}\right)^{\mathrm{T}}\underline{b}_{j}}{\partial_{t}\left(\underline{C}^{-\mathrm{T}}\,\underline{\hat{u}}'_{j}\right)^{\mathrm{T}}\underline{b}_{j}}_{E_{j}}\\
 & =\left(\underline{C}^{-\mathrm{T}}\,\underline{\hat{w}}'_{j}\right)^{\mathrm{T}}\ip{\underline{b}_{j}}{\underline{b}_{j}^{\mathrm{T}}}_{E_{j}}\frac{\dd}{\dd t}\left(\underline{C}^{-\mathrm{T}}\,\underline{\hat{u}}'_{j}\right)\\
 & =\left(\underline{\hat{w}}'_{j}\right)^{\mathrm{T}}\underline{C}^{-1}\ip{\underline{b}_{j}}{\underline{b}_{j}^{\mathrm{T}}}_{E_{j}}\underline{C}^{-\mathrm{T}}\,\frac{\dd}{\dd t}\underline{\hat{u}}'_{j},
\end{aligned}
\]

\end_inset


\begin_inset Formula 
\[
\begin{aligned}\ip{w^{h}}{\partial_{x}\,f^{\mathrm{R}}}_{E_{j}} & =\ip{\underline{\hat{w}}_{j}^{\mathrm{T}}\,\underline{b}_{j}}{\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}=\ip{\left(\underline{C}^{-\mathrm{T}}\,\underline{\hat{w}}'_{j}\right)^{\mathrm{T}}\underline{b}_{j}}{\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}\\
 & =\left(\underline{C}^{-\mathrm{T}}\,\underline{\hat{w}}'_{j}\right)^{\mathrm{T}}\ip{\underline{b}_{j}}{\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}\\
 & =\left(\underline{\hat{w}}'_{j}\right)^{\mathrm{T}}\underline{C}^{-1}\ip{\underline{b}_{j}}{\partial_{x}\,f^{\mathrm{R}}}_{E_{j}},
\end{aligned}
\]

\end_inset

从而有
\begin_inset Formula 
\[
\begin{aligned}\frac{\dd}{\dd t}\underline{\hat{u}}'_{j} & =\left(\underline{C}^{-1}\ip{\underline{b}_{j}}{\underline{b}_{j}^{\mathrm{T}}}_{E_{j}}\underline{C}^{-\mathrm{T}}\right)^{-1}\left(-\underline{C}^{-1}\ip{\underline{b}_{j}}{\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}\right)\\
 & =\underline{C}^{\mathrm{T}}\left(-\ip{\underline{b}_{j}}{\underline{b}_{j}^{\mathrm{T}}}_{E_{j}}^{-1}\ip{\underline{b}_{j}}{\partial_{x}\,f^{\mathrm{R}}}_{E_{j}}\right),
\end{aligned}
\]

\end_inset

即
\begin_inset Formula 
\[
\frac{\dd}{\dd t}\underline{\hat{u}}_{j}'=\underline{C}^{\mathrm{T}}\,\underline{S}\,\underline{C}^{-\mathrm{T}}\,\underline{\hat{u}}_{j}'\impliedby\frac{\dd}{\dd t}\underline{\hat{u}}_{j}=\underline{S}\,\underline{\hat{u}}_{j},
\]

\end_inset

其中 
\begin_inset Formula $\underline{C}^{\mathrm{T}}\,\underline{S}\,\underline{C}^{-\mathrm{T}}$
\end_inset

 与 
\begin_inset Formula $\underline{S}$
\end_inset

 有相同的特征值，因此相应的空间离散格式有相同的色散、耗散特性。
\end_layout

\end_body
\end_document
